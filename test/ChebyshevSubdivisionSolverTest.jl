include("../../Julia-Rootfinding/src/ChebyshevSubdivisionSolver.jl")
using Test

function test_all_ChebyshevSubdivisionSolver()
    @testset "All tests in ChebyshevSubdivisionSolverTest.jl" begin
        test_getLinearTerms()
        test_linearCheck1()
        test_reduceSolveDim()
        test_transformChebInPlace1D()
        test_transformChebInPlaceND()
        test_getTransformationError()
        test_transformCheb()
        test_transformChebToInterval()
        test_getSubdivisionDims()
    end
end

function test_getLinearTerms()
    @testset "getLinearTerms unit tests" begin
        M_1 = reshape(collect(0:15),(2,2,2,2))
        A_1_expected = [8; 4; 2; 1]
        @test isapprox(A_1_expected,getLinearTerms(M_1))

        M_2 = reshape(collect(0:15),(2,2,4))
        A_2_expected = [4; 2; 1]
        @test isapprox(A_2_expected,getLinearTerms(M_2))

        M_3 = [43.2;12.2;-9.2]
        A_3_expected = [12.2]
        @test isapprox(A_3_expected,getLinearTerms(M_3))
        
        M_4 = reshape(collect(0:(2*15*4*6-1)),(6,4,15,2))
        A_4_expected = [360; 24; 6; 1]
        @test isapprox(A_4_expected,getLinearTerms(M_4))

        M_5 = reshape(collect(0:(3*4-1)),(4,1,3))
        A_5_expected = [4; 0; 1]
        @test isapprox(A_5_expected,getLinearTerms(M_5))


    end
end

function test_linearCheck1()
    @testset "linearCheck1 unit tests" begin
        A1 = [-1.12215095; -0.10896646; -0.20570858;;
                1.61496991;  0.36087537;  0.70263142;;
                1.11501566;  1.00547594; -1.96518304]
        totalErrs1 = [3.04770461; 7.78421744; 7.01361619]
        consts1 = [1.06289306; -0.36122354;  2.87185328]
        expecteda1 = [0.17843629682798045621; -5.97541921291522903914; 0.35379575125989282114]
        expectedb1 = [0.13891640768525181926; 0.26299355308293126399; 2.56893787868228251625]
        ao1, bo1 = linearCheck1(totalErrs1,A1,consts1)
        @test isapprox(expecteda1,ao1)
        @test isapprox(expectedb1,bo1)

        A2 = [1.80704361; 0.16184698; 0.12777497;;
                -1.50763366; -0.0496367; -0.03896966;;
                1.1471166; 1.60014553; -1.22405313]
        totalErrs2 = [3.12346641; 7.35040987; 6.71495483]
        consts2 = [0.43827528; 0.03844889; 2.66922695]
        expecteda2 = [-0.72849531284969915035; -3.19646507402361113037; -0.12454345016870327356]
        expectedb2 = [0.19996601042997674824; -0.13976516248493942030; 4.48583608458237481642]
        ao2, bo2 = linearCheck1(totalErrs2,A2,consts2)
        @test isapprox(expecteda2,ao2)
        @test isapprox(expectedb2,bo2)

        A3 = [1.80704361; 0.16184698; 0.12777497;;
                -1.50763366; -0.0496367;  -0.03896966;;
                -1.50763366; -0.0496367;  0.03896966]
        totalErrs3 = [3.12346641; 7.35040987; 6.71495483]
        consts3 = [0.43827528; 0.03844889; 2.66922695]
        expecteda3 = [0.08697917370722585417; -18.29888596005930878619; -23.44505688398909626358]
        expectedb3 = [0.24342093216001564615; 12.88296432840451899438; 16.58494523614445270709]
        ao3,bo3 = linearCheck1(totalErrs3,A3,consts3)
        @test isapprox(expecteda3,ao3)
        @test isapprox(expectedb3,bo3)

        A4 = reshape([1.50001956],(1,1)) #1 dimensional test
        totalErrs4 = [1.50001956]
        consts4 = [0.]
        expecteda4 = [0.]
        expectedb4 = [0.]
        ao4,bo4 = linearCheck1(totalErrs4,A4,consts4)
        @test isapprox(expecteda4,ao4)
        @test isapprox(expectedb4,bo4)

        A5 = [-.843750000; -1.87818750; -1.84275000; -.0107162044; -.00639690758; -.0137320288;;
                1.76080078; -.211296094; -.207309375; -.0159523129; .00889275657; -.0159523129;;
                .000176557928; -.00280220616; -.000701926758;  .0750781250; -1.28906250; -.0703125000;;
                1.36514364; -.163754473; -.160664766; -.163754473; .00504338969; -.00586371477;;
                .0289072432; -.240222558; -1.16359475; -1.12860484; -.190846439; -1.11307774;;
                .0903976590; -1.43472955; -.359386500;  0.0; 0.0;  0.0]
        totalErrs5 = [13.43636626; 31.17953809; 5.93851452; 33.20880558; 10.53793091; 1601.6394327]
        consts5 = [-0.07413729; -0.19634937;  0.90146117;-0.16101726; -0.72744493;  0.71811873]
        expecteda5 = [-14.92458223407407302830; -6.15390037469634965106; -6.29147538190204791420; -8.33713070909743869663; -2.20821696387878763090; -8.46738087673912076525]
        expectedb5 = [14.74884939851851761716; 6.07495480616285643549; 6.21101162935829531619; 7.04802595920109808958; 3.60684762763636346250; 7.16029350294975763802]
        ao5,bo5 = linearCheck1(totalErrs5,A5,consts5)
        @test isapprox(expecteda5,ao5)
        @test isapprox(expectedb5,bo5)

        A6 = [-1.09679818; -.939093750; -.921375000; -.0138146058; -.00106830799; -.0137307266;;
                .915137070; -1.05695980; -1.03701717; -.0149230031; .00237984138; -.0298460061;;
                .000607404435; -.00309112001; .000675877264;  .0750781250; -1.10873059; -.0379851973;;
                1.42079568; -1.63828770; -1.60737661; -1.63828770; -.00611697632; -.00852711940;;
                .901029633; -.240222558; -1.16359475; -1.12860484; -.0167700634; -1.01490072;;
                .310991071; -1.58265345;  .346049159;  0.0; 0.0; 0.0]
        totalErrs6 = [5.35450865; 14.31962505; 5.26765467; 30.10577724; 8.74980906; 1261.57287396]
        consts6 = [-0.06306681; -1.04453075; 1.44087973; -1.64179371; 0.23798175; 0.63996163]
        expecteda6 = [-3.88194523626944754113; -4.70178286246713916796; -4.81143253289919847759; -6.33103852363418972971; -1.15191610254029308535; -7.15236938643614461597]
        expectedb6 = [3.76694356841474720099; 4.56746866859671918348; 4.67453537376203964726; 6.75276584849662775412; 3.75106821937689982605; 7.62134481488987525211]
        ao6,bo6 = linearCheck1(totalErrs6,A6,consts6)
        @test isapprox(expecteda6,ao6)
        @test isapprox(expectedb6,bo6)

        A7 = [0; -.939093750; 0; -.0138146058; -.00106830799; -.0137307266;;
                0; -1.05695980; 0; -.0149230031; .00237984138; -.0298460061;;
                0; 0;  0;  0; 0; 0;;
                0; -1.63828770; 0; -1.63828770; -.00611697632; -.00852711940;;
                0; 0; 0; 0; 0; 0;;
                0; 0;  0;  0.0; 0.0; 0.0]
        totalErrs7 = [5.35450865; 14.31962505; 5.26765467; 30.10577724; 8.74980906; 1261.57287396]
        consts7 = [-0.06306681; -1.04453075; 1.44087973; -1.64179371; 0.23798175; 0.63996163]
        expecteda7 = [-Inf; -4.70178286246713916796; -Inf; -17.37636774053788002448; -4920.67627681775957171340; -388.96542615596172254300]
        expectedb7 = [Inf; 4.56746866859671918348; Inf; 15.37208764980656283683; 4383.87717081762366433395; 379.77919561809636661565]
        ao7,bo7 = linearCheck1(totalErrs7,A7,consts7)
        @test isapprox(expecteda7,ao7)
        @test isapprox(expectedb7,bo7)
    end
end

function test_reduceSolvedDim()
    @testset "reduceSolvedDim unit tests" begin 
        # 2d case
        Ms_1 = [[3.1;-2;34;.000001;.0002;;4;1;2;.0002;.0102], [9.836;3.1;-.031;.001;-.045;.00002;;15.2344;42.234;2;4;3;.0023]]
        errors_1 = [.00002;.0001]
        trackedInterval_1 = TrackedInterval([1;1;;-3;2])
        trackedInterval_1.reducedDims = [1]
        trackedInterval_1.solvedVals = [1.;2.;3.]
        dim_1 = 0
        expected_new_Ms_1 = [[3.10000000000000008882; -2.00000000000000000000; 34.00000000000000000000; 0.00000100000000000000; 0.00020000000000000001]]
        expected_new_errors_1 = [0.00002]
        expected_new_trackedInterval_1 = [-3;2]

        new_Ms_1, new_errors_1, new_trackedInterval_1 = reduceSolvedDim(Ms_1,errors_1,trackedInterval_1,dim_1)
        @test isapprox(expected_new_Ms_1[1],new_Ms_1[1])
        @test isapprox(expected_new_errors_1,new_errors_1)
        @test isapprox(expected_new_trackedInterval_1,new_trackedInterval_1.interval)
        @test (1 == new_trackedInterval_1.ndim)
        @test ([1;0] == new_trackedInterval_1.reducedDims)
        @test ([1.; 2.; 3.; 1.0] == new_trackedInterval_1.solvedVals)

        # 3d case
        Ms_2 = [[5.1;-2;2.4;.000001;.0002;.001001;;18;4;2.12;.0002;.0102;.045;;5;3.2;4.2;11;.0002;.0909;;;8.12;3.332;4.1232;11;.012002;.091239;;45.23;34;7.23;2.0;.0002;.011239;;8.127;3.2;4.3;11;.012002;.093309;;;54.1;13.332;6.1232;12.1;.12;.12239;;4.2343;5.433;94.3;8.340;.012302;.11239;;77.127;81.2;5.3;1;.02;.03], [5.836;3.122;-.031;;13.234344;42.001;.0012;;5.9;13.0022333;.0056;;;3.2;12;.0023;;56.2;1;.00233;;5.2;4.5;.013;;;5.2;4.5;.013;;3.2;12;.0023;;5.2;4.5;.013],[2;2;.002;.001;;2.1;2.1;.0021;.001;;6.23;125;.004;.0021;;;8.23453;25;.004;.0021;;2;15;.0344;.00221;;14;1.9;.004;.023021;;;8;1.9;.004;.023021;;1;1.9;.004;.023021;;4;1.9;.004;.023021]]
        errors_2 = [.0001122;.00021;.00310102]
        trackedInterval_2 = TrackedInterval([-3;4;;4;19;;-2e-16;-1e-16])
        trackedInterval_2.reducedDims = []
        trackedInterval_2.solvedVals = []
        dim_2 = 2

        expected_new_Ms_2 = [[2.70019999999999971152; 15.89019999999999832596; 0.80019999999999980034;;4.00880199999999931038; 38.00019999999999953388; 3.83900200000000069167;;48.09680000000000177351; -90.05339799999998717794; 71.84699999999999420197],[5.86699999999999999289; 13.23314399999999935176; 5.89440000000000008384;;3.19770000000000020890; 56.19767000000000223281; 5.18700000000000027711;;5.18700000000000027711; 3.19770000000000020890; 5.18700000000000027711]]
        expected_new_errors_2 = [0.00011220000000000000; 0.00021000000000000001]
        expected_new_trackedInterval_2 = [-3.;4.;;4.;19.]

        new_Ms_2, new_errors_2, new_trackedInterval_2 = reduceSolvedDim(Ms_2,errors_2,trackedInterval_2,dim_2)
        @test isapprox(expected_new_Ms_2[1],new_Ms_2[1])
        @test isapprox(expected_new_Ms_2[2],new_Ms_2[2])
        @test isapprox(expected_new_errors_2,new_errors_2)
        @test isapprox(expected_new_trackedInterval_2,new_trackedInterval_2.interval)
        @test (2 == new_trackedInterval_2.ndim)
        @test ([2] == new_trackedInterval_2.reducedDims)
        @test ([-0.00000000000000015000] == new_trackedInterval_2.solvedVals)

        # 5d case 
        Ms_3 = [reshape(collect(0:2*3*3*2*1-1),(1,2,3,3,2)),reshape(collect(0:3*2*2*2*2-1),(2,2,2,2,3)),reshape(collect(0:4*1*2*2*3-1),(3,2,2,1,4)),reshape(collect(0:5*4*2*1*1-1),(1,1,2,4,5)),reshape(collect(0:3*3*3*3*3-1),(3,3,3,3,3))]
        errors_3 = [.00014122;.000121;.0007310102;.00839;.00004173]
        trackedInterval_3 = TrackedInterval([4;19;;-2e-16;-1e-16;;-3;-1e-16;;-4;5;;2;3])
        trackedInterval_3.reducedDims = [5]
        trackedInterval_3.solvedVals = [4.123123123;.20039994]
        dim_3 = 1

        expected_new_Ms_3 = [[-12.;;   -12.;;;  -12.;;   -12.;;;  -12.;;   -12.;;;; -12.;;   -12.;;;  -12.;;   -12.;;;  -12.;;   -12.],
                             [0.;  1.;  2.;;    3.;  4.;  5.;;;   6.;  7.;  8.;;    9.; 10.; 11.;;;; 12.; 13.; 14.;;   15.; 16.; 17.;;;  18.; 19.; 20.;;   21.; 22.; 23.;;;; 24.; 25.; 26.;;   27.; 28.; 29.;;;  30.; 31.; 32.;;   33.; 34.; 35.;;;; 36.; 37.; 38.;;   39.; 40.; 41.;;;  42.; 43.; 44.;;   45.; 46.; 47.],
                             [-4.;;;  -4.;;;; -4.;;;  -4.;;;; -4.;;;  -4.;;;; -4.;;;  -4.;;;; -4.;;;  -4.],
                             [-54.; -54.; -54.;;   -54.; -54.; -54.;;   -54.; -54.; -54.;;;  -54.; -54.; -54.;;   -54.; -54.; -54.;;   -54.; -54.; -54.;;;  -54.; -54.; -54.;;   -54.; -54.; -54.;;   -54.; -54.; -54.;;;; -54.; -54.; -54.;;   -54.; -54.; -54.;;   -54.; -54.; -54.;;;  -54.; -54.; -54.;;   -54.; -54.; -54.;;   -54.; -54.; -54.;;;  -54.; -54.; -54.;;   -54.; -54.; -54.;;   -54.; -54.; -54.;;;; -54.; -54.; -54.;;   -54.; -54.; -54.;;   -54.; -54.; -54.;;;  -54.; -54.; -54.;;   -54.; -54.; -54.;;   -54.; -54.; -54.;;;  -54.; -54.; -54.;;   -54.; -54.; -54.;;   -54.; -54.; -54.]]
        expected_new_errors_3 = [0.00014122000000000001; 0.00073101020000000000; 0.00838999999999999989; 0.00004173000000000000]
        expected_new_trackedInterval_3 =  [ 4.0;  19;;
                                            -3.0; -1.0e-16;;
                                            -4.0;  5.0;;
                                             2.0;  3.0]
        new_Ms_3, new_errors_3, new_trackedInterval_3 = reduceSolvedDim(Ms_3,errors_3,trackedInterval_3,dim_3)
        @test isapprox(expected_new_Ms_3[1],new_Ms_3[1])
        @test isapprox(expected_new_Ms_3[2],new_Ms_3[2])
        @test isapprox(expected_new_Ms_3[3],new_Ms_3[3])
        @test isapprox(expected_new_Ms_3[4],new_Ms_3[4])
        @test isapprox(expected_new_errors_3,new_errors_3)
        @test isapprox(expected_new_trackedInterval_3,new_trackedInterval_3.interval)
        @test (4 == new_trackedInterval_3.ndim)
        @test ([5;1] == new_trackedInterval_3.reducedDims)
        @test ([4.123123123;.20039994;-1.5e-16] == new_trackedInterval_3.solvedVals)
        
        # 5d pt.2
        Ms_4 = [reshape(collect(0:2*3*3*2*1-1),(1,2,3,3,2)).^2,reshape(collect(0:3*2*2*2*2-1),(2,2,2,2,3)).^2,reshape(collect(0:4*1*2*2*3-1),(3,2,2,1,4)).^2,reshape(collect(0:5*4*2*1*1-1),(1,1,2,4,5)).^2,reshape(collect(0:3*3*3*3*3-1),(3,3,3,3,3)).^2]
        errors_4 = [.00014122;.000121;.0007310102;.00839;.00004173]
        trackedInterval_4 = TrackedInterval([4;19;;-2e-16;-1e-16;;-3;-1e-16;;-4;5;;2;3])
        trackedInterval_4.reducedDims = [5]
        trackedInterval_4.solvedVals = [4.123123123;.20039994]
        dim_4 = 1

        expected_new_Ms_4 = [[-144.;;   -168.;;;  -192.;;   -216.;;;  -240.;;   -264.;;;; -576.;;   -600.;;;  -624.;;   -648.;;;  -672.;;   -696.],
                            [0.000; 1.000; 4.000;;   9.000; 1.600e+01; 2.500e+01;;;  3.600e+01; 4.900e+01; 6.400e+01;;   8.100e+01; 1.000e+02; 1.210e+02;;;; 1.440e+02; 1.690e+02; 1.960e+02;;   2.250e+02; 2.560e+02; 2.890e+02;;;  3.240e+02; 3.610e+02; 4.000e+02;;   4.410e+02; 4.840e+02; 5.290e+02;;;; 5.760e+02; 6.250e+02; 6.760e+02;;   7.290e+02; 7.840e+02; 8.410e+02;;;  9.000e+02; 9.610e+02; 1.024e+03;;   1.089e+03; 1.156e+03; 1.225e+03;;;; 1.296e+03; 1.369e+03; 1.444e+03;;   1.521e+03; 1.600e+03; 1.681e+03;;;  1.764e+03; 1.849e+03; 1.936e+03;;   2.025e+03; 2.116e+03; 2.209e+03],
                            [-16.;;;   -24.;;;;  -80.;;;   -88.;;;; -144.;;;  -152.;;;; -208.;;;  -216.;;;; -272.;;;  -280.],
                            [-2916.;  -3024.;  -3132.;;    -3240.;  -3348.;  -3456.;;    -3564.;  -3672.;  -3780.;;;   -3888.;  -3996.;  -4104.;;    -4212.;  -4320.;  -4428.;;    -4536.;  -4644.;  -4752.;;;   -4860.;  -4968.;  -5076.;;    -5184.;  -5292.;  -5400.;;    -5508.;  -5616.;  -5724.;;;; -11664.; -11772.; -11880.;;   -11988.; -12096.; -12204.;;   -12312.; -12420.; -12528.;;;  -12636.; -12744.; -12852.;;   -12960.; -13068.; -13176.;;   -13284.; -13392.; -13500.;;;  -13608.; -13716.; -13824.;;   -13932.; -14040.; -14148.;;   -14256.; -14364.; -14472.;;;; -20412.; -20520.; -20628.;;   -20736.; -20844.; -20952.;;   -21060.; -21168.; -21276.;;;  -21384.; -21492.; -21600.;;   -21708.; -21816.; -21924.;;   -22032.; -22140.; -22248.;;;  -22356.; -22464.; -22572.;;   -22680.; -22788.; -22896.;;   -23004.; -23112.; -23220.]]
        expected_new_errors_4 = [0.00014122000000000001; 0.00073101020000000000; 0.00838999999999999989; 0.00004173000000000000]
        expected_new_trackedInterval_4 = [4.0;  1.9e+01;;
                                            -3.0; -1.0e-16;;
                                            -4.0;  5.0;;
                                             2.0;  3.0e+00]

        new_Ms_4, new_errors_4, new_trackedInterval_4 = reduceSolvedDim(Ms_4,errors_4,trackedInterval_4,dim_4)
        @test isapprox(expected_new_Ms_4[1],new_Ms_4[1])
        @test isapprox(expected_new_Ms_4[2],new_Ms_4[2])
        @test isapprox(expected_new_Ms_4[3],new_Ms_4[3])
        @test isapprox(expected_new_Ms_4[4],new_Ms_4[4])
        @test isapprox(expected_new_errors_4,new_errors_4)
        @test isapprox(expected_new_trackedInterval_4,new_trackedInterval_4.interval)
        @test (4 == new_trackedInterval_4.ndim)
        @test ([5;1] == new_trackedInterval_4.reducedDims)
        @test ([4.123123123;.20039994;-1.5e-16] == new_trackedInterval_4.solvedVals)
        
    end
end

function test_transformChebInPlace1D()
    @testset "transformChebInPlace1D unit tests" begin
        alpha_1 = 0.8043138619259216
        beta_1 = 0.19568613807407842
        coeffs_1 = [1.6668764854819471; 0.502737971117991; 0.003441591526151544;;0.5575078290711436; 0; 0;;0.01239107183457752; 0.0; 0.0;;;
                            -1.20687653838567; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0;;;
                            -0.018876295666785736; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_1 = [ 1.43592664172332273864;  0.50273797111799101156;  0.00344159152615154413;;
                                                    0.55750782907114360132;  0.;          0.;;
                                                    0.01239107183457751997;  0.;0.;;;
                                                    -0.98259152221737600108;  0.;0.;;
                                                    0.;0.;0.;;
                                                    0.;          0.;          0.;;;
                                                    -0.01221146807645548740;  0.;          0.;;
                                                    0.;          0.;          0.;;
                                                    0.;          0.;          0.]
        transformed_coeffs_1 = transformChebInPlace1D(coeffs_1,alpha_1,beta_1)
        @test isapprox(expected_transformed_coeffs_1,transformed_coeffs_1)

        alpha_2 = 0.561531793052032
        beta_2 = -0.43846820694796795
        coeffs_2 = [2.071105809166741; -1.20687653838567; -0.018876295666785736;;0.5575078290711436; 0; 0;;0.01239107183457752; 0.0; 0.0;;;
                        0.9144403736144754; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0;;;
                        0.010914670337842268; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_2 = [ 1.66687648548194711218; -1.20687653838567010567; -0.01887629566678573553 ;;
                                                0.55750782907114360132;  0.;          0.;;
                                                0.01239107183457751997;  0.;          0.;;;
                                                0.50273797111799101156;  0.;          0.;;
                                                0.;          0.;          0.;;
                                                0.;          0.;          0.;;;
                                                0.00344159152615154413;  0.;          0.;;
                                                0.;          0.;          0.;;
                                                0.;          0.;          0.]
        transformed_coeffs_2 = transformChebInPlace1D(coeffs_2,alpha_2,beta_2)
        @test isapprox(transformed_coeffs_2,expected_transformed_coeffs_2)
        
        alpha_3 = 0.561531793052032
        beta_3 = 0
        coeffs_3 = [2.071105809166741; -1.20687653838567; -0.018876295666785736;;0.5575078290711436; 0; 0;;0.01239107183457752; 0.0; 0.0;;;
                        0.9144403736144754; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0;;;
                        0.010914670337842268; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_3 = [ 2.06363273035505034869; -1.20687653838567010567; -0.01887629566678573553 ;;
                                                 0.55750782907114360132;  0.;          0.;;        
                                                 0.01239107183457751997;  0.;          0.;;;        
                                                 0.51348734263490647400;  0.;          0.;;
                                                 0.;          0.;          0.;;
                                                 0.;          0.;          0.;;;
                                                 0.00344159152615154413;  0.;          0.;;
                                                 0.;          0.;          0.;;
                                                 0.;          0.;          0.]
        transformed_coeffs_3 = transformChebInPlace1D(coeffs_3,alpha_3,beta_3)
        @test isapprox(transformed_coeffs_3,expected_transformed_coeffs_3)
        
        alpha_4 = 0
        beta_4 = -0.43846820694796795
        coeffs_4 = [2.071105809166741; -1.20687653838567; -0.018876295666785736;;0.5575078290711436; 0; 0;;0.01239107183457752; 0.0; 0.0;;;
                        0.9144403736144754; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0;;;
                        0.010914670337842268; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_4 = [ 1.66343489395579569035; -1.20687653838567010567; -0.01887629566678573553;;
                                                 0.55750782907114360132;  0.;          0.;;
                                                 0.01239107183457751997;  0.;          0.;;;    
                                                 0.;          0.;          0.;;        
                                                 0.;          0.;          0.;;        
                                                 0.;          0.;          0.]
        transformed_coeffs_4 = transformChebInPlace1D(coeffs_4,alpha_4,beta_4)
        @test isapprox(transformed_coeffs_4,expected_transformed_coeffs_4)
        
        alpha_5 = 0
        beta_5 = 0
        coeffs_5 = [2.071105809166741; -1.20687653838567; -0.018876295666785736;;0.5575078290711436; 0; 0;;0.01239107183457752; 0.0; 0.0;;;
                        0.9144403736144754; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0;;;
                        0.010914670337842268; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_5 = [ 2.06019113882889870482; -1.20687653838567010567; -0.01887629566678573553;;
                                                     0.55750782907114360132;  0.;          0.;;        
                                                     0.01239107183457751997;  0.;          0.;;;
                                                     0.;          0.;          0.;;        
                                                     0.;          0.;          0.;;        
                                                     0.;          0.;          0.]
        transformed_coeffs_5 = transformChebInPlace1D(coeffs_5,alpha_5,beta_5)
        @test isapprox(transformed_coeffs_5,expected_transformed_coeffs_5)
        
        alpha_6 = 1.000000082740371e-10
        beta_6 = -0.7266187050359711
        coeffs_6 = [10.1; 13.9]
        expected_transformed_coeffs_6 = [0.00000000000000000000; 0.00000000139000011501]
        transformed_coeffs_6 = transformChebInPlace1D(coeffs_6,alpha_6,beta_6)
        @test isapprox(transformed_coeffs_6,expected_transformed_coeffs_6)

        alpha_7 = 7.667826729776448e-06
        beta_7 = 0.0
        coeffs_7 = [0; 1.39000012e-09]
        expected_transformed_coeffs_7 = [0.00000000000000000000; 0.00000000000001065828]
        transformed_coeffs_7 = transformChebInPlace1D(coeffs_7,alpha_7,beta_7)
        @test isapprox(transformed_coeffs_7,expected_transformed_coeffs_7)

        alpha_8 = 0
        beta_8 = -0.7266187050359711
        coeffs_8 = [10.1; 13.9]
        expected_transformed_coeffs_8 = [0.0;0.0]
        transformed_coeffs_8 = transformChebInPlace1D(coeffs_8,alpha_8,beta_8)
        @test isapprox(transformed_coeffs_8,expected_transformed_coeffs_8)

        alpha_9 = 0
        beta_9 = 0
        coeffs_9 = [10.1; 13.9]
        expected_transformed_coeffs_9 = [10.09999999999999964473; 0.00000000000000000000]
        transformed_coeffs_9 = transformChebInPlace1D(coeffs_9,alpha_9,beta_9)
        @test isapprox(transformed_coeffs_9,expected_transformed_coeffs_9)

        alpha_10 = 0.5197277737990523
        beta_10 = -0.48027222620094767
        coeffs_10 = [-1.27278454e-02; 7.67937509e-02; -6.13381857e-02; -5.38708766e-02;
                    1.41766096e-02;  6.52808648e-03; -1.07489381e-03; -3.41236334e-04;
                    4.12240520e-05;  1.00310107e-05; -9.59578551e-07; -1.89618788e-07;
                    1.50313164e-08;  2.50245049e-09; -1.69453828e-10; -2.43827788e-11;
                    1.44149276e-12;  1.82690668e-13; -9.54097912e-15; -1.06772230e-15;;
                    4.65987370e-02;  1.23340236e-01;  2.24569195e-01; -8.65232725e-02;
                    -5.19029012e-02;  1.04849121e-02;  3.93536318e-03; -5.48067641e-04;
                    -1.50928040e-04;  1.61110404e-05;  3.51317503e-06; -3.04551162e-07;
                    -5.50321239e-08;  4.01924410e-09;  6.20398379e-10; -3.91616600e-11;
                    -5.27744515e-12;  2.93404190e-13;  3.50275364e-14; -1.80758186e-15;;
                    -2.87478641e-02;  1.73450906e-01; -1.38542053e-01; -1.21675947e-01;
                    3.20201285e-02;  1.47447221e-02; -2.42781871e-03; -7.70736558e-04;
                    9.31110811e-05;  2.26566338e-05; -2.16736085e-06; -4.28284206e-07;
                    3.39506200e-08;  5.65218263e-09; -3.82738438e-10; -5.50723391e-11;
                    3.25587474e-12;  4.12628265e-13; -2.15105711e-14; -2.44249065e-15;;
                    3.73393021e-02;  9.88318274e-02;  1.79946014e-01; -6.93306046e-02;
                    -4.15894986e-02;  8.40150023e-03;  3.15338406e-03; -4.39163474e-04;
                    -1.20937778e-04;  1.29096848e-05;  2.81508711e-06; -2.44035109e-07;
                    -4.40969270e-08;  3.22059738e-09;  4.97121667e-10; -3.13800270e-11;
                    -4.22882562e-12;  2.35075848e-13;  2.80678258e-14; -1.43982049e-15;;
                    -3.66618631e-02;  2.21200203e-01; -1.76681292e-01; -1.55172117e-01;
                    4.08349492e-02;  1.88037964e-02; -3.09617289e-03; -9.82912613e-04;
                    1.18743629e-04;  2.88937782e-05; -2.76401358e-06; -5.46186558e-07;
                    4.32968857e-08;  7.20817194e-09; -4.88102510e-10; -7.02331179e-11;
                    4.15216472e-12;  5.26217958e-13; -2.73947531e-14; -3.13638004e-15;;
                    1.37223730e-02;  3.63211715e-02;  6.61310250e-02; -2.54793303e-02;
                    -1.52843406e-02;  3.08759170e-03;  1.15888380e-03; -1.61394687e-04;
                    -4.44452144e-05;  4.74437119e-06;  1.03455804e-06; -8.96840750e-08;
                    -1.62058325e-08;  1.18358501e-09;  1.82694606e-10; -1.15323194e-11;
                    -1.55412488e-12;  8.64031069e-14;  1.02730324e-14; -5.11743425e-16;;
                    -4.15092509e-02;  2.50447030e-01; -2.00041882e-01; -1.75688789e-01;
                    4.62340975e-02;  2.12900119e-02; -3.50554517e-03; -1.11287215e-03;
                    1.34443770e-04;  3.27140791e-05; -3.12946816e-06; -6.18402694e-07;
                    4.90215483e-08;  8.16122781e-09; -5.52638865e-10; -7.95192454e-11;
                    4.70114225e-12;  5.95801186e-13; -3.09474668e-14; -3.58393870e-15;;
                    -2.63869241e-02; -6.98424389e-02; -1.27164182e-01;  4.89945258e-02;
                    2.93904514e-02; -5.93716905e-03; -2.22843228e-03;  3.10347880e-04;
                    8.54642636e-05; -9.12301123e-06; -1.98936471e-06;  1.72454640e-07;
                    3.11623999e-08; -2.27593059e-09; -3.51305767e-10;  2.21756120e-11;
                    2.98841507e-12; -1.66144876e-13; -1.97897254e-14;  1.02348685e-15;;
                    -2.84597065e-02;  1.71712301e-01; -1.37153360e-01; -1.20456314e-01;
                    3.16991710e-02;  1.45969266e-02; -2.40348319e-03; -7.63010990e-04;
                    9.21777712e-05;  2.24295324e-05; -2.14563605e-06; -4.23991249e-07;
                    3.36103120e-08;  5.59552731e-09; -3.78902054e-10; -5.45202668e-11;
                    3.22319255e-12;  4.08409417e-13; -2.11913820e-14; -2.48585874e-15;;
                    -6.30534116e-02; -1.66893421e-01; -3.03867760e-01;  1.17075866e-01;
                    7.02305513e-02; -1.41872832e-02; -5.32499570e-03;  7.41598093e-04;
                    2.04222871e-04; -2.18000772e-05; -4.75372693e-06;  4.12092494e-07;
                    7.44647469e-08; -5.43849621e-09; -8.39469898e-10;  5.29901747e-11;
                    7.14097531e-12; -3.97015754e-13; -4.72955008e-14;  2.39391840e-15;;
                    1.16324708e-02; -7.01847829e-02;  5.60593433e-02;  4.92346804e-02;
                    -1.29565525e-02; -5.96627104e-03;  9.82387080e-04;  3.11869100e-04;
                    -3.76762576e-05; -9.16772914e-06;  8.76995998e-07;  1.73299954e-07;
                    -1.37377023e-08; -2.28708639e-09;  1.54870351e-10;  2.22842899e-11;
                    -1.31743921e-12; -1.67012237e-13;  8.72912853e-15;  9.80118764e-16;;
                    -4.43198275e-02; -1.17308286e-01; -2.13586646e-01;  8.22918549e-02;
                    4.93645917e-02; -9.97214783e-03; -3.74290438e-03;  5.21264412e-04;
                    1.43546910e-04; -1.53231306e-05; -3.34136333e-06;  2.89657098e-07;
                    5.23407798e-08; -3.82268313e-09; -5.90057912e-10;  3.72464247e-11;
                    5.01934605e-12; -2.79096191e-13; -3.32095462e-14;  1.68962067e-15;;
                    4.60753373e-02; -2.77996619e-01;  2.22046821e-01;  1.95014847e-01;
                    -5.13199248e-02; -2.36319485e-02;  3.89116095e-03;  1.23528993e-03;
                    -1.49232808e-04; -3.63126820e-05;  3.47371484e-06;  6.86428015e-07;
                    -5.44139999e-08; -9.05897641e-09;  6.13429973e-10;  8.82664740e-11;
                    -5.21817312e-12; -6.61332100e-13;  3.44446693e-14;  3.94823063e-15;;
                    4.47229450e-02;  1.18375281e-01;  2.15529355e-01; -8.30403527e-02;
                    -4.98135946e-02;  1.00628510e-02;  3.77694853e-03; -5.26005650e-04;
                    -1.44852562e-04;  1.54625044e-05;  3.37175519e-06; -2.92291718e-07;
                    -5.28168532e-08;  3.85745291e-09;  5.95424767e-10; -3.75852752e-11;
                    -5.06502479e-12;  2.81580315e-13;  3.35634298e-14; -1.65839564e-15;;
                    4.99989117e-03; -3.01669596e-02;  2.40955357e-02;  2.11621459e-02;
                    -5.56901053e-03; -2.56443420e-03;  4.22251522e-04;  1.34048182e-04;
                    -1.61940822e-05; -3.94049113e-06;  3.76952122e-07;  7.44881225e-08;
                    -5.90476580e-09; -9.83039967e-10;  6.65666877e-11;  9.57826483e-12;
                    -5.66286601e-13; -7.17325505e-14;  3.70189990e-15;  4.41053444e-16;;
                    5.59958927e-02;  1.48213172e-01;  2.69856080e-01; -1.03971657e-01;
                    -6.23697008e-02;  1.25993117e-02;  4.72897311e-03; -6.58591601e-04;
                    -1.81364365e-04;  1.93600116e-05;  4.22164600e-06; -3.65967305e-07;
                    -6.61299662e-08;  4.82976958e-09;  7.45508688e-10; -4.70590684e-11;
                    -6.34175351e-12;  3.52551321e-13;  4.20080637e-14; -2.13370988e-15;;
                    -5.43412610e-02;  3.27869262e-01; -2.61882060e-01; -2.30000545e-01;
                    6.05267284e-02;  2.78715243e-02; -4.58923592e-03; -1.45690116e-03;
                    1.76005200e-04;  4.28271836e-05; -4.09689990e-06; -8.09573323e-07;
                    6.41758812e-08;  1.06841583e-08; -7.23479519e-10; -1.04101582e-10;
                    6.15428541e-12;  7.79959430e-13; -4.06896739e-14; -4.62130334e-15;;
                    -8.40268562e-02; -2.22407149e-01; -4.04943237e-01;  1.56018790e-01;
                    9.35913266e-02; -1.89063965e-02; -7.09624803e-03;  9.88275730e-04;
                    2.72153486e-04; -2.90514328e-05; -6.33495823e-06;  5.49166744e-07;
                    9.92339419e-08; -7.24750223e-09; -1.11870260e-09;  7.06163114e-11;
                    9.51624890e-12; -5.29076782e-13; -6.29774011e-14;  3.17107451e-15;;
                    4.65783526e-02; -2.81031573e-01;  2.24470958e-01;  1.97143870e-01;
                    -5.18801965e-02; -2.38899441e-02;  3.93364167e-03;  1.24877588e-03;
                    -1.50862017e-04; -3.67091161e-05;  3.51163821e-06;  6.93921911e-07;
                    -5.50080504e-08; -9.15787533e-09;  6.20127050e-10;  8.92301372e-11;
                    -5.27511368e-12; -6.68534672e-13;  3.48610030e-14;  3.97945565e-15;;
                    5.09954538e-02;  1.34977721e-01;  2.45757905e-01; -9.46869771e-02;
                    -5.68000802e-02;  1.14741919e-02;  4.30667533e-03; -5.99779304e-04;
                    -1.65168509e-04;  1.76311606e-05;  3.84465259e-06; -3.33286387e-07;
                    -6.02245535e-08;  4.39847063e-09;  6.78934693e-10; -4.28566072e-11;
                    -5.77546344e-12;  3.21145888e-13;  3.81500387e-14; -1.91860416e-15;;
                    -2.18748237e-02;  1.31982257e-01; -1.05419414e-01; -9.25856573e-02;
                    2.43647551e-02;  1.12195534e-02; -1.84737573e-03; -5.86468835e-04;
                    7.08500806e-05;  1.72398850e-05; -1.64918814e-06; -3.25890003e-07;
                    2.58337046e-08;  4.30085866e-09; -2.91233294e-10; -4.19056161e-11;
                    2.47740717e-12;  3.13971071e-13; -1.63896674e-14; -1.86656246e-15;;
                    -1.94614349e-02; -5.15116531e-02; -9.37887817e-02;  3.61354652e-02;
                    2.16766591e-02; -4.37890482e-03; -1.64355988e-03;  2.28894245e-04;
                    6.30333872e-05; -6.72859363e-06; -1.46723778e-06;  1.27192345e-07;
                    2.29835435e-08; -1.67859177e-09; -2.59102349e-10;  1.63554240e-11;
                    2.20410495e-12; -1.22533927e-13; -1.46133106e-14;  7.35522754e-16;;
                    6.99889336e-03; -4.22279857e-02;  3.37291511e-02;  2.96229652e-02;
                    -7.79555184e-03; -3.58971843e-03;  5.91071539e-04;  1.87641870e-04;
                    -2.26686242e-05; -5.51593550e-06;  5.27661025e-07;  1.04269155e-07;
                    -8.26554515e-09; -1.37606830e-09;  9.31806780e-11;  1.34078165e-11;
                    -7.92661076e-13; -1.00423142e-13;  5.20070098e-15;  6.04117451e-16;;
                    5.33566892e-03;  1.41227575e-02;  2.57137199e-02; -9.90712551e-03;
                    -5.94300864e-03;  1.20054798e-03;  4.50608672e-04; -6.27550802e-05;
                    -1.72816283e-05;  1.84475338e-06;  4.02267100e-07; -3.48718500e-08;
                    -6.30131230e-09;  4.60213227e-10;  7.10371188e-11; -4.48410710e-12;
                    -6.04214595e-13;  3.36380229e-14;  3.98379246e-15; -2.09901541e-16;;
                    -1.67122953e-03;  1.00834022e-02; -8.05400947e-03; -7.07351457e-03;
                    1.86145949e-03;  8.57170288e-04; -1.41138914e-04; -4.48060312e-05;
                    5.41292347e-06;  1.31712169e-06; -1.25997446e-07; -2.48978919e-08;
                    1.97368678e-09;  3.28584191e-10; -2.22501628e-11; -3.20155773e-12;
                    1.89271775e-13;  2.40042361e-14; -1.22384741e-15; -1.51788304e-16;;
                    -1.12379157e-03; -2.97451661e-03; -5.41578986e-03;  2.08662574e-03;
                    1.25170866e-03; -2.52857835e-04; -9.49066056e-05;  1.32173924e-05;
                    3.63983382e-06; -3.88539530e-07; -8.47249673e-08;  7.34466326e-09;
                    1.32717406e-09; -9.69295125e-11; -1.49617689e-11;  9.44391809e-13;
                    1.27321331e-13; -7.07940651e-15; -8.50665025e-16;  4.66206934e-17;;
                    3.13650769e-04; -1.89241920e-03;  1.51154956e-03;  1.32753356e-03;
                    -3.49352491e-04; -1.60870853e-04;  2.64884794e-05;  8.40904609e-06;
                    -1.01587937e-06; -2.47192995e-07;  2.36467793e-08;  4.67275305e-09;
                    -3.70414903e-10; -6.16675576e-11;  4.17581445e-12;  6.00883736e-13;
                    -3.55069706e-14; -4.50063164e-15;  2.76471554e-16;  1.49619900e-17;;
                    1.89522537e-04;  5.01639228e-04;  9.13349294e-04; -3.51900313e-04;
                    -2.11095196e-04;  4.26433691e-05;  1.60055843e-05; -2.22905548e-06;
                    -6.13842069e-07;  6.55254940e-08;  1.42884955e-08; -1.23864532e-09;
                    -2.23822115e-10;  1.63467490e-11;  2.52322006e-12; -1.59306040e-13;
                    -2.14301775e-14;  1.17625094e-15;  1.25767452e-16;  8.02309608e-18;;
                    -4.78699312e-05;  2.88824342e-04; -2.30695349e-04; -2.02610503e-04;
                    5.33187907e-05;  2.45523921e-05; -4.04271825e-06; -1.28340338e-06;
                    1.55045294e-07;  3.77270290e-08; -3.60901298e-09; -7.13163778e-10;
                    5.65334017e-11;  9.41182528e-12; -6.37325038e-13; -9.16781909e-14;
                    5.42811239e-15;  6.62149372e-16;  2.43403388e-17; -4.66206934e-18;;
                    -2.63362529e-05; -6.97083193e-05; -1.26919987e-04;  4.89004408e-05;
                    2.93340124e-05; -5.92576781e-06; -2.22415298e-06;  3.09751914e-07;
                    8.53001452e-08; -9.10549214e-09; -1.98554452e-09;  1.72123488e-10;
                    3.11025755e-11; -2.27155670e-12; -3.50589028e-13;  2.21502978e-14;
                    2.98681097e-15; -1.67753181e-16;  4.21483595e-18;  3.90312782e-18;;
                    6.08865033e-06; -3.67360133e-05;  2.93424970e-05;  2.57703422e-05;
                    -6.78169917e-06; -3.12285660e-06;  5.14199565e-07;  1.63238054e-07;
                    -1.97204499e-08; -4.79855896e-09;  4.59035895e-10;  9.07083746e-11;
                    -7.19054694e-12; -1.19703981e-12;  8.10918812e-14;  1.16999899e-14;
                    -7.13618482e-16; -8.31481422e-17;  1.95258035e-17;  1.14925430e-17;;
                    3.08026024e-06;  8.15301119e-06;  1.48444272e-05; -5.71934376e-06;
                    -3.43087502e-06;  6.93071526e-07;  2.60134577e-07; -3.62282557e-08;
                    -9.97661462e-09;  1.06496869e-09;  2.32227111e-10; -2.01313972e-11;
                    -3.63770033e-12;  2.65738594e-13;  4.10709088e-14; -2.56145791e-15;
                    -3.15545184e-16;  2.61013203e-17; -7.69360026e-18; -5.09575021e-18;;
                    -6.57525352e-07;  3.96719450e-06; -3.16875410e-06; -2.78299006e-06;
                    7.32369064e-07;  3.37243441e-07; -5.55294247e-08; -1.76283993e-08;
                    2.12965026e-09;  5.18205827e-10; -4.95722497e-11; -9.79580155e-12;
                    7.76543678e-13;  1.29308262e-13; -8.71592159e-15; -1.22439661e-15;
                    8.88524856e-17;  1.53778832e-18; -1.10160870e-17; -1.19262239e-17;;
                    -3.08270155e-07; -8.15947300e-07; -1.48561924e-06;  5.72387672e-07;
                    3.43359422e-07; -6.93620831e-08; -2.60340751e-08;  3.62569688e-09;
                    9.98452146e-10; -1.06581263e-10; -2.32411163e-11;  2.01471337e-12;
                    3.64069632e-13; -2.65750614e-14; -4.09980444e-15;  2.79946930e-16;
                    3.48510647e-17; -2.26034977e-17;  4.50250951e-18; -9.52742659e-18;;
                    6.11851039e-08; -3.69161747e-07;  2.94863990e-07;  2.58967256e-07;
                    -6.81495810e-08; -3.13817176e-08;  5.16721310e-09;  1.64038610e-09;
                    -1.98171638e-10; -4.82208876e-11;  4.61288656e-12;  9.11541933e-13;
                    -7.22717211e-14; -1.20474774e-14;  8.35252102e-16;  1.00545656e-16;
                    1.27374962e-17;  2.43358124e-17;  5.14101353e-18;  5.09575021e-18;;
                    2.67519968e-08;  7.08087345e-08;  1.28923545e-07; -4.96723829e-08;
                    -2.97970790e-08;  6.01931195e-09;  2.25926344e-09; -3.14641648e-10;
                    -8.66466843e-11;  9.24926549e-12;  2.01690985e-12; -1.74837705e-13;
                    -3.15909424e-14;  2.28338099e-15;  3.59473036e-16; -3.94246522e-17;
                    -4.72084946e-17;  1.26574516e-18;  2.64644989e-17;  1.08420217e-19;;
                    -4.96534422e-09;  2.99585198e-08; -2.39290467e-08; -2.10159252e-08;
                    5.53053126e-09;  2.54671512e-09; -4.19333965e-10; -1.33121984e-10;
                    1.60821871e-11;  3.91327100e-12; -3.74345797e-13; -7.39586235e-14;
                    5.84473205e-15;  9.70149653e-16; -6.10402796e-17; -4.65166581e-17;
                    -1.61687969e-17; -9.68862424e-18; -1.45891102e-17;  1.07336015e-17;;
                    -2.03529227e-09; -5.38712953e-09; -9.80850499e-09;  3.77907559e-09;
                    2.26696213e-09; -4.57949416e-10; -1.71884810e-10;  2.39379771e-11;
                    6.59204760e-12; -7.03709889e-13; -1.53466875e-13;  1.32700878e-14;
                    2.38268845e-15; -1.88327069e-16; -4.28491319e-17;  6.19072455e-18;
                    -1.32121341e-17;  1.12761857e-17; -3.40351561e-17; -1.03270257e-17;;
                    3.54967238e-10; -2.14170256e-09;  1.71066245e-09;  1.50240600e-09;
                    -3.95371913e-10; -1.82061995e-10;  2.99777427e-11;  9.51675183e-12;
                    -1.14972032e-12; -2.79794441e-13;  2.67499975e-14;  5.29835901e-15;
                    -4.46914871e-16; -8.83292958e-17; -2.25531774e-17; -2.49203076e-17;
                    2.09634645e-17;  1.83726977e-17; -3.60709593e-17;  5.85469173e-18;;
                    1.37012208e-10;  3.62651429e-10;  6.60290878e-10; -2.54400302e-10;
                    -1.52607803e-10;  3.08282569e-11;  1.15709698e-11; -1.61145100e-12;
                    -4.43780428e-13;  4.73708647e-14;  1.03369322e-14; -8.71307104e-16;
                    -1.84193320e-16; -8.70650111e-18; -1.59121392e-17;  2.92512807e-18;
                    -6.48292491e-19;  1.27092481e-17; -1.98229073e-17;  5.36680075e-18;;
                    -2.25462856e-11;  1.36032912e-10; -1.08655285e-10; -9.54272046e-11;
                    2.51126388e-11;  1.15638625e-11; -1.90406470e-12; -6.04429468e-13;
                    7.30174759e-14;  1.77450324e-14; -1.65464517e-15; -3.17499087e-16;
                    2.49848083e-17; -1.53803727e-17; -4.06793909e-17;  1.32805378e-17;
                    1.20796635e-17;  3.82887879e-17; -2.89131213e-17; -4.33680869e-18;;
                    -8.22612703e-12; -2.17733614e-11; -3.96434506e-11;  1.52740762e-11;
                    9.16251316e-12; -1.85088376e-12; -6.94710359e-13;  9.67497118e-14;
                    2.66375390e-14; -2.84884631e-15; -5.96123630e-16;  6.20434092e-17;
                    8.88472919e-18;  4.91247365e-18;  1.87918356e-17; -2.14266021e-17;
                    8.82289611e-18; -2.38437545e-17;  1.08430057e-17; -1.08420217e-18;;
                    1.28178750e-12; -7.73308193e-12;  6.17719864e-12;  5.42475225e-12;
                    -1.42763504e-12; -6.57348342e-13;  1.08245086e-13;  3.43597733e-14;
                    -4.17747029e-15; -9.93725456e-16;  8.73405181e-17;  2.26776801e-17;
                    1.79062347e-17; -5.97014386e-18;  2.58195826e-17;  2.79844237e-17;
                    -1.15790651e-17;  1.76807525e-17;  1.73942226e-17; -1.42030485e-17;;
                    4.43456578e-13;  1.17382615e-12;  2.13719783e-12; -8.23438555e-13;
                    -4.93952032e-13;  9.97903676e-14;  3.74798259e-14; -5.20882236e-15;
                    -1.42324671e-15;  1.21973853e-16;  4.62750811e-17;  3.78270524e-18;
                    -3.78281451e-18;  9.01908320e-18; -1.03887466e-17;  2.00346109e-17;
                    3.00580922e-17;  1.01088520e-17; -7.47030382e-18;  1.20346441e-17;;
                    -6.56681740e-14;  3.95864931e-13; -3.16551368e-13; -2.77678490e-13;
                    7.31438256e-14;  3.37027315e-14; -5.57876492e-15; -1.78908480e-15;
                    1.99466853e-16;  8.83116610e-17;  2.12951083e-17; -3.10712871e-17;
                    7.76068018e-18;  1.05960391e-18; -1.71968042e-18; -1.54783149e-17;
                    3.06399599e-17; -1.32173487e-17;  3.52209881e-17; -6.28837260e-18;;
                    -2.17006317e-14; -5.74776737e-14; -1.04599916e-13;  4.03179157e-14;
                    2.41529760e-14; -4.91423131e-15; -1.83970880e-15;  2.42273240e-16;
                    9.52277722e-17;  1.88663153e-17; -4.12873995e-18; -1.58428057e-17;
                    1.01037895e-17; -1.51542681e-17; -3.05459800e-17;  2.01218598e-17;
                    -3.91802196e-17;  1.98783667e-18;  2.34252406e-17; -7.91467586e-18;;
                    2.95369198e-15; -1.78146579e-14;  1.41804386e-14;  1.24857646e-14;
                    -3.32826425e-15; -1.54763729e-15;  2.41704017e-16;  6.29998429e-17;
                    3.42356256e-17; -3.03722802e-17; -1.96223880e-17; -4.31566314e-18;
                    -1.44600516e-17;  1.70077529e-17; -1.06254713e-17; -1.79694690e-17;
                    -5.40209546e-17; -3.08412860e-17;  9.51678124e-20;  1.61546124e-17;;
                    9.18210820e-16;  2.72974382e-15;  4.40756179e-15; -1.91607157e-15;
                    -1.04326463e-15;  2.39592143e-16;  4.27662140e-17; -2.65367529e-17;
                    -5.25857538e-18;  5.06907017e-18; -1.23852289e-17; -2.53777332e-17;
                    1.53689204e-17;  5.02569613e-19;  4.22516209e-18; -2.20401194e-17;
                    -3.32089439e-17; -2.88861646e-17;  3.50411152e-17;  2.92734587e-18]
        transformed_coeffs_10 = transformChebInPlace1D(coeffs_10,alpha_10,beta_10)
        @test ((20,48) == size(transformed_coeffs_10))
        @test isapprox(transformed_coeffs_10[11,1], -0.00000287423045388161)
        @test isapprox(transformed_coeffs_10[20,1], -0.00000000000000133806,atol=2^-52)
        @test isapprox(transformed_coeffs_10[9,5], 0.00027335694312178378)
        @test isapprox(transformed_coeffs_10[10,48], 0,atol=2^-52)
    end
end

function test_transformChebInPlaceND()
    @testset "transformChebInPlaceND unit tests" begin
        alpha_1 = 0.8043138619259216
        beta_1 = 0.19568613807407842
        dim_1 = 0
        coeffs_1 = [1.6668764854819471; 0.502737971117991; 0.003441591526151544;;0.5575078290711436; 0; 0;; 0.01239107183457752; 0.0; 0.0;;;
                            -1.20687653838567; 0; 0;; 0; 0; 0;;0.0; 0.0; 0.0;;;
                            -0.018876295666785736; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_1 = [ 1.43592664172332273864;  0.50273797111799101156;  0.00344159152615154413;;
                                                     0.55750782907114360132;  0.;          0.;;
                                                     0.01239107183457751997;  0.;          0.;;;
                                                    -0.98259152221737600108;  0.;          0.;;
                                                     0.;          0.;          0.;;
                                                     0.;          0.;          0.;;;
                                                    -0.01221146807645548740;  0.;          0.;;
                                                     0.;          0.;          0.;;
                                                     0.;          0.;          0.        ]
        transformed_coeffs_1 = TransformChebInPlaceND(coeffs_1,dim_1,alpha_1,beta_1,false)
        @test isapprox(expected_transformed_coeffs_1,transformed_coeffs_1)

        alpha_2 = 0.561531793052032
        beta_2 = -0.43846820694796795
        dim_2 = 0
        coeffs_2 = [2.071105809166741; -1.20687653838567; -0.018876295666785736;;0.5575078290711436; 0; 0;;0.01239107183457752; 0.0; 0.0;;;
                        0.9144403736144754; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0;;;
                        0.010914670337842268; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_2 = [ 1.66687648548194711218; -1.20687653838567010567; -0.01887629566678573553 ;;
                                                 0.55750782907114360132;  0.;          0.;;
                                                 0.01239107183457751997;  0.;          0.;;;
                                                 0.50273797111799101156;  0.;          0.;;
                                                 0.;          0.;          0.;;
                                                 0.;          0.;          0.;;;
                                                 0.00344159152615154413;  0.;          0.;;
                                                 0.;          0.;          0.;;
                                                 0.;          0.;          0.        ]
        transformed_coeffs_2 = TransformChebInPlaceND(coeffs_2,dim_2,alpha_2,beta_2,false)
        @test isapprox(expected_transformed_coeffs_2,transformed_coeffs_2)
        
        alpha_3 = 0.561531793052032
        beta_3 = 0
        dim_3 = 0
        coeffs_3 = [2.071105809166741; -1.20687653838567; -0.018876295666785736;;0.5575078290711436; 0; 0;;0.01239107183457752; 0.0; 0.0;;;
                        0.9144403736144754; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0;;;
                        0.010914670337842268; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_3 =  [2.06363273035505034869; -1.20687653838567010567; -0.01887629566678573553;;
                                                 0.55750782907114360132;  0.;          0.;;
                                                 0.01239107183457751997;  0.;          0.;;;
                                                 0.51348734263490647400;  0.;          0.;;
                                                 0.;          0.;          0.;;
                                                 0.;          0.;          0.;;;
                                                 0.00344159152615154413;  0.;          0.;;
                                                 0.;          0.;          0.;;
                                                 0.;          0.;          0.]
        transformed_coeffs_3 = TransformChebInPlaceND(coeffs_3,dim_3,alpha_3,beta_3,false)
        @test isapprox(expected_transformed_coeffs_3,transformed_coeffs_3)
        
        alpha_4 = 0
        beta_4 = -0.43846820694796795
        dim_4 = 0
        coeffs_4 = [2.071105809166741; -1.20687653838567; -0.018876295666785736;;0.5575078290711436; 0; 0;;0.01239107183457752; 0.0; 0.0;;;
                        0.9144403736144754; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0;;;
                        0.010914670337842268; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_4 =  [1.66343489395579569035; -1.20687653838567010567; -0.01887629566678573553 ;;
                                                 0.55750782907114360132;  0.;          0.;;
                                                 0.01239107183457751997;  0.;          0.;;;
                                                 0.;          0.;          0.;;
                                                 0.;          0.;          0.;;
                                                 0.;          0.;          0.]
        transformed_coeffs_4 = TransformChebInPlaceND(coeffs_4,dim_4,alpha_4,beta_4,false)
        @test isapprox(expected_transformed_coeffs_4,transformed_coeffs_4)
        
        alpha_5 = 0
        beta_5 = 0
        dim_5 = 0
        coeffs_5 = [2.071105809166741; -1.20687653838567; -0.018876295666785736;;0.5575078290711436; 0; 0;;0.01239107183457752; 0.0; 0.0;;;
                        0.9144403736144754; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0;;;
                        0.010914670337842268; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_5 =  [2.06019113882889870482; -1.20687653838567010567; -0.01887629566678573553 ;;
                                                     0.55750782907114360132;  0.;          0.;;
                                                     0.01239107183457751997;  0.;          0.;;;
                                                     0.;          0.;          0.;;
                                                     0.;          0.;          0.;;
                                                     0.;          0.;          0.]
        transformed_coeffs_5 = TransformChebInPlaceND(coeffs_5,dim_5,alpha_5,beta_5,false)
        @test isapprox(expected_transformed_coeffs_5,transformed_coeffs_5)
        
        alpha_6 = 1.000000082740371e-10
        beta_6 = -0.7266187050359711
        coeffs_6 = [10.1; 13.9]
        dim_6 = 0
        expected_transformed_coeffs_6 = [0.00000000000000000000; 0.00000000139000011501]
        transformed_coeffs_6 = TransformChebInPlaceND(coeffs_6,dim_6,alpha_6,beta_6,false)
        @test isapprox(expected_transformed_coeffs_6,transformed_coeffs_6)

        alpha_7 = 1
        beta_7 = 0
        coeffs_7 = [10.1; 13.9]
        dim_7 = 0
        expected_transformed_coeffs_7 = [10.1; 13.9]
        transformed_coeffs_7 = TransformChebInPlaceND(coeffs_7,dim_7,alpha_7,beta_7,false)
        @test isapprox(expected_transformed_coeffs_7,transformed_coeffs_7)

        alpha_8 = 0.561531793052032
        beta_8 = -0.43846820694796795
        dim_8 = 1
        coeffs_8 = [2.071105809166741; -1.20687653838567; -0.018876295666785736;;0.5575078290711436; 0; 0;;0.01239107183457752; 0.0; 0.0;;;
                        0.9144403736144754; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0;;;
                        0.010914670337842268; 0; 0;;0; 0; 0;;0.0; 0.0; 0.0]
        expected_transformed_coeffs_8 =  [1.82293688196746050956; -1.20687653838567010567; -0.01887629566678573553 ;;
                                                 0.30085495746356821778;  0.;          0.;;
                                                 0.00390712742628263315;  0.;          0.;;;
                                                 0.91444037361447538803;  0.;          0.;;
                                                 0.;          0.;          0.;;
                                                 0.;          0.;          0.;;;
                                                 0.01091467033784226763;  0.;          0.;;
                                                 0.;          0.;          0.;;
                                                 0.;          0.;          0.]
        transformed_coeffs_8 = TransformChebInPlaceND(coeffs_8,dim_8,alpha_8,beta_8,false)
        @test isapprox(expected_transformed_coeffs_8,transformed_coeffs_8)

        alpha_9 = 1.2837492384
        beta_9 = .7234444321123415
        dim_9 = 4
        coeffs_9 = reshape(collect(0:4*2*4*3*4*3-1),(3,4,3,4,2,4))
        transformed_coeffs_9 = TransformChebInPlaceND(coeffs_9,dim_9,alpha_9,beta_9,false)
        @test isapprox(transformed_coeffs_9[3,4,3,4,2,4], 2435.0950647445447)
        @test isapprox(transformed_coeffs_9[1,1,1,1,1,1], 70.81780444042236410951)
        @test isapprox(transformed_coeffs_9[1,2,1,1,1,1], 121.16430035593349145984)
        @test isapprox(transformed_coeffs_9[1,2,1,1,1,2], 4601.53072119819717045175)
        @test isapprox(transformed_coeffs_9[1,2,1,1,1,2], 4601.53072119819717045175)
        @test isapprox(transformed_coeffs_9[1,2,1,3,2,4], 16922.53837851442222017795)
        @test isapprox(transformed_coeffs_9[1,2,1,3,2,3], 12442.17195767216071544681)

        alpha_10 = 1.2837492384
        beta_10 = .7234444321123415
        dim_10 = 2
        coeffs_10 = reshape(collect(0:4*2*4*3*4*3-1),(3,4,3,4,2,4))   
        transformed_coeffs_10 = TransformChebInPlaceND(coeffs_10,dim_10,alpha_10,beta_10,false)
        @test isapprox(2435.09506474454474300728,transformed_coeffs_10[3,4,3,4,2,4])
        @test isapprox(849.81365328506842615752,transformed_coeffs_10[1,1,1,1,1,1])
        @test isapprox(879.56123276256857934641,transformed_coeffs_10[1,2,1,1,1,1])
        @test isapprox(3735.32886260257600952173,transformed_coeffs_10[1,2,1,1,1,2])
        @test isapprox(9789.53127017231054196600,transformed_coeffs_10[1,2,1,3,2,4])
        @test isapprox(7254.70410722685846849345,transformed_coeffs_10[1,2,1,3,2,3])
        @test isapprox(8423.43048113694567291532,transformed_coeffs_10[2,2,2,2,2,2])
        @test isapprox(5981.00850866390646842774,transformed_coeffs_10[1,2,1,2,1,2])
        @test isapprox(2361.04786468715201408486,transformed_coeffs_10[1,1,1,4,2,4])
        @test isapprox(7536.35156977635233488400,transformed_coeffs_10[3,4,3,3,2,3])

        alpha_11 = 3.456654
        beta_11 = .451324
        dim_11 = 2
        coeffs_11 = reshape(collect(0:3*2*1*2-1),(2,1,2,3))
        expected_transformed_coeffs_11 = coeffs_11
        transformed_coeffs_11 = TransformChebInPlaceND(coeffs_11,dim_11,alpha_11,beta_11,false)
        @test isapprox(transformed_coeffs_11,expected_transformed_coeffs_11)
    end
end

function test_getTransformationError()
    @testset "getTransformationError unit tests" begin
        M_1 = [0; -.939093750; 0; -.0138146058; -.00106830799; -.0137307266;;
                0; -1.05695980; 0; -.0149230031; .00237984138; -.0298460061;;
                0; 0;  0;  0; 0; 0;;
                0; -1.63828770; 0; -1.63828770; -.00611697632; -.00852711940;;
                0; 0; 0; 0; 0; 0;;
                0; 0;  0;  0.0; 0.0; 0.0]
        dim_1a = 0
        dim_1b = 1
        expected_error_1a = 0.00000000000000714500
        expected_error_1b = 0.00000000000000714500
        @test isapprox(expected_error_1a,getTransformationError(M_1,dim_1a),atol = 2^-52)
        @test isapprox(expected_error_1b,getTransformationError(M_1,dim_1b),atol = 2^-52)

        M_2 = [-1.09679818; -.939093750; -.921375000; -.0138146058; -.00106830799; -.0137307266;;
                .915137070; -1.05695980; -1.03701717; -.0149230031; .00237984138; -.0298460061;;
                .000607404435; -.00309112001;  .000675877264;  .0750781250; -1.10873059; -.0379851973;;
                1.42079568; -1.63828770; -1.60737661; -1.63828770; -.00611697632; -.00852711940;;
                .901029633; -.240222558; -1.16359475; -1.12860484; -.0167700634; -1.01490072;;
                .310991071; -1.58265345;  .346049159;  0.0; 0.0; 0.0]
        dim_2a = 0
        dim_2b = 1
        expected_error_2a = 0.00000000000002703507
        expected_error_2b = 0.00000000000002703507
        @test isapprox(expected_error_2a,getTransformationError(M_2,dim_2a),atol = 2^-52)
        @test isapprox(expected_error_2b,getTransformationError(M_2,dim_2b),atol = 2^-52)

        M_3 = reshape(collect(0:4*2*4*3*4*3-1),(3,4,3,4,2,4))
        dim_3a = 0
        dim_3b = 1
        dim_3c = 2
        dim_3d = 3
        dim_3e = 4
        dim_3f = 5
        expected_error_3a = 0.00000000058884097598
        expected_error_3b = 0.00000000029442048799
        expected_error_3c = 0.00000000058884097598
        expected_error_3d = 0.00000000044163073198
        expected_error_3e = 0.00000000058884097598
        expected_error_3f = 0.00000000044163073198
        @test isapprox(expected_error_3a,getTransformationError(M_3,dim_3a))
        @test isapprox(expected_error_3b,getTransformationError(M_3,dim_3b))
        @test isapprox(expected_error_3c,getTransformationError(M_3,dim_3c))
        @test isapprox(expected_error_3d,getTransformationError(M_3,dim_3d))
        @test isapprox(expected_error_3e,getTransformationError(M_3,dim_3e))
        @test isapprox(expected_error_3f,getTransformationError(M_3,dim_3f))

        M_4 = [10.1; 13.9]
        dim_4 = 0
        expected_error_4 = 0.00000000000001065814
        @test isapprox(expected_error_4,getTransformationError(M_4,dim_4),atol = 2^-52)

        M_5 = reshape(collect(0:3*2*1*2-1),(2,1,2,3))
        dim_5a = 0
        dim_5b = 1
        dim_5c = 2
        expected_error_5a = 0.00000000000004396483
        expected_error_5b = 0.00000000000002930989
        expected_error_5c = 0.00000000000001465494
        @test isapprox(expected_error_5a,getTransformationError(M_5,dim_5a),atol = 2^-52)
        @test isapprox(expected_error_5b,getTransformationError(M_5,dim_5b),atol = 2^-52)
        @test isapprox(expected_error_5c,getTransformationError(M_5,dim_5c),atol = 2^-52)
    end
end

function test_transformCheb()
    @testset "test_transformCheb unit tests" begin
        M_1 = [-4.51013026e-01;  9.19663154e-02;  3.28195239e-03; -1.11200236e-04;
                        -1.98249324e-06;  4.02883056e-08;  4.78752802e-10; -6.94867420e-12;
                        -6.19244882e-14;  6.99276156e-16;;
                         7.27945065e-01;  1.04163259e-01; -5.29714422e-03; -1.25948060e-04;
                        3.19978823e-06;  4.56315034e-08; -7.72717627e-10; -7.87022401e-12;
                        9.99484941e-14;  7.91457512e-16;;
                         1.81446642e-01; -3.69988851e-02; -1.32035929e-03;  4.47368662e-05;
                        7.97575060e-07; -1.62083517e-08; -1.92606607e-10;  2.79551450e-12;
                        2.49127467e-14; -2.81327865e-16;;
                        -4.17559211e-02; -5.97494652e-03;  3.03851412e-04;  7.22455238e-06;
                        -1.83544214e-07; -2.61748523e-09;  4.43241362e-11;  4.51446745e-13;
                        -5.73318646e-15; -4.53994547e-17;;
                        -5.00176929e-03;  1.01991354e-03;  3.63971055e-05; -1.23321921e-06;
                        -2.19860032e-08;  4.46800419e-10;  5.30940553e-12; -7.70612943e-14;
                        -6.86741392e-16;  7.75549577e-18;;
                         6.79328350e-04;  9.72065866e-05; -4.94336787e-06; -1.17536462e-07;
                        2.98608640e-09;  4.25839466e-11; -7.21110716e-13; -7.34459600e-15;
                        9.32741098e-17;  7.38663524e-19;;
                         5.37888317e-05; -1.09681104e-05; -3.91413052e-07;  1.32619912e-08;
                        2.36436622e-10; -4.80487396e-12; -5.70971172e-14;  8.28713695e-16;
                        7.38494412e-18; -8.34261085e-20;;
                        -5.19217396e-06; -7.42959583e-07;  3.77826509e-08;  8.98342840e-10;
                        -2.28229544e-11; -3.25473312e-13;  5.51152192e-15;  5.61354057e-17;
                        -7.12925819e-19; -5.64783855e-21;;
                        -3.07353268e-07;  6.26725748e-08;  2.23656244e-09; -7.57799754e-11;
                        -1.35101600e-12;  2.74553819e-14;  3.26255769e-16; -4.73534687e-18;
                        -4.21905144e-20;  4.77555404e-22;;
                         2.30256366e-08;  3.29478896e-09; -1.67554015e-10; -3.98386405e-12;
                        1.01212572e-13;  1.44337509e-15; -2.44422320e-17; -2.49106366e-19;
                        3.14036001e-21;  2.34621142e-23;;
                         1.08873955e-09; -2.22005488e-10; -7.92259018e-12;  2.68435894e-13;
                        4.78570299e-15; -9.72564379e-17; -1.15559028e-18;  1.68156727e-20;
                        1.54803735e-22; -1.29305190e-24;;
                        -6.66587822e-11; -9.53835256e-12;  4.85065600e-13;  1.15330485e-14;
                        -2.93067929e-16; -4.18555482e-18;  7.11281170e-20;  9.22967944e-22;
                        1.80694558e-23;  1.99028925e-24;;
                        -2.62432122e-12;  5.35142174e-13;  1.90967049e-14; -6.47187222e-16;
                        -1.15810253e-17;  2.29061427e-19;  3.06343121e-21;  1.13252742e-22;
                        2.03470643e-23;  1.57395400e-24;;
                         1.35861175e-13;  1.94546693e-14; -9.88671456e-16; -2.35731916e-17;
                        5.79100447e-19;  6.38400554e-21; -3.33430711e-23;  5.97844983e-23;
                        8.27048604e-24;  6.25702768e-25;;
                         4.57944806e-15; -9.28412384e-16; -3.33314540e-17;  1.11036002e-18;
                        1.56847510e-20; -9.31871766e-22;  2.24091259e-23;  1.51210497e-23;
                        2.02797620e-24;  1.53675674e-25]
        alphas_1 = [0.96189495661543289451; 1.        ]
        betas_1 = [0.03810504338456710549; 0.        ]
        error_1 = 0.00000000000028849801
        expected_error_1 = 0.00000000000029762757
        expected_M_1 = [-0.43974878832814545682; 0.09790962437138257812; 0.00319998426562025659; -0.00011838653413301305; -0.00000193297964769047; 0.00000004289193115029; 0.00000000046679575372; -0.00000000000739773081; -0.00000000000006037786; 0.00000000000000074445 ;;
                        0.73382406700715940850; 0.09616717824478956955; -0.00533992481250061737; -0.00011627967149287864; 0.00000322563023680718; 0.00000004212860624002; -0.00000000077895822145; -0.00000000000726606662; 0.00000000000010075566; 0.00000000000000073067 ;;
                        0.16042890271866691587; -0.03571933349524124279; -0.00116741643577678196; 0.00004318970799154190; 0.00000070518853532431; -0.00000001564780988304; -0.00000000017029616202; 0.00000000000269883564; 0.00000000000002202698; -0.00000000000000027159 ;;
                        -0.03869481688259344271; -0.00507093120518843643; 0.00028157622771512390; 0.00000613147046166299; -0.00000017008868596417; -0.00000000222145712796; 0.00000000004107475761; 0.00000000000038314238; -0.00000000000000531289; -0.00000000000000003853 ;;        
                        -0.00407823109186094927; 0.00090801404078298925; 0.00002967666013869413; -0.00000109791694474066; -0.00000001792645694906; 0.00000000039777984889; 0.00000000000432906468; -0.00000000000006860653; -0.00000000000000055994; 0.00000000000000000690 ;;
                        0.00058127963246545119; 0.00007617632707219498; -0.00000422988244013509; -0.00000009210791453205; 0.00000000255509902629; 0.00000000003337107873; -0.00000000000061703147; -0.00000000000000575562; 0.00000000000000007981; 0.00000000000000000058 ;;
                        0.00004052235723314688; -0.00000902226198556183; -0.00000029487495861151; 0.00000001090918624004; 0.00000000017812190685; -0.00000000000395244304; -0.00000000000004301469; 0.00000000000000068169; 0.00000000000000000556; -0.00000000000000000007 ;;
                        -0.00000410652300914701; -0.00000053815723510380; 0.00000002988253600122; 0.00000000065070793882; -0.00000000001805081809; -0.00000000000023575418; 0.00000000000000435910; 0.00000000000000004066; -0.00000000000000000056; -0.00000000000000000000 ;;        
                        -0.00000021407455390090; 0.00000004766348362659; 0.00000000155778758975; -0.00000000005763186888; -0.00000000000094099583; 0.00000000000002088025; 0.00000000000000022724; -0.00000000000000000360; -0.00000000000000000003; 0.00000000000000000000 ;;
                        0.00000001683961804348; 0.00000000220682126834; -0.00000000012253930966; -0.00000000000266835780; 0.00000000000007402103; 0.00000000000000096676; -0.00000000000000001788; -0.00000000000000000017; 0.00000000000000000000; 0.00000000000000000000 ;;
                        0.00000000070128897094; -0.00000000015614129252; -0.00000000000510317197; 0.00000000000018879675; 0.00000000000000308259; -0.00000000000000006840; -0.00000000000000000074; 0.00000000000000000001; 0.00000000000000000000; -0.00000000000000000000 ;;
                        -0.00000000004508795998; -0.00000000000590874393; 0.00000000000032809804; 0.00000000000000714434; -0.00000000000000019825; -0.00000000000000000260; 0.00000000000000000005; 0.00000000000000000000; 0.00000000000000000000; 0.00000000000000000000 ;;
                        -0.00000000000156349257; 0.00000000000034813249; 0.00000000000001137723; -0.00000000000000042105; -0.00000000000000000691; 0.00000000000000000015; 0.00000000000000000000; 0.00000000000000000000; 0.00000000000000000000; 0.00000000000000000000 ;;
                        0.00000000000008493743; 0.00000000000001114263; -0.00000000000000061810; -0.00000000000000001351; 0.00000000000000000036; 0.00000000000000000000; -0.00000000000000000000; 0.00000000000000000000; 0.00000000000000000000; 0.00000000000000000000 ;;
                        0.00000000000000265828; -0.00000000000000053892; -0.00000000000000001935; 0.00000000000000000064; 0.00000000000000000001; -0.00000000000000000000; 0.00000000000000000000; 0.00000000000000000000; 0.00000000000000000000; 0.00000000000000000000 ]
        M_1o, error_1o = transformCheb(M_1,alphas_1,betas_1,error_1,false)
        @test isapprox(expected_M_1,M_1o)
        @test isapprox(expected_error_1,error_1o)

        M_2 = [-1.42428995; -4.37529946e-01; -4.90606009e-03;;
                     4.12980070e-01; -5.11290053e-18; -9.88218875e-20;;
                     1.47492882e-02;  1.10826219e-19;  2.22922861e-21;;;

                     7.76288054e-01; -1.01807649e-18; -9.10966739e-21;;
                     6.36918820e-18;  6.16456054e-20;  9.06529547e-21;;
                    -9.68352712e-20; -4.06835665e-21; -2.76670990e-22;;;

                     2.53412195e-02;  2.94136768e-20;  9.60324957e-22;;
                     4.76059766e-20;  1.23291339e-20;  4.02532979e-22;;
                    -1.25194459e-21; -3.24232242e-22; -1.05858345e-23]
        alphas_2 = [0.44122451303066934081; 0.82937977695676190493; 0.01065031960613682660]
        betas_2 = [0.55877548696933065919; 0.17062022304323809507; -0.98934968039386317340]
        error_2 = 0.00000000000022718514
        expected_error_2 = 0.00000000000023213989
        expected_M_2 = [-0.50021325263737104194; -0.00445305529429256258; -0.00000055649099960640 ;;
                        0.35086594422925271308; -0.00000000000000000004; -0.00000000000000000000 ;;
                        0.01014560488632080225; 0.00000000000000000000; 0.00000000000000000000 ;;;
                        0.36750836726079333383; -0.00000000000000000000; -0.00000000000000000000 ;;
                        0.00000000000000000232; 0.00000000000000000000; 0.00000000000000000000 ;;
                        -0.00000000000000000003; -0.00000000000000000000; -0.00000000000000000000 ;;;
                        0.00493340506771145545; 0.00000000000000000000; 0.00000000000000000000 ;;
                        0.00000000000000000001; 0.00000000000000000000; 0.00000000000000000000 ;;
                        -0.00000000000000000000; -0.00000000000000000000; -0.00000000000000000000 ]
        M_2o, error_2o = transformCheb(M_2,alphas_2,betas_2,error_2,false)
        @test isapprox(expected_M_2,M_2o)
        @test isapprox(expected_error_2,error_2o)

        M_3 = [ 8.75387801e-01;  1.36733727; -2.06671771e-01; -4.89626363e-02;
                        3.60945024e-03;  5.07729589e-04; -2.48175025e-05; -2.48561588e-06;
                        9.09356531e-08;  7.07398165e-09; -2.06836247e-10; -1.31550450e-11;
                        3.20362427e-13;  1.72323883e-14; -3.59613936e-16]
        alphas_3 = [0.18998896132616549526]
        betas_3 = [-0.64021351452262786896]
        error_3 = 0.00000000000005539493
        expected_error_3 = 0.00000000000006372994
        expected_M_3 = [-0.00855022447641899143; 0.34186621455440019401; 0.00006322835752989059; -0.00042005189316723533; -0.00000003881104561047; 0.00000015464560890794; 0.00000000000952390464; -0.00000000002710314697; -0.00000000000000125172; 0.00000000000000277055; 0.00000000000000000010; -0.00000000000000000018; -0.00000000000000000000; 0.00000000000000000000; -0.00000000000000000000]
        M_3o, error_3o = transformCheb(M_3,alphas_3,betas_3,error_3,false)
        @test isapprox(expected_M_3,M_3o)
        @test isapprox(expected_error_3,error_3o,atol=2^-52)

        M_4 = reshape(collect(0:3*2*1*2-1),(2,1,2,3))
        alphas_4 = [0;.452345;1.2345;.231122]
        betas_4 = [.2345;.23223;.7134334;0]
        error_4 = 0.000000000000322211385
        expected_error_4 = 0.00000000000038909978
        expected_M_4 = [-7.45784067484999990683; -1.62556456928452175426;;;
                        -2.48481929227500009105; -0.53828204259785872310;;;;
                            0.;          0.        ;;;
                            0.;          0.        ]
        M_4o, error_4o = transformCheb(M_4,alphas_4,betas_4,error_4,false)
        @test isapprox(expected_error_4,error_4o)
        @test isapprox(expected_M_4,M_4o)

        M_5 = reshape(collect(0:3*2*1*2-1),(2,1,2,3))
        alphas_5 = [.34352340;1;1.2345;.231122]
        betas_5 = [.2345;0;.7134334;0]
        error_5 = 0.000000000000322211385
        expected_error_5 = 0.00000000000041332051
        expected_M_5 = [-5.23808938921952016443; -1.10374635329209302981;;;
                        -4.31311173652439983073; -0.88996366824589145939;;;;
                        3.95189319359999924330;  1.06723854865502154610;;;
                        5.28338989199999886637;  1.37497672858262620643;;;;
                        0.94406661078047993119;  0.24546888361890686903;;;
                        1.18008326347559999725;  0.30001752442310836155]
        M_5o, error_5o = transformCheb(M_5,alphas_5,betas_5,error_5,false)
        @test isapprox(expected_error_5,error_5o)
        @test isapprox(expected_M_5,M_5o)
    end
end

function test_transformChebToInterval()
    @testset "transformChebToInterval unit tests" begin
        macheps = 2^-52
        Ms_1 = [[ 0.87538780085034118006; 1.36733727263328685986; -0.20667177063640954082; -0.04896263625573957917; 0.00360945024389840467; 0.00050772958892000960; -0.00002481750254547087; -0.00000248561588318162; 0.00000009093565308793; 0.00000000707398165416; -0.00000000020683624682; -0.00000000001315504499; 0.00000000000032036243; 0.00000000000001723239; -0.00000000000000035961]]
        alphas_1 = [0.18998896132616549526]
        betas_1 = [-0.64021351452262786896]
        errors_1 = [0.00000000000005539493]
        expected_errors_1 = [0.00000000000006372994]
        expected_Ms_1 = [[-0.00855022633478066431; 0.34186621489582563749; 0.00006322836537617769; -0.00042005189300300673; -0.00000003881104085161; 0.00000015464560895305; 0.00000000000952390380; -0.00000000002710314699; -0.00000000000000125172; 0.00000000000000277055; 0.00000000000000000010; -0.00000000000000000018; -0.00000000000000000000; 0.00000000000000000000; -0.00000000000000000000]]
        Ms_1o, errors_1o = transformChebToInterval(Ms_1,alphas_1,betas_1,errors_1,false)
        @test isapprox(expected_errors_1,errors_1o,atol=macheps)
        @test isapprox(expected_Ms_1,Ms_1o)

        Ms_2 = [[ 3.01924445803718777270;  4.78499999999999836575;  1.36124999999999940492;;
                -0.13304144200672343712; -0.00000000000000024441; -0.00000000000000037332;;;
                50.84383924153893730136; -0.00000000000000597462; -0.00000000000000030931;;
                23.42301358514872333672; -0.00000000000000329309; -0.00000000000000213851;;;
                -0.31145740117566766969; -0.00000000000000073241; -0.00000000000000019330;;
                -0.00000000000000118391;  0.00000000000000017905; -0.00000000000000010959;;;
                9.13909584474152758560;  0.00000000000000010478;  0.00000000000000072048;;
                0.00000000000000255458; -0.00000000000000051092; -0.00000000000000051092],
                        
                [932.93997799570774986933;  1.64999999999995838884;;
                    945.73221846531237133604; -0.00000000000014671498;;
                    540.41841055160671203339;  0.00000000000007091879;;
                    202.65690395685254543423; 0.00000000000000180518 ;;
                    45.03486754596718100174;  0.00000000000000267724;;
                    4.50348675459674385735; -0.00000000000001079404;;;
                    -13.22075132104947670086; -0.00000000000003233820;;
                    -0.00000000000012654154;  0.00000000000001375977;;
                    -0.00000000000006407432; -0.00000000000004061001;;
                    -0.00000000000006077647; -0.00000000000004586719;;
                    -0.00000000000000629748;  0.00000000000000130028;;
                    0.00000000000003153795;  0.00000000000001081673;;;
                    485.39468239849583142131; -0.00000000000004222750;;
                    -0.00000000000001631828;  0.00000000000001482070;;
                    0.00000000000005187971;  0.00000000000001678736;;
                    0.00000000000010345949;  0.00000000000001756181;;
                    -0.00000000000001760717;  0.00000000000001734247;;
                    -0.00000000000001690204; -0.00000000000001203396;;;
                    -5.51296359377681621794;  0.00000000000001245752;;
                    0.00000000000002091485; -0.00000000000006070816;;
                    0.00000000000004539195;  0.00000000000000088580;;
                    0.00000000000002750763; -0.00000000000003376336;;
                    -0.00000000000004004082; -0.00000000000000568368;;
                    -0.00000000000000046638;  0.00000000000000991819;;;
                    121.32518559981021155636; -0.00000000000002328803;;
                    -0.00000000000001178903; -0.00000000000004658793;;
                    -0.00000000000000153725; -0.00000000000003502838;;
                    -0.00000000000001124342; -0.00000000000005690449;;
                    -0.00000000000000974588; -0.00000000000000975038;;
                     0.00000000000000514566;  0.00000000000001886741],

                [ 10.34553371598983595447; -4.78500000000000103029; -1.36125000000000007105;;
                    11.06872364918539020096; -0.00000000000000004282; -0.00000000000000004528;;
                    2.76718091229634755024;  0.00000000000000002637;  0.00000000000000004228;;;
                    -0.12512660205771153343; -0.00000000000000023779; -0.00000000000000019424;;
                    0.00000000000000076056; -0.00000000000000032959; -0.00000000000000011374;;
                    -0.00000000000000023138;  0.00000000000000020298;  0.00000000000000003926;;;
                    5.50738562295691647108;  0.0;  0.00000000000000004409;;
                    0.00000000000000009825;  0.0;  0.00000000000000009825;;
                    -0.00000000000000011976;  0.0; -0.00000000000000011976]]
        alphas_2 = [0.86417270870175955100; 0.75180342430703261947; 1.00000000000000000000]
        betas_2 = [-0.05938270010834456603; -0.24819657569296732502; 0.00000000000000000000]
        errors_2 = [0.00000000000048115600; 0.00000000003228496772; 0.00000000000017069713]
        expected_errors_2 = [0.00000000000064044592; 0.00000000004055030241; 0.00000000000023397781]
        Ms_2o, errors_2o = transformChebToInterval(Ms_2,alphas_2,betas_2,errors_2,false)
        @test isapprox(expected_errors_2,errors_2o)
        @test isapprox(Ms_2o[1][1,1,1], -0.35636471344922321380)
        @test isapprox(Ms_2o[1][1,1,4], 5.89800141442508252254)
        @test isapprox(Ms_2o[1][2,2,3], 0.00000000000000020273,atol=macheps)
        @test isapprox(Ms_2o[1][2,1,1], 4.78499999999999836575)
        @test isapprox(Ms_2o[1][1,1,3], -2.66432558431007482369)
        @test (3,2,4) == size(Ms_2o[1])
        @test isapprox(Ms_2o[2][1,1,1], 349.72917483078248324091)
        @test isapprox(Ms_2o[2][2,6,5], 0.00000000000000252718,atol=macheps)
        @test isapprox(Ms_2o[2][1,1,2], -120.31913788045511637392)
        @test isapprox(Ms_2o[2][2,1,1], 1.64999999999997859490)
        @test isapprox(Ms_2o[2][2,5,3], 0.00000000000002636738,atol=macheps)
        @test (2,6,5) == size(Ms_2o[2])
        @test isapprox(Ms_2o[3][1,1,1], 5.38786388015445449895)
        @test isapprox(Ms_2o[3][3,1,1], -1.36125000000000007105)
        @test isapprox(Ms_2o[3][1,2,2], 0.00000000000000060986,atol=macheps)
        @test isapprox(Ms_2o[3][1,1,3], 4.11288512994231325592)
        @test (3,3,3) == size(Ms_2o[3])
        
        Ms_3 = [[0.20653057333214039359;  0.38056300994434943963;  0.00679945356876563572;;
                    -1.15823104043916003114; -0.00000000000000000197; -0.00000000000000000017;;;
                    2.29212896076844208082; -0.00000000000000005616; -0.00000000000000000118;;
                    0.92770607573225138953; -0.00000000000000000696; -0.00000000000000000015;;;
                    -0.25276068645084059927; -0.00000000000000000310; -0.00000000000000000015;;
                    -0.00000000000000002707;  0.00000000000000000041;  0.00000000000000000001;;;
                    0.03374220633875571473;  0.00000000000000000022;  0.00000000000000000002;;
                    0.00000000000000000283; -0.00000000000000000005; -0.00000000000000000000],
                            
                [8.34766263464057267640;  0.11661435219359800319;;
                    4.91935192145770550098; -0.00000000000000910713;;
                    2.22691523728039753038;  0.00000000000000077721;;
                    0.58760510890271600015;  0.00000000000000020352;;
                    0.08367297770328245565; -0.00000000000000003376;;
                    0.00497664468239305061;  0.00000000000000000121;;;
                    -5.87289121056221130601; -0.00000000000000167424;;
                    -0.00000000000000119003; -0.00000000000000006629;;
                    0.00000000000001006357;  0.00000000000000016244;;
                    -0.00000000000000020161;  0.00000000000000006572;;
                    -0.00000000000000019103; -0.00000000000000001331;;
                    0.00000000000000001096;  0.00000000000000000055;;;
                    2.86688528973940259803; -0.00000000000000000130;;
                    0.00000000000000274690;  0.00000000000000029296;;
                    -0.00000000000000033228; -0.00000000000000005682;;
                    -0.00000000000000019912; -0.00000000000000001946;;
                    0.00000000000000003057;  0.00000000000000000375;;
                    -0.00000000000000000108; -0.00000000000000000015;;;
                    -0.69149027528736262127;  0.00000000000000001606;;
                    -0.00000000000000003733;  0.00000000000000000303;;
                    -0.00000000000000005442; -0.00000000000000000174;;
                    0.00000000000000000478; -0.00000000000000000062;;
                    0.00000000000000000053;  0.00000000000000000013;;
                    -0.00000000000000000004; -0.00000000000000000001;;;
                    0.06923270350389446048; -0.00000000000000000101;;
                    -0.00000000000000001179; -0.00000000000000000139;;
                    0.00000000000000000063;  0.00000000000000000036;;
                    0.00000000000000000088;  0.00000000000000000010;;
                    -0.00000000000000000013; -0.00000000000000000002;;
                    0.0;  0.0],

                [-0.91853343720207980549; -0.38056300994434966167; -0.00679945356876563746;;
                    1.22208449103886085396; -0.00000000000000000268; -0.00000000000000000056;;
                    0.18171578359893975074; 0.00000000000000000024; 0.00000000000000000005;;;

                    -0.65700767064571219400; -0.00000000000000000194; -0.00000000000000000012;;
                    0.00000000000000005502; -0.00000000000000000281; -0.00000000000000000010;;
                    -0.00000000000000000248;  0.00000000000000000019;  0.00000000000000000001;;;

                    0.13156054072545317335;  0.00000000000000000002;  0.00000000000000000000;;
                    0.00000000000000000007;  0.00000000000000000007;  0.00000000000000000001;;
                    -0.00000000000000000001; -0.00000000000000000001; -0.0]]
        alphas_3 = [0.73688366977641883704; 0.95966057059377973815; 0.15397785734628577359]
        betas_3 = [0.26311633022358116296; -0.04033942940622026185; -0.84602214265371422641]
        errors_3 = [0.00000000000107853114; 0.00000000005026591813; 0.00000000000042185498]
        expected_errors_3 = [0.00000000000108814021; 0.00000000005032364909; 0.00000000000042866658]
        Ms_3o, errors_3o = transformChebToInterval(Ms_3,alphas_3,betas_3,errors_3,false)
        @test isapprox(expected_errors_3,errors_3o)
        @test isapprox(Ms_3o[1][1,1,1], 0.61289723392602202257)
        @test isapprox(Ms_3o[1][1,1,2], 1.45199604818886451874)
        @test isapprox(Ms_3o[1][3,2,4], 0.0)
        @test isapprox(Ms_3o[1][1,1,3], -0.10832362965094881335)
        @test isapprox(Ms_3o[1][3,1,1], 0.00016120947232328597)
        @test (3,2,4) == size(Ms_3o[1])
        @test isapprox(Ms_3o[2][1,1,1], 5.26249570529796883989)
        @test isapprox(Ms_3o[2][1,1,2], -1.83906340673611534697)
        @test isapprox(Ms_3o[2][1,1,5], 0.02041300864577325416)
        @test isapprox(Ms_3o[2][2,1,1], 0.01795602808659533395)
        @test isapprox(Ms_3o[2][1,5,4], 0.00000000000000000007,atol=macheps)
        @test isapprox(Ms_3o[2][2,1,2], -0.00000000000000019348,atol=macheps)
        @test (2, 6, 5) == size(Ms_3o[2])
        @test isapprox(Ms_3o[3][1,1,1], -0.87751264801507178337)
        @test isapprox(Ms_3o[3][1,1,2], -0.38210716859108229126)
        @test isapprox(Ms_3o[3][2,1,1], -0.05505525357920099810)
        @test isapprox(Ms_3o[3][2,2,3], 0.0,atol=macheps)
        @test isapprox(Ms_3o[3][2,2,2], -0.00000000000000000027,atol=macheps)
        @test (3, 3, 3) == size(Ms_3o[3])

        Ms_4 = [reshape(collect(0:3*2*2*3-1),(3,2,2,3)),reshape(collect(0:3*3*2*3-1),(3,2,3,3)),reshape(collect(1:4*2*2*2),(2,2,2,4)),reshape(collect(0:4*2*2*2-1),(2,2,2,4))]
        alphas_4 = [0.73688366977641883704; 0.95966057059377973815; 0.15397785734628577359;.293846263523452]
        betas_4 = [.199884327734;0.26311633022358116296; -0.04033942940622026185; -0.84602214265371422641]
        errors_4 = [.00000234789324;.000000000000004234;.000233333334;.00000009234324]
        expected_errors_5 = [0.00000234789445040824; 0.00000000000338671467; 0.00023333333491046737; 0.00000009234409761910]
        expected_Ms_4o_2 = [-1.08712410884770815933; 0.02187078161082947614;;
                                 -0.11786482249235769038; 0.11145519450050471455;;;
                                -0.41896033535596521880; 0.79330091989472983904;;
                                -0.02424701317422695013; 0.20929806351267382647;;;;
                                -0.55090590156698648894; 0.49640100317745783354;;
                                -0.04663452429610065453; 0.15933826999251132772;;;
                                -0.11809677021439801692; 0.95052686993315538277;;
                                0.01277762488328693102; 0.21305775899590809197;;;;
                                3.70391347172445506430; 9.83095256818280560651;;
                                0.66882837450361698473; 1.71961826646099957827;;;
                                3.35035417210369246277; 8.49255208687496576658;;
                                0.59419328771026957980; 1.47069952026760963903;;;;
                                1.51266334971313654023; 3.81230906305421246572;;
                                0.26768024021084824149; 0.65934372035125055067;;;
                                1.32893849639622985137; 3.23932689869999634880;;
                                0.23220194341292943463; 0.55595913535956786866]
        expected_Ms_4o_3 = [-1.25628180830922575595; -0.30094419185125614868;;
                                -0.14500623156431272087; 0.05965942477096922852;;;
                                -0.54747896068070800446; 0.54804021490961907226;;
                                -0.04486786930083647151; 0.16994590192341496593;;;;
                                -0.67578565587819638960; 0.25808459959516849569;;
                                -0.06667152235977241714; 0.12110032387019763200;;;
                                -0.21297494842359654399; 0.76946448448908788542;;
                                -0.00244561032844214932; 0.18400623910337496336;;;;
                                3.48101720733306763123; 9.40558469014145970277;;
                                0.63306459483697619106; 1.65136784912415235382;;;
                                3.18100733432573790083; 8.16937616808910860300;;
                                0.56702153133261212758; 1.41884583674097086714;;;;
                                1.43798132738737116654; 3.66978835526537272571;;
                                0.25569748491967914106; 0.63647622544185411542;;;
                                1.27219836055652102402; 3.13104589521248888317;;
                                0.22309796976865481355; 0.53858541237958135195]
        Ms_4o,errors_4o = transformChebToInterval(Ms_4,alphas_4,betas_4,errors_4,false)
        @test isapprox(expected_errors_5,errors_4o)
        @test isapprox(Ms_4o[1][1,1,1,1], -4.47475873930734557860)
        @test isapprox(Ms_4o[1][2,1,1,1], 3.17287986215911832488)
        @test isapprox(Ms_4o[1][2,1,2,3], -11.31328479941790376984)
        @test isapprox(Ms_4o[1][2,1,2,2], -21.92304469635405439476)
        @test (3,2,2,3) == size(Ms_4o[1])
        @test isapprox(Ms_4o[2][1,1,1,1], -7.18227192058273544717)
        @test isapprox(Ms_4o[2][3,2,3,3], 0.35237708132216383206)
        @test isapprox(Ms_4o[2][3,2,1,3], 0.40800102086722889183)
        @test (3,2,3,3) == size(Ms_4o[2])
        @test isapprox(Ms_4o[3], expected_Ms_4o_2)
        @test (2,2,2,4) == size(Ms_4o[3])
        @test isapprox(Ms_4o[4], expected_Ms_4o_3)
        @test (2,2,2,4) == size(Ms_4o[4])
    end
end

function test_getSubdivisionDims()
    @testset "getSubdivisionDims unit tests" begin
        trackedInterval_1 = TrackedInterval([-0.63673497;  0.75388677;;
                                             -1.;          0.24771388;;
                                             -1.;          1.        ])
        Ms_1 = [[-1.19628962e-01;  4.78500000;  1.36125000;;       
                            -1.22216380; -5.88038994e-17; -1.29732624e-16;;;       

                         2.75448343e+01; -4.09625873e-15; -5.24707922e-16;;        
                             1.38346959e+01; -1.64018392e-15; -9.14780575e-16;;;       

                        -2.34899407; -5.34145567e-16; -3.02474728e-16;;        
                            -1.00260753e-15;  1.73733322e-16;  3.97924039e-17;;;       

                         4.43170528;  1.12302734e-16;  4.10866620e-16;;        
                             9.31305763e-16; -1.86261153e-16; -1.86261153e-16],

                [ 2.84845613e+02;  1.65000000;;
                             2.27137940e+02; -1.72605562e-13;;
                             1.29793108e+02;  2.54414728e-14;;
                             4.86724156e+01;  6.09220633e-15;;
                             1.08160924e+01;  1.01171420e-14;;
                             1.08160924; -3.13565083e-15;;;

                        -9.64091464e+01; -2.86049313e-14;;
                             4.14691757e-14;  7.88666604e-14;;
                             2.67503292e-14; -9.27142549e-15;;
                            -6.34389840e-14; -6.91944204e-15;;
                            -1.24333103e-14; -2.02584903e-15;;
                             6.92587964e-15;  8.01648088e-16;;;

                         1.93541862e+02; -5.17408223e-14;;
                            -5.39535253e-14; -1.96574197e-14;;
                            -5.00488782e-14; -4.71474082e-14;;
                             2.06908008e-14;  8.68344641e-15;;
                             1.40966336e-14;  2.75871201e-14;;
                            -3.57269884e-15; -6.35581641e-15;;;

                        -3.26656222e+01;  1.37816904e-14;;
                            -1.57824001e-14; -1.92527602e-14;;
                             1.07754349e-15;  7.17861036e-15;;
                             2.10137810e-14; -6.69939041e-16;;
                            -4.24524051e-15; -2.25717150e-16;;
                            -3.59823275e-16;  3.49127175e-17;;;

                         4.62211928e+01;  4.21235493e-15;;
                            -7.00784374e-16;  8.21968518e-15;;
                             4.49894444e-15;  1.37359712e-14;;
                             1.55416701e-15; -5.19175671e-15;;
                            -2.74045293e-15; -6.88588808e-15;;
                             4.70817493e-16;  1.72633081e-15],

                        [4.68071678; -4.78500000; -1.36125000;;
                             6.25613546; -2.64267077e-17; -1.19440696e-16;;        
                             1.56403386;  7.59312342e-18;  4.78427451e-17;;;       

                        -1.20118630; -1.72239045e-16; -1.51455377e-16;;        
                             5.52210332e-16; -3.13691772e-16; -1.22891472e-16;;        
                            -8.91891458e-17;  9.01323150e-17;  3.09872741e-17;;;       

                         3.39930849;  0.00000000;  3.51928144e-17;;        
                             1.00761893e-16;  0.00000000;  1.00761893e-16;;        
                            -4.17799856e-17;  0.00000000; -4.17799856e-17]]
        level_1 = 1
        expected_allDims_1 = [0; 2; 1;;
                                        1; 0; 2;;
                                        2; 1; 0]
        @test isapprox(expected_allDims_1, getSubdivisionDims(Ms_1,trackedInterval_1,level_1))

        trackedInterval_2 = TrackedInterval([ 0.1110769;   0.11932933;;
                                                        -1.;         -0.99371914;;
                                                        -0.87726429; -0.85851422])
        Ms_2 = [[-4.97165769e-05;  5.56342937e-04;  1.19642019e-04;;       
                            -4.80456420e-04;  1.74630072e-20; -8.77767068e-23;;;       

                         4.31081351e-04;  8.50677180e-20; -7.65165445e-22;;        
                             4.13282291e-04;  5.67814700e-23; -9.39634614e-25;;;       

                        -6.46024106e-06; -1.27250950e-22; -1.57047985e-25;;        
                            -1.14389590e-22;  4.33016340e-25; -7.98122860e-28;;;       

                         9.26169059e-07; -3.47197103e-24;  1.09509057e-26;;        
                             1.05055527e-24;  4.54034949e-27; -1.72223167e-29],
                            
                [-2.71749444e-06;  1.54688085e-02;;
                             7.34199307e-10; -2.15348756e-18;;
                             4.19538527e-10; -1.36905583e-19;;
                             1.57326955e-10;  4.16353877e-22;;
                             3.49615456e-11; -4.32036135e-25;;
                             3.49615456e-12;  1.46292238e-28;;;

                         1.54688354e-02; -1.42784526e-17;;
                            -3.09612230e-17;  1.87639173e-20;;
                             3.27003415e-20;  5.79265649e-22;;
                             1.87780208e-22; -1.77989846e-24;;
                            -3.77182628e-25;  1.86468052e-27;;
                             1.78843638e-28; -6.45664292e-31;;;

                         2.08863674e-06; -2.02373910e-20;;
                             7.89842350e-20; -9.61118664e-22;;
                            -6.63831902e-22;  1.20054036e-23;;
                             1.75485288e-24; -3.57815789e-26;;
                            -1.83063430e-27;  3.87876291e-29;;
                             6.48720224e-31; -1.38403444e-32;;;

                        -5.33127238e-07;  8.75223696e-23;;
                             2.81139376e-22; -1.25450538e-25;;
                            -7.88904432e-25; -5.43901299e-27;;
                             1.15596284e-28;  1.83886021e-29;;
                             1.15419495e-30; -2.04443871e-32;;
                            -7.15741834e-34;  7.34426478e-36;;;

                         5.73236294e-08;  7.66929515e-26;;
                             2.32276984e-27;  3.29616462e-27;;
                             2.21964840e-27; -5.18052559e-29;;
                            -8.73949675e-30;  1.62174287e-31;;
                             1.07177769e-32; -1.79646466e-34;;
                            -4.11881198e-36;  6.48798307e-38],
                [ 1.19168975e-04; -5.56342937e-04; -1.19642019e-04;;
                             1.58531014e-04;  9.19590565e-20; -2.62536469e-22;;        
                             3.96327536e-05; -7.19887572e-23;  2.03988284e-25;;;       

                        -5.56677977e-04;  1.91367880e-20; -1.73942480e-23;;        
                             4.47221870e-20; -3.35095740e-23; -4.18052662e-25;;        
                            -2.58982619e-23;  4.20228466e-26;  2.29665581e-28;;;       

                         1.19711768e-04;  1.21496768e-22; -3.28105373e-25;;        
                             7.13200296e-23; -1.54072377e-24;  4.16076705e-27;;        
                            -5.61702813e-26;  1.21344436e-27; -3.27693997e-30]]
        level_2 = 7
        expected_allDims_2 = [0; 2; 1;;
                                        1; 0; 2;;
                                        2; 1; 0]
        @test isapprox(expected_allDims_2, getSubdivisionDims(Ms_2,trackedInterval_2,level_2))

        trackedInterval_3 = TrackedInterval([ 0.08600977;  0.1526489 ;;
                                                        -1.;         -1+1e-5;;
                                                        -0.95417107; -0.80126711])
        Ms_3 = [[ 7.35038766e-03;  4.44916068e-04;  7.95637666e-03;;
                            -5.50186312e-04;  1.19708171e-18; -4.83542451e-20;;;

                         2.87993052e-02;  5.76240555e-18; -4.13686254e-19;;
                             2.73339051e-02;  3.42010626e-20; -4.16235200e-21;;;

                        -5.88967146e-05; -7.67655018e-20; -4.24202506e-22;;
                            -5.80164717e-20;  2.02102879e-21; -3.20168454e-23;;;

                         4.87676378e-04; -1.49632791e-20;  3.79126356e-22;;
                             4.50516959e-21;  1.62221708e-22; -4.93937912e-24],
                [-1.68459073e-06;  1.26145762e-01;;
                             2.70612965e-05; -3.85321532e-16;;
                             1.54635980e-05; -6.47641707e-17;;
                             5.79884923e-06;  1.73832165e-18;;
                             1.28863316e-06; -1.53108143e-20;;
                             1.28863316e-07;  4.35035965e-23;;;

                         1.24830555e-01; -9.30887954e-16;;
                            -1.95839123e-15;  1.69259248e-17;;
                             2.01239919e-17;  2.41329377e-18;;
                             7.76587403e-19; -6.52985838e-20;;
                            -1.35646803e-20;  5.82334349e-22;;
                             5.41754243e-23; -1.69761760e-24;;;

                         9.77319850e-04; -1.31472753e-17;;
                             3.39298863e-17; -2.81038274e-18;;
                            -2.65085503e-18;  3.73793918e-19;;
                             6.03680985e-20; -9.76938402e-21;;
                            -5.32276430e-22;  9.00334315e-23;;
                             1.58077877e-24; -2.70045420e-25;;;

                        -3.92482564e-05;  3.71489858e-19;;
                             1.11831865e-18; -8.85658375e-21;;
                            -2.69184037e-20; -1.45083768e-21;;
                             2.77359921e-23;  4.35197323e-23;;
                             2.86353295e-24; -4.11904944e-25;;
                            -1.46906132e-26;  1.24451738e-27;;;

                         2.43737461e-04;  3.20039943e-21;;
                             1.99298700e-21;  5.49466463e-22;;
                             5.43601526e-22; -1.04848894e-22;;
                            -1.93723652e-23;  2.89574122e-24;;
                             2.02924150e-25; -2.73040469e-26;;
                            -6.56165771e-28;  8.29187586e-29],
                [ 7.82899240e-03; -4.44916068e-04; -7.95637666e-03;;
                             1.06348094e-02;  6.06694601e-18; -1.39879477e-19;;
                             2.65870235e-03; -3.97829518e-20;  9.10079548e-22;;;

                        -6.28491250e-04;  1.27987287e-18; -1.15758419e-20;;
                             2.92792557e-18; -1.97762413e-20; -1.73813116e-21;;
                            -1.41696049e-20;  2.03066147e-22;  7.80132009e-24;;;

                         7.80604670e-03;  5.94908870e-20; -1.29545887e-21;;
                             3.82176670e-20; -6.63258736e-21;  1.44429585e-22;;
                            -2.52242272e-22;  4.37760605e-23; -9.53256688e-25;]]
        level_3 = 4
        expected_allDims_3 = [0; 2;;
                                        0; 2;;
                                        2; 0]
        @test isapprox(expected_allDims_3, getSubdivisionDims(Ms_3,trackedInterval_3,level_3))

        trackedInterval_3a = TrackedInterval([ 0.08600977;  0.1526489 ;;
                                                        -1.;         -.9;;
                                                        -0.95417107; -0.80126711])
        Ms_3a = [[ 7.35038766e-03;  4.44916068e-04;  7.95637666e-03;;
                            -5.50186312e-04;  1.19708171e-18; -4.83542451e-20;;;

                         2.87993052e-02;  5.76240555e-18; -4.13686254e-19;;
                             2.73339051e-02;  3.42010626e-20; -4.16235200e-21;;;

                        -5.88967146e-05; -7.67655018e-20; -4.24202506e-22;;
                            -5.80164717e-20;  2.02102879e-21; -3.20168454e-23;;;

                         4.87676378e-04; -1.49632791e-20;  3.79126356e-22;;
                             4.50516959e-21;  1.62221708e-22; -4.93937912e-24],
                [-1.68459073e-06;  1.26145762e-01;;
                             2.70612965e-05; -3.85321532e-16;;
                             1.54635980e-05; -6.47641707e-17;;
                             5.79884923e-06;  1.73832165e-18;;
                             1.28863316e-06; -1.53108143e-20;;
                             1.28863316e-07;  4.35035965e-23;;;

                         1.24830555e-01; -9.30887954e-16;;
                            -1.95839123e-15;  1.69259248e-17;;
                             2.01239919e-17;  2.41329377e-18;;
                             7.76587403e-19; -6.52985838e-20;;
                            -1.35646803e-20;  5.82334349e-22;;
                             5.41754243e-23; -1.69761760e-24;;;

                         9.77319850e-04; -1.31472753e-17;;
                             3.39298863e-17; -2.81038274e-18;;
                            -2.65085503e-18;  3.73793918e-19;;
                             6.03680985e-20; -9.76938402e-21;;
                            -5.32276430e-22;  9.00334315e-23;;
                             1.58077877e-24; -2.70045420e-25;;;

                        -3.92482564e-05;  3.71489858e-19;;
                             1.11831865e-18; -8.85658375e-21;;
                            -2.69184037e-20; -1.45083768e-21;;
                             2.77359921e-23;  4.35197323e-23;;
                             2.86353295e-24; -4.11904944e-25;;
                            -1.46906132e-26;  1.24451738e-27;;;

                         2.43737461e-04;  3.20039943e-21;;
                             1.99298700e-21;  5.49466463e-22;;
                             5.43601526e-22; -1.04848894e-22;;
                            -1.93723652e-23;  2.89574122e-24;;
                             2.02924150e-25; -2.73040469e-26;;
                            -6.56165771e-28;  8.29187586e-29],
                [ 7.82899240e-03; -4.44916068e-04; -7.95637666e-03;;
                             1.06348094e-02;  6.06694601e-18; -1.39879477e-19;;
                             2.65870235e-03; -3.97829518e-20;  9.10079548e-22;;;

                        -6.28491250e-04;  1.27987287e-18; -1.15758419e-20;;
                             2.92792557e-18; -1.97762413e-20; -1.73813116e-21;;
                            -1.41696049e-20;  2.03066147e-22;  7.80132009e-24;;;

                         7.80604670e-03;  5.94908870e-20; -1.29545887e-21;;
                             3.82176670e-20; -6.63258736e-21;  1.44429585e-22;;
                            -2.52242272e-22;  4.37760605e-23; -9.53256688e-25]]
        level_3a = 4
        expected_allDims_3a = [0; 2; 1;;
                                        1; 0; 2;;
                                        2; 1; 0]
        @test isapprox(expected_allDims_3a, getSubdivisionDims(Ms_3a,trackedInterval_3a,level_3a))

        trackedInterval_3b = TrackedInterval([ 0.08600977;  0.1526489 ;;
                                                            -1.;        -1+1e-5;;
                                                            -0.95417107; -0.80126711])
        Ms_3b = [[ 7.35038766e-03;  4.44916068e-04;  7.95637666e-03;;
                    -5.50186312e-04;  1.19708171e-18; -4.83542451e-20;;;

                    2.87993052e-02;  5.76240555e-18; -4.13686254e-19;;
                    2.73339051e-02;  3.42010626e-20; -4.16235200e-21;;;

                    -5.88967146e-05; -7.67655018e-20; -4.24202506e-22;;
                    -5.80164717e-20;  2.02102879e-21; -3.20168454e-23;;;

                    4.87676378e-04; -1.49632791e-20;  3.79126356e-22;;
                    4.50516959e-21;  1.62221708e-22; -4.93937912e-24],
                    [-1.68459073e-06;  1.26145762e-01;;
                    2.70612965e-05; -3.85321532e-16;;
                    1.54635980e-05; -6.47641707e-17;;
                    5.79884923e-06;  1.73832165e-18;;
                    1.28863316e-06; -1.53108143e-20;;
                    1.28863316e-07;  4.35035965e-23;;;

                    1.24830555e-01; -9.30887954e-16;;
                    -1.95839123e-15;  1.69259248e-17;;
                    2.01239919e-17;  2.41329377e-18;;
                    7.76587403e-19; -6.52985838e-20;;
                    -1.35646803e-20;  5.82334349e-22;;
                    5.41754243e-23; -1.69761760e-24;;;

                    9.77319850e-04; -1.31472753e-17;;
                    3.39298863e-17; -2.81038274e-18;;
                    -2.65085503e-18;  3.73793918e-19;;
                    6.03680985e-20; -9.76938402e-21;;
                    -5.32276430e-22;  9.00334315e-23;;
                    1.58077877e-24; -2.70045420e-25;;;

                    -3.92482564e-05;  3.71489858e-19;;
                    1.11831865e-18; -8.85658375e-21;;
                    -2.69184037e-20; -1.45083768e-21;;
                    2.77359921e-23;  4.35197323e-23;;
                    2.86353295e-24; -4.11904944e-25;;
                    -1.46906132e-26;  1.24451738e-27;;;

                    2.43737461e-04;  3.20039943e-21;;
                    1.99298700e-21;  5.49466463e-22;;
                    5.43601526e-22; -1.04848894e-22;;
                    -1.93723652e-23;  2.89574122e-24;;
                    2.02924150e-25; -2.73040469e-26;;
                    -6.56165771e-28;  8.29187586e-29],
                    [7.82899240e-03; -4.44916068e-04; -7.95637666e-03;;
                    1.06348094e-02;  6.06694601e-18; -1.39879477e-19;;
                    2.65870235e-03; -3.97829518e-20;  9.10079548e-22;;;

                    -6.28491250e-04;  1.27987287e-18; -1.15758419e-20;;
                    2.92792557e-18; -1.97762413e-20; -1.73813116e-21;;
                    -1.41696049e-20;  2.03066147e-22;  7.80132009e-24;;;

                    7.80604670e-03;  5.94908870e-20; -1.29545887e-21;;
                    3.82176670e-20; -6.63258736e-21;  1.44429585e-22;;
                    -2.52242272e-22;  4.37760605e-23; -9.53256688e-25]]
        level_3b = 6
        expected_allDims_3b = [0; 2;;
                                0; 2;;
                                2; 0]
        @test isapprox(expected_allDims_3b, getSubdivisionDims(Ms_3b,trackedInterval_3b,level_3b))

        trackedInterval_4 = TrackedInterval([1.;  1.])
        Ms_4 = [[ 1.98388230e-01; -7.45867440e-02;  4.04311356e-01;  5.88271449e-01;
                            2.26026393e-01;  1.32940050; -4.45466673e-01; -8.61593362e-01;
                            1.63812136e-01;  2.12669974e-01; -2.95468574e-02; -2.95366346e-02;
                            3.27547093e-03;  2.68367335e-03; -2.48957499e-04; -1.73443093e-04;
                            1.38658587e-05;  8.41868996e-06; -5.92171480e-07; -3.18960845e-07;
                            2.00473230e-08;  9.70991815e-09; -5.51888146e-10; -2.42949605e-10;
                            1.26081368e-11;  5.08808273e-12; -2.43249865e-13; -9.04276654e-14;
                            4.28823643e-15;  1.47104551e-15]]
        level_4 = 1
        expected_allDims_4 = [0;;]
        @test isapprox(expected_allDims_4, getSubdivisionDims(Ms_4,trackedInterval_4,level_4))

        trackedInterval_5 = TrackedInterval([-1.;         -0.48027223])
        Ms_5 = [[ 6.69963798e-01;  2.18239042e-01; -1.22498853; -3.73956662e-02;
                            9.35209315e-02;  1.63685598e-03; -2.66713529e-03; -3.29041801e-05;
                            3.98745618e-05;  3.80448135e-07; -3.67357962e-07; -2.85931225e-09;
                            2.29566748e-09;  1.50932004e-11; -1.03726751e-11; -5.90607284e-14;
                            3.54786084e-14;  1.76079511e-16; -9.46841952e-17]]
        level_5 = 3
        expected_allDims_5 = [0;;]
        @test isapprox(expected_allDims_5, getSubdivisionDims(Ms_5,trackedInterval_5,level_5))

        trackedInterval_6 = TrackedInterval([-1.;         1.;;
                                                        -1.;         1.;;
                                                        -1.;         1.;;
                                                        -1.;         1.;;
                                                        -0.2184735;  1.])
        Ms_6 = [[ 4.08360446e+00; -9.44316964e-01;;
                    -1.33295089e+00;  2.83295089e+00;;;
                    -2.40405000e+00; -1.35277734e-16;;
                    -6.76388669e-17;  6.76388669e-17;;;
                    1.45351250; -6.76388669e-17;;
                    1.20586305e-16;  1.01458300e-16;;;;
                    1.50000000e+00;  0.00000000e+00;;
                    -3.38194334e-17;  3.38194334e-17;;;
                    1.69097167e-17; -1.69097167e-17;;
                    1.69097167e-17; -1.69097167e-17;;;
                    1.11022302e-16;  0.00000000;;
                    3.38194334e-17; -3.38194334e-17;;;;
                    3.75000000e-01;  0.00000000;;
                    2.77555756e-17;  0.00000000;;;
                    -2.39100054e-18; -2.53645751e-17;;
                    3.62104340e-17; -8.45485836e-18;;;
                    -2.53645751e-17;  2.53645751e-17;;
                    -2.53645751e-17;  2.53645751e-17;;;;;
                    -1.05000000e-01;  8.45485836e-18;;
                    -2.39100054e-18; -2.53645751e-17;;;
                        1.53296594e-16; -4.22742918e-17;;
                    -2.05825740e-17;  7.60937252e-17;;;

                        6.15750090e-17; -3.38194334e-17;;
                    -4.46652923e-17;  1.69097167e-17;;;;


                        0.00000000;  0.00000000;;
                        0.00000000;  0.00000000;;;

                        9.41125857e-17;  1.69097167e-17;;
                        1.69097167e-17; -1.69097167e-17;;;

                    -9.41125857e-17; -1.69097167e-17;;
                    -1.69097167e-17;  1.69097167e-17;;;;


                        1.93007173e-17;  8.45485836e-18;;
                        1.93007173e-17;  8.45485836e-18;;;

                        8.45485836e-18; -8.45485836e-18;;
                    -3.01465762e-17; -2.53645751e-17;;;

                    -2.77555756e-17;  0.00000000;;
                        1.08458589e-17;  1.69097167e-17;;;;;



                    5.51250000e-01; -6.76388669e-17;;
                    -3.38194334e-17;  3.38194334e-17;;;

                        1.31432164e-16;  1.18368017e-16;;
                        1.12304159e-16; -8.45485836e-17;;;

                    -1.10914381e-18; -1.09913159e-16;;
                    -1.26822875e-16;  1.26822875e-16;;;;


                    -1.50732881e-17; -1.26822875e-17;;
                    -1.50732881e-17; -1.26822875e-17;;;

                        8.32667268e-17;  0.00000000;;
                        4.46652923e-17; -1.69097167e-17;;;

                        8.14302982e-17;  2.95920043e-17;;
                        4.28288637e-17;  1.26822875e-17;;;;


                    -4.22311136e-17; -6.34114377e-18;;
                    -3.25807549e-17; -2.11371459e-18;;;

                        2.89510759e-17;  1.26822875e-17;;
                        9.65035863e-18;  4.22742918e-18;;;

                        7.11821894e-17;  1.90234313e-17;;
                        4.22311136e-17;  6.34114377e-18],
                    [ 8.21242682; -3.35660838;  1.78346906;;
                                    -3.00000000;  0.00000000;  0.00000000;;
                                     2.25000000;  0.00000000;  0.00000000;;;

                                    -2.40405000; -1.77327602e-16;  2.47248501e-16;;
                                     5.36682823e-16;  1.50055034e-16; -2.06040418e-17;;
                                    -3.74802563e-16;  9.09458333e-17;  6.18121253e-17;;;

                                     1.45351250; -2.95546003e-17;  4.12080835e-17;;
                                     2.33069664e-17;  5.91092006e-17; -8.24161670e-17;;
                                    -1.16534832e-17; -2.95546003e-17;  4.12080835e-17;;;;


                                     5.00000000e-01;  0.00000000;  0.00000000;;
                                    -3.67328042e-17;  2.64307834e-17;  1.03020209e-17;;
                                    -1.83664021e-17;  1.32153917e-17;  5.15101044e-18;;;

                                    -3.67328042e-17;  2.64307834e-17;  1.03020209e-17;;
                                    -7.34656085e-17;  5.28615667e-17;  2.06040418e-17;;
                                    -3.67328042e-17;  2.64307834e-17;  1.03020209e-17;;;

                                    -1.83664021e-17;  1.32153917e-17;  5.15101044e-18;;
                                    -3.67328042e-17;  2.64307834e-17;  1.03020209e-17;;
                                    -1.83664021e-17;  1.32153917e-17;  5.15101044e-18;;;;


                                     1.25000000e-01;  0.00000000;  0.00000000;;
                                     0.00000000;  0.00000000;  0.00000000;;
                                     0.00000000;  0.00000000;  0.00000000;;;

                                     0.00000000;  0.00000000;  0.00000000;;
                                     0.00000000;  0.00000000;  0.00000000;;
                                     0.00000000;  0.00000000;  0.00000000;;;

                                     0.00000000;  0.00000000;  0.00000000;;
                                     0.00000000;  0.00000000;  0.00000000;;
                                     0.00000000;  0.00000000;  0.00000000;;;;;



                                -1.05000000e-01; -2.74595877e-17;  2.06040418e-17;;
                                     1.73167091e-16; -5.35677130e-17;  7.46896513e-17;;
                                    -6.19473131e-17; -4.27881084e-19; -3.47693205e-17;;;

                                     1.11354966e-16;  2.88484540e-17;  5.40856096e-17;;
                                     3.77152572e-17;  7.44570088e-17; -5.66611148e-17;;
                                    -7.97835766e-17; -1.23596295e-17;  6.43876305e-17;;;

                                    -1.47066405e-16;  2.28790854e-17;  2.70428048e-17;;
                                    -9.49817690e-17;  1.88274939e-16; -1.21048745e-16;;
                                    -3.80712959e-17; -4.20568568e-17;  9.40059405e-17;;;;


                                     7.20414539e-18;  7.67390413e-18;  1.28775261e-17;;
                                     1.06710302e-17; -7.13331919e-17;  5.15101044e-18;;
                                     4.39369496e-17; -1.87568792e-17;  2.57550522e-18;;;

                                    -6.27945782e-17; -1.84716252e-17;  2.57550522e-17;;
                                     2.88165816e-17;  3.06956165e-17;  5.15101044e-17;;
                                     1.06710302e-17; -7.13331919e-17;  5.15101044e-18;;;

                                    -2.95286588e-17;  3.41046875e-17;  2.31795470e-17;;
                                    -6.27945782e-17; -1.84716252e-17;  2.57550522e-17;;
                                     7.20414539e-18;  7.67390413e-18;  1.28775261e-17;;;;


                                    -2.48818456e-17;  1.98978955e-18;  9.01426827e-18;;
                                    -1.11622567e-17;  2.08892958e-17;  1.80285365e-17;;
                                    -6.51544350e-18; -1.12256021e-17;  3.86325783e-18;;;

                                    -1.11622567e-17;  2.08892958e-17;  1.80285365e-17;;
                                    -2.60617740e-17; -4.49024085e-17;  1.54530313e-17;;
                                     2.55705475e-17; -5.54148755e-18;  7.72651566e-18;;;

                                    -6.51544350e-18; -1.12256021e-17;  3.86325783e-18;;
                                     2.55705475e-17; -5.54148755e-18;  7.72651566e-18;;
                                     1.18509586e-17; -2.44409938e-17; -1.28775261e-18;;;;;



                                 5.51250000e-01;  1.16235600e-16; -2.06040418e-17;;
                                    -2.46649694e-16; -4.12080835e-17;  1.03020209e-17;;
                                     1.13935673e-16;  7.38865007e-18; -1.03020209e-17;;;

                                     3.66141733e-16; -1.02314062e-16; -6.95386409e-17;;
                                     8.38535004e-17;  1.27889084e-16;  1.03020209e-17;;
                                     1.15742016e-17;  1.87568792e-17; -2.57550522e-18;;;

                                     6.59450653e-17; -2.27364583e-17; -1.54530313e-17;;
                                     1.68622935e-16; -7.19037000e-17; -4.12080835e-17;;
                                    -4.42533475e-17;  5.65558918e-17;  1.54530313e-17;;;;


                                    -5.55111512e-17;  0.00000000;  0.00000000;;
                                    -7.20414539e-18; -7.67390413e-18; -1.28775261e-17;;
                                     4.83070058e-17; -7.67390413e-18; -1.28775261e-17;;;

                                     3.32659194e-17;  5.25763127e-17; -2.57550522e-18;;
                                     5.82674161e-18;  1.47773001e-17; -2.06040418e-17;;
                                    -2.74391778e-17; -3.77990125e-17; -1.80285365e-17;;;

                                     4.83070058e-17; -7.67390413e-18; -1.28775261e-17;;
                                     1.30308870e-17;  2.24512043e-17; -7.72651566e-18;;
                                    -3.52761188e-17;  3.01251084e-17;  5.15101044e-18;;;;


                                     8.97722862e-18; -2.64307834e-17; -1.03020209e-17;;
                                    -3.60207270e-18; -3.83695206e-18; -6.43876305e-18;;
                                    -1.25793013e-17;  2.25938313e-17;  3.86325783e-18;;;

                                     1.66329597e-17;  2.62881563e-17; -1.28775261e-18;;
                                     2.91337080e-18;  7.38865007e-18; -1.03020209e-17;;
                                    -1.37195889e-17; -1.88995063e-17; -9.01426827e-18;;;

                                    -1.25793013e-17;  2.25938313e-17;  3.86325783e-18;;
                                     6.51544350e-18;  1.12256021e-17; -3.86325783e-18;;
                                     1.90947448e-17; -1.13682292e-17; -7.72651566e-18],
                    [ 6.83742682; -3.35660838;  1.78346906;;
                    -1.50000000; -1.18218401e-16;  1.64832334e-16;;
                    1.12500000;  1.18218401e-16; -1.64832334e-16;;;
                    -2.40405000; -4.20498680e-17;  2.47248501e-16;;
                    5.87724868e-16; -4.22892534e-16; -1.64832334e-16;;
                    -2.93862434e-16;  2.11446267e-16;  8.24161670e-17;;;
                    1.45351250;  5.91092006e-17; -8.24161670e-17;;
                    4.66139329e-17;  1.18218401e-16; -1.64832334e-16;;
                    -2.33069664e-17; -5.91092006e-17;  8.24161670e-17;;;;
                    5.00000000e-01;  1.35277734e-16;  0.00000000;;
                    8.68914463e-17; -1.38401551e-16;  5.15101044e-17;;
                    -4.34457231e-17;  6.92007753e-17; -2.57550522e-17;;;
                    -2.57129630e-16;  1.85015484e-16;  7.21141461e-17;;
                    2.20396825e-16; -1.58584700e-16; -6.18121253e-17;;
                    -1.10198413e-16;  7.92923501e-17;  3.09060626e-17;;;
                    6.71291890e-18; -4.27699920e-17;  3.60570731e-17;;
                    -1.60357055e-16;  1.91263117e-16; -3.09060626e-17;;
                    8.01785274e-17; -9.56315587e-17;  1.54530313e-17;;;;
                    1.25000000e-01;  8.24161670e-17; -2.06040418e-17;;
                    1.23624251e-16; -1.64832334e-16;  4.12080835e-17;;
                    -6.18121253e-17;  8.24161670e-17; -2.06040418e-17;;;
                    -1.46931217e-16;  1.05723133e-16;  4.12080835e-17;;
                    2.93862434e-16; -2.11446267e-16; -8.24161670e-17;;
                    -1.46931217e-16;  1.05723133e-16;  4.12080835e-17;;;
                    6.18121253e-17; -8.24161670e-17;  2.06040418e-17;;
                    -1.23624251e-16;  1.64832334e-16; -4.12080835e-17;;
                    6.18121253e-17; -8.24161670e-17;  2.06040418e-17;;;;;
                    -1.05000000e-01;  2.70292469e-18;  6.69631357e-17;;
                    1.52687903e-16;  5.30650240e-17; -1.91875139e-16;;
                    -8.55271524e-17; -1.99248162e-17;  9.85130746e-17;;;
                    1.76896583e-16;  4.02845022e-17; -9.01426827e-18;;
                    6.52167226e-17; -2.45836208e-17; -1.28775261e-17;;
                    -5.09747634e-17;  2.55072021e-17;  1.15897735e-17;;;
                    -1.02690251e-16; -2.10658324e-17;  5.79488674e-18;;
                    -4.08572472e-17;  4.05697563e-17;  1.41652787e-17;;
                    1.12454225e-17; -1.36771823e-17; -4.50713413e-18;;;;
                    -1.42419592e-17; -9.23581259e-19;  1.28775261e-18;;
                    -8.24888592e-18;  2.82779459e-17;  7.72651566e-18;;
                    -1.42419592e-17; -9.23581259e-19;  1.28775261e-18;;;
                    -2.84839183e-17; -1.84716252e-18;  2.57550522e-18;;
                    -1.64977718e-17;  5.65558918e-17;  1.54530313e-17;;
                    -2.84839183e-17; -1.84716252e-18;  2.57550522e-18;;;
                    -1.42419592e-17; -9.23581259e-19;  1.28775261e-18;;
                    -8.24888592e-18;  2.82779459e-17;  7.72651566e-18;;
                    -1.42419592e-17; -9.23581259e-19;  1.28775261e-18;;;;
                    -7.12097958e-18; -4.61790629e-19;  6.43876305e-19;;
                    -4.12444296e-18;  1.41389729e-17;  3.86325783e-18;;
                    -7.12097958e-18; -4.61790629e-19;  6.43876305e-19;;;
                    -1.42419592e-17; -9.23581259e-19;  1.28775261e-18;;
                    -8.24888592e-18;  2.82779459e-17;  7.72651566e-18;;
                    -1.42419592e-17; -9.23581259e-19;  1.28775261e-18;;;
                    -7.12097958e-18; -4.61790629e-19;  6.43876305e-19;;
                    -4.12444296e-18;  1.41389729e-17;  3.86325783e-18;;
                    -7.12097958e-18; -4.61790629e-19;  6.43876305e-19;;;;;
                    5.51250000e-01;  1.94386934e-16; -8.24161670e-17;;
                    2.91337080e-18;  7.38865007e-18; -1.03020209e-17;;
                    1.87783470e-17;  2.64307834e-17;  1.03020209e-17;;;
                    2.14080244e-16; -2.20911423e-17;  1.13322230e-16;;
                    4.82900118e-17; -1.55311267e-16;  5.15101044e-17;;
                    -3.90997348e-18;  1.07780742e-16; -2.06040418e-17;;;
                    1.53659813e-17; -2.42305477e-17; -6.05243726e-17;;
                    2.86424816e-17;  2.34426046e-17; -7.98406618e-17;;
                    -4.20372458e-18;  3.34125189e-18;  4.24958361e-17;;;;
                    1.60789184e-16; -1.08422564e-16; -3.15499389e-17;;
                    -9.10640271e-17;  7.33229814e-17;  3.86325783e-18;;
                    3.03557392e-17; -5.92553220e-17; -5.79488674e-18;;;
                    7.02754807e-17; -1.70523437e-17; -1.15897735e-17;;
                    4.68503204e-17; -1.13682292e-17; -7.72651566e-18;;
                    -2.34251602e-17;  5.68411458e-18;  3.86325783e-18;;;
                    -1.70480952e-17;  3.85086532e-17; -6.43876305e-19;;
                    -9.01686943e-18;  2.10319228e-17;  2.96183100e-17;;
                    1.96847090e-17;  1.20778699e-17; -1.09458972e-17;;;;
                    7.78652131e-17; -5.79769204e-17; -1.64188458e-17;;
                    -4.55320135e-17;  3.66614907e-17;  1.93162891e-18;;
                    1.77072487e-17; -2.58620225e-17; -2.25356707e-18;;;
                    3.51377403e-17; -8.52617187e-18; -5.79488674e-18;;
                    2.34251602e-17; -5.68411458e-18; -3.86325783e-18;;
                    -1.17125801e-17;  2.84205729e-18;  1.93162891e-18;;;
                    -5.99466856e-18;  2.30199652e-17;  3.21938152e-19;;
                    -4.50843471e-18;  1.05159614e-17;  1.48091550e-17;;
                    7.31297546e-18;  2.27329639e-18; -6.11682489e-18],
                    
                    [-4.90571520e-02;  2.59687165;;
                    1.33295089; -2.83295089;;
                    -9.99713170e-01;  2.12471317;;;

                    -2.88486000e-01;  6.76388669e-17;;
                    2.42554313e-17; -1.35277734e-16;;
                    -1.21277156e-17;  6.76388669e-17;;;

                    1.74421500e-01;  6.76388669e-17;;
                    1.44841736e-16; -3.38194334e-17;;
                    -1.49069165e-16;  3.80468626e-17;;;;


                    5.00000000e-01;  0.00000000;;
                    -1.93007173e-17; -8.45485836e-18;;
                    1.93007173e-17;  8.45485836e-18;;;

                    -9.65035863e-18; -4.22742918e-18;;
                    0.00000000;  0.00000000;;
                    9.65035863e-18;  4.22742918e-18;;;

                    2.89510759e-17;  1.26822875e-17;;
                    1.93007173e-17;  8.45485836e-18;;
                    -9.65035863e-18; -4.22742918e-18;;;;


                    1.25000000e-01; -1.26822875e-17;;
                    -1.93007173e-17; -8.45485836e-18;;
                    9.65035863e-18;  4.22742918e-18;;;

                    -2.11371459e-18;  2.11371459e-18;;
                    0.00000000;  0.00000000;;
                    2.11371459e-18; -2.11371459e-18;;;

                    2.89510759e-17;  1.26822875e-17;;
                    1.93007173e-17;  8.45485836e-18;;
                    -9.65035863e-18; -4.22742918e-18;;;;;



                -1.05000000e-01; -4.22742918e-17;;
                    -6.76388669e-17;  6.76388669e-17;;
                    3.67285727e-18; -5.91840085e-17;;;

                    -4.34266138e-17; -1.90234313e-17;;
                    7.72028690e-17;  3.38194334e-17;;
                    -3.37762552e-17; -1.47960021e-17;;;

                    2.04314502e-17;  9.40602992e-17;;
                    5.80748647e-17; -1.69097167e-16;;
                    -1.30344585e-18;  1.08856301e-16;;;;


                    -4.82517931e-18; -2.11371459e-18;;
                    0.00000000;  0.00000000;;
                    4.82517931e-18;  2.11371459e-18;;;

                    9.65035863e-18;  4.22742918e-18;;
                    0.00000000;  0.00000000;;
                    -9.65035863e-18; -4.22742918e-18;;;

                    -4.82517931e-18; -2.11371459e-18;;
                    0.00000000;  0.00000000;;
                    4.82517931e-18;  2.11371459e-18;;;;


                    2.41258966e-18;  1.05685729e-18;;
                    0.00000000;  0.00000000;;
                    -2.41258966e-18; -1.05685729e-18;;;

                    -4.82517931e-18; -2.11371459e-18;;
                    0.00000000;  0.00000000;;
                    4.82517931e-18;  2.11371459e-18;;;

                    2.41258966e-18;  1.05685729e-18;;
                    0.00000000;  0.00000000;;
                    -2.41258966e-18; -1.05685729e-18;;;;;



                5.51250000e-01;  0.00000000;;
                    -4.78200108e-18; -5.07291501e-17;;
                    1.69097167e-17; -1.69097167e-17;;;

                    7.60937252e-17; -7.60937252e-17;;
                    -1.18368017e-16;  1.18368017e-16;;
                    7.60937252e-17; -7.60937252e-17;;;

                    4.88927215e-17; -2.11371459e-17;;
                    -3.74922907e-17;  9.30034419e-17;;
                    4.88927215e-17; -2.11371459e-17;;;;


                    -4.22742918e-18;  4.22742918e-18;;
                    2.04962175e-17;  2.11371459e-17;;
                    2.47236467e-17;  1.69097167e-17;;;

                    -9.65035863e-18; -4.22742918e-18;;
                    0.00000000;  0.00000000;;
                    9.65035863e-18;  4.22742918e-18;;;

                    4.22742918e-18; -4.22742918e-18;;
                    -1.19550027e-18; -1.26822875e-17;;
                    -5.42292945e-18; -8.45485836e-18;;;;


                    6.93889390e-18;  0.00000000;;
                    2.35281464e-17;  4.22742918e-18;;
                    1.65892525e-17;  4.22742918e-18;;;

                    -9.65035863e-18; -4.22742918e-18;;
                    0.00000000;  0.00000000;;
                    9.65035863e-18;  4.22742918e-18;;;

                    -6.93889390e-18;  0.00000000;;
                    -4.22742918e-18;  4.22742918e-18;;
                    2.71146472e-18;  4.22742918e-18],
                    
                    [ 2.53662057; -3.35660838;  1.78346906;;
                    2.92580625; -2.70555467e-16;  0.00000000;;;

                    1.20202500; -3.67748935e-16;  4.12080835e-17;;
                    -3.60607500; -5.91092006e-17;  8.24161670e-17;;;

                    -7.26756250e-01;  3.00110068e-16; -4.12080835e-17;;
                    2.18026875; -2.87614800e-16; -1.64832334e-16;;;;


                    5.00000000e-01;  3.90756669e-17; -3.09060626e-17;;
                    2.81512551e-17; -2.70012915e-17; -5.66611148e-17;;;

                    7.34656085e-17; -5.28615667e-17; -2.06040418e-17;;
                    -7.34656085e-17;  5.28615667e-17;  2.06040418e-17;;;

                    -2.81512551e-17;  2.70012915e-17;  5.66611148e-17;;
                    4.53143534e-17; -2.58602752e-17;  3.60570731e-17;;;;


                    1.25000000e-01; -3.69432504e-18;  5.15101044e-18;;
                    1.64977718e-17; -5.65558918e-17; -1.54530313e-17;;;

                    7.22009189e-17; -5.47443860e-17; -2.09259799e-17;;
                    -7.22009189e-17;  5.47443860e-17;  2.09259799e-17;;;

                    -1.64977718e-17;  5.65558918e-17;  1.54530313e-17;;
                    5.69678366e-17;  3.69432504e-18; -5.15101044e-18;;;;;



                -1.05000000e-01; -1.35006457e-17; -2.83305574e-17;;
                    -3.13972891e-17; -9.23581259e-18;  1.28775261e-17;;;

                    1.53197857e-16; -1.52764947e-17; -1.99601654e-17;;
                    5.44384576e-17; -7.13135139e-20; -5.79488674e-18;;;

                    -5.85092832e-17;  3.76207287e-17;  3.54131968e-18;;
                    -9.12958369e-18;  3.00181381e-17; -3.54131968e-18;;;;


                    5.87292322e-17;  2.13940542e-19;  1.73846602e-17;;
                    -7.03827154e-17; -2.97685408e-17;  2.38234233e-17;;;

                    -8.86418828e-17;  3.02677354e-17;  1.67407839e-17;;
                    1.29111948e-16;  2.99824814e-17; -6.43876305e-18;;;

                    4.00301668e-17; -1.54191218e-17; -3.15499389e-17;;
                    -6.88467484e-17; -1.52764947e-17; -1.99601654e-17;;;;


                    3.94821323e-17;  1.51695245e-17;  1.12678353e-17;;
                    -2.50738415e-17;  1.78283785e-19;  1.44872169e-17;;;

                    -6.45559738e-17; -1.49912407e-17;  3.21938152e-18;;
                    4.43209414e-17; -1.51338677e-17; -8.37039196e-18;;;

                    3.01325996e-17;  7.35299331e-18; -1.31994642e-17;;
                    -2.43058580e-17;  7.42430683e-18; -7.40457750e-18;;;;;



                5.51250000e-01;  0.00000000;  0.00000000;;
                    -2.29960828e-16;  5.71263999e-17;  6.18121253e-17;;;

                    9.62020668e-17; -5.49939833e-17; -4.12080835e-17;;
                    2.78600497e-16; -3.59518500e-17; -2.06040418e-17;;;

                    4.32878885e-17; -9.80632070e-18; -3.34815678e-17;;
                    8.06534884e-17; -1.11835129e-16; -7.98406618e-17;;;;


                    3.15898405e-18;  3.26105981e-17; -2.18917944e-17;;
                    1.86120154e-17;  1.20065564e-17; -1.67407839e-17;;;

                    6.23033517e-17; -3.19722709e-17; -2.57550522e-18;;
                    -4.20683194e-17;  6.20973793e-17;  7.72651566e-18;;;

                    -8.49449917e-18;  3.05599783e-18;  1.93162891e-17;;
                    6.95853215e-18; -1.75480439e-17;  2.44672996e-17;;;;


                    1.57949203e-18;  1.63052991e-17; -1.09458972e-17;;
                    9.30600768e-18;  6.00327818e-18; -8.37039196e-18;;;

                    3.11516759e-17; -1.59861355e-17; -1.28775261e-18;;
                    -2.10341597e-17;  3.10486897e-17;  3.86325783e-18;;;

                    -4.24724958e-18;  1.52799892e-18;  9.65814457e-18;;
                    3.47926607e-18; -8.77402196e-18;  1.22336498e-17]]
        level_6 = 1
        expected_allDims_6 = [2; 1; 0; 4; 3;;
                                        4; 3; 2; 1; 0;;
                                        4; 3; 2; 1; 0;;
                                        3; 2; 1; 0; 4;;
                                        4; 2; 1; 0; 3]
        @test isapprox(expected_allDims_6, getSubdivisionDims(Ms_6,trackedInterval_6,level_6))

        trackedInterval_7 = TrackedInterval([ 0.03945555;  1.;;
                                                -1.;          0.03945555;;
                                                0.03945555;  1.;;
                                                0.03945555;  0.8650092;;
                                                0.41480102;  1.])
        Ms_7 = [[ 1.07142165e+00;  1.61772562e-01;;
                5.75461946e-02;  5.61619043e-01;;;

                2.96651313e-01; -3.39708980e-17;;
                6.23974136e-17;  3.06138888e-17;;;

                3.35269245e-01; -2.14750436e-18;;
                1.63404061e-17;  3.92462018e-18;;;;


            4.05175438e-01;  1.49089271e-17;;
                -2.42704359e-17;  6.11752001e-18;;;

                8.91612496e-17; -1.64457404e-17;;
                4.37735368e-18; -8.26735644e-18;;;

                1.59746311e-17; -5.58287457e-18;;
                1.21413250e-18; -2.15690973e-18;;;;


            1.01293860e-01; -2.91078151e-18;;
                6.02650904e-18; -7.69091844e-19;;;

            -1.61151471e-17;  1.96422369e-18;;
                -1.02880386e-18;  1.16696315e-18;;;

            -3.16461064e-18;  1.07109611e-18;;
                -3.19107512e-19;  4.03906181e-19;;;;;



            4.99963263e-01;  7.24023441e-18;;
                2.08333217e-17; -3.58422625e-18;;;

            -2.88911748e-17; -2.39516560e-17;;
                -3.52016062e-17;  2.07163246e-17;;;

            -2.99141286e-17; -9.60551746e-18;;
                -1.09122488e-17;  5.52770123e-18;;;;


            6.41527705e-17; -4.54209112e-18;;
                1.38295961e-17; -2.04590576e-18;;;

            -3.54019101e-17; -6.07501389e-18;;
                -6.98105270e-18; -1.19866640e-18;;;

            -1.31610394e-17; -1.04908960e-18;;
                -2.96892590e-18; -1.65904797e-19;;;;


            -1.29567793e-17; -6.01707661e-19;;
                -4.40294636e-18; -2.94442193e-19;;;

                2.92589264e-17;  3.61843830e-18;;
                5.62920573e-18;  5.67975389e-19;;;

                5.75914328e-18;  7.63941973e-19;;
                1.41156695e-18;  1.78514600e-19;;;;;



            1.27152103e-01;  1.91152932e-18;;
                4.79121097e-18; -1.23937605e-18;;;

            -2.09329083e-17; -4.09015035e-18;;
                -7.01631281e-18;  3.73102191e-18;;;

            -9.06126759e-18; -1.92681844e-18;;
                -2.12745553e-18;  1.25546687e-18;;;;


            1.36153101e-17; -1.23234013e-18;;
                2.89822838e-18; -5.16802841e-19;;;

            -7.90847046e-18; -1.37345331e-18;;
                -1.56775419e-18; -2.73832184e-19;;;

            -2.10526282e-18; -8.93431017e-20;;
                -4.34200889e-19;  2.74305342e-21;;;;


            -3.91222649e-18; -1.41462319e-19;;
                -9.76066997e-19; -1.69143790e-20;;;

                7.54787397e-18;  8.63779933e-19;;
                1.31538564e-18;  1.03280515e-19;;;

                1.46097501e-18;  1.51097345e-19;;
                2.70074762e-19;  1.80664207e-20],
                
                [1.71925557e+00;  1.68606883e-01;  4.11377490e-01;;
                4.41708911e-01;  3.45276625e-17;  2.71584393e-18;;
                3.83365591e-01;  5.51328328e-18;  2.19183835e-19;;;

                2.96651313e-01;  5.68098934e-17;  1.04881815e-17;;
                -2.59134440e-17;  5.02067534e-17;  3.18884982e-18;;
                -4.40610755e-17;  1.85375284e-17;  4.80625344e-18;;;

                3.35269245e-01; -3.38256162e-18; -2.81267507e-18;;
                -3.88863843e-18;  1.97375581e-18; -5.95518601e-20;;
                -2.82334822e-18;  1.92548058e-18;  7.35266273e-19;;;;


            1.35058479e-01; -9.34504427e-18; -9.29019885e-19;;
                -1.10973940e-17;  1.03984213e-17;  1.13091038e-18;;
                -2.27373541e-18;  1.44719312e-18;  1.66375006e-19;;;

            -3.86160966e-17;  3.43535302e-17;  3.62552216e-18;;
                -2.65620582e-17;  2.40509961e-17;  2.55367163e-18;;
                -2.24963724e-18;  2.14897426e-18;  2.27589614e-19;;;

            -7.29423233e-18;  5.54979427e-18;  5.98695706e-19;;
                -3.99966511e-18;  3.36022405e-18;  3.59624925e-19;;
                7.16837006e-20;  4.65715043e-19;  4.02772780e-20;;;;


            3.37646199e-02;  6.57761381e-18;  1.05638586e-18;;
                -1.54799727e-18;  1.72457255e-18;  5.76470040e-19;;
                1.18536415e-19;  9.64716050e-21;  4.27921252e-20;;;

            -4.17762847e-18;  6.66283925e-19;  5.32216329e-19;;
                6.92434840e-20;  6.53808761e-20;  4.41203718e-19;;
                1.78340075e-19; -2.27569503e-20;  4.26724892e-20;;;

            -8.56908140e-20; -9.72518670e-20;  4.13326424e-20;;
                2.87748879e-20; -1.15988381e-19;  4.08861804e-20;;
                -3.94480233e-20; -3.98168367e-20;  2.69575387e-21;;;;;



            4.99963263e-01;  2.29272093e-17; -2.86799058e-19;;
                2.14831673e-18;  3.13193909e-17;  3.24546778e-18;;
                1.35741026e-17; -2.13537735e-19; -6.57646260e-19;;;

                2.78293091e-16; -1.38063712e-16; -2.50498941e-17;;
                6.04556822e-17;  4.57639616e-17;  2.46885166e-18;;
                -8.79903230e-18;  1.70212431e-17;  2.95411077e-18;;;

                1.50741235e-17; -1.98538344e-17; -3.89293146e-18;;
                5.49952480e-18;  2.84087843e-18;  5.07447260e-20;;
                -2.09725092e-18;  2.74694437e-18;  5.20118981e-19;;;;


            -3.36484194e-17;  3.10696010e-17;  3.20162611e-18;;
                3.56944474e-17; -3.25664835e-17; -3.36584778e-18;;
                6.31873340e-18; -6.34800243e-18; -6.46404749e-19;;;

                2.81977474e-17; -2.38792491e-17; -2.49869943e-18;;
                -2.90390317e-17;  2.59350981e-17;  2.68616991e-18;;
                -5.43349495e-18;  4.87683452e-18;  5.04862589e-19;;;

                5.77179529e-18; -5.99247884e-18; -6.07358261e-19;;
                -6.79088336e-18;  5.97713108e-18;  6.20757732e-19;;
                -9.18819151e-19;  1.32384739e-18;  1.28793051e-19;;;;


            1.40974138e-21; -3.54630380e-18; -3.19792116e-19;;
                -5.73760846e-18;  1.99122869e-18;  2.46616928e-19;;
                -7.98893529e-19;  4.72947818e-19;  5.17284702e-20;;;

                2.34561328e-18;  9.94655571e-18;  8.17713030e-19;;
                3.56484031e-18; -5.49916153e-18; -5.44390129e-19;;
                4.22030873e-19; -1.23719330e-18; -1.15292452e-19;;;

            -2.32025897e-19;  1.48923258e-18;  1.31516094e-19;;
                1.28054485e-18; -8.01145834e-19; -9.02892285e-20;;
                1.55691965e-19; -2.06043501e-19; -2.04047658e-20;;;;;



            1.27152103e-01;  7.47509277e-19; -1.68244688e-18;;
                4.63304008e-19;  6.35723598e-18;  6.79396127e-19;;
                4.94612170e-18;  1.46994270e-19; -3.79295338e-20;;;

                5.91928627e-17; -2.87891070e-17; -3.32217995e-18;;
                1.99411391e-17;  4.96747918e-18;  2.02129771e-19;;
                4.24216090e-19;  1.98140464e-18;  1.73282230e-19;;;

                5.15689754e-18; -3.87702672e-18; -4.06527421e-19;;
                2.23891020e-18; -2.45004990e-19; -4.67452746e-20;;
                -1.12657737e-19;  3.32790994e-19;  3.14783904e-20;;;;


            -1.04290640e-17;  9.34172522e-18;  9.57292638e-19;;
                5.45480277e-18; -5.04506206e-18; -5.31161827e-19;;
                1.24687631e-18; -1.14042138e-18; -1.18963104e-19;;;

                8.80257271e-18; -7.54482795e-18; -7.98676635e-19;;
                -4.43106195e-18;  3.94672772e-18;  3.97201471e-19;;
                -1.02679171e-18;  9.02116107e-19;  9.24464753e-20;;;

                1.98766428e-18; -1.75969853e-18; -1.83989290e-19;;
                -1.01078505e-18;  9.28863753e-19;  9.44209950e-20;;
                -2.33369611e-19;  2.11640682e-19;  2.17289287e-20;;;;


            1.22499456e-18; -1.83448985e-18; -2.47020324e-19;;
                -8.20959421e-19;  7.57803612e-20; -5.45301161e-20;;
                -1.73151346e-19;  8.84469260e-20;  2.32250876e-21;;;

                1.18291130e-18;  1.77850549e-18;  6.21181689e-20;;
                6.67279506e-19; -1.05968248e-18; -1.81474744e-19;;
                4.90292034e-20; -2.31806698e-19; -2.94914098e-20;;;

            -2.91321091e-20;  3.00984336e-19;  1.77874793e-20;;
                2.39009743e-19; -1.32272646e-19; -2.44110439e-20;;
                3.66238103e-20; -3.22597475e-20; -4.36406276e-21],
                [1.49576457e+00;  1.68606883e-01;  4.11377490e-01;;
                2.20854456e-01; -5.06979570e-17; -1.48297754e-17;;
                1.91682796e-01; -4.28098704e-18; -3.03250631e-18;;;

                2.96651313e-01; -1.52117951e-16; -2.87974276e-17;;
                9.85544813e-18; -1.26068312e-17; -1.82987398e-18;;
                -2.64947010e-17;  2.04151968e-17;  3.43762545e-18;;;

                3.35269245e-01; -2.66571677e-17; -8.65114674e-18;;
                1.41002534e-18; -1.22337404e-18; -2.49667270e-19;;
                -2.97331670e-18;  2.22719784e-18;  5.02129829e-19;;;;


            1.35058479e-01;  6.33671440e-17;  5.31519365e-18;;
                -2.74298794e-18;  4.29406209e-18;  1.07929091e-19;;
                7.93333491e-18; -7.50055855e-18; -1.08630334e-19;;;

            -6.00791689e-17;  5.54051086e-17;  6.73924499e-18;;
                -3.34756515e-18;  1.59372967e-18;  4.37359936e-19;;
                4.77460128e-18; -4.13673986e-18; -9.68554646e-19;;;

            -5.74073182e-18;  5.44263054e-18;  7.95821283e-19;;
                -2.10323124e-19; -1.43941116e-19;  4.81126567e-20;;
                -5.98371220e-20;  1.02228055e-19; -1.14428425e-19;;;;


            3.37646199e-02; -2.37467886e-18;  5.05147144e-19;;
                8.46931293e-19; -6.83729888e-20;  1.59692136e-19;;
                -3.52574395e-18;  3.41684249e-18; -3.54198703e-20;;;

                7.09803562e-19; -1.78247073e-18; -7.62390099e-19;;
                -9.61353501e-19;  4.92268856e-19; -8.76704803e-20;;
                -1.98866700e-18;  1.21408536e-18;  4.48047751e-19;;;

            -4.04403498e-19;  2.28264502e-19; -1.11996935e-19;;
                -3.11471188e-19;  1.82498799e-19; -1.29409342e-20;;
                8.58626558e-20; -1.87289179e-19;  5.47037359e-20;;;;;



            4.99963263e-01;  8.32050447e-17; -6.85647337e-19;;
                5.53515005e-17;  2.27049024e-17;  1.05680764e-18;;
                1.99603570e-18;  1.63225390e-17;  1.59012394e-18;;;

                8.83607766e-17; -9.99996893e-17; -1.16883354e-17;;
                1.63971286e-17;  3.14925071e-18; -2.55450992e-19;;
                1.18374815e-18;  1.02932357e-17;  1.49308097e-18;;;

            -1.32580578e-18; -3.25472901e-17; -6.36865089e-18;;
                1.00480865e-18; -6.17269549e-19; -1.92308735e-19;;
                -8.47901575e-19;  1.65871216e-18;  4.24018265e-19;;;;


            1.02499832e-17;  2.91175683e-18;  8.69254265e-20;;
                -4.64903769e-18; -2.33254419e-18; -1.36843898e-19;;
                -1.00984279e-18; -6.12639718e-19; -3.11328996e-20;;;

            -5.58011466e-18; -2.77533450e-18; -1.47196267e-19;;
                3.45566799e-18;  2.25499877e-18;  1.47268742e-19;;
                7.49863393e-19;  4.11677340e-19;  1.88624856e-20;;;

            -1.48455723e-18; -5.98554534e-19; -2.73877700e-20;;
                8.14791283e-19;  5.01547273e-19;  3.20893871e-20;;
                1.87092116e-19;  9.22429115e-20;  3.90211539e-21;;;;


            1.57231038e-17; -1.00800814e-17; -1.20004923e-18;;
                -3.40022589e-18;  1.55870165e-20;  3.04003309e-20;;
                -4.39902043e-19; -5.25845976e-19;  7.55148791e-21;;;

                5.31534932e-18;  5.48792490e-18;  4.70440868e-19;;
                6.48576503e-19;  2.35966586e-18;  2.13106544e-19;;
                -1.06759231e-19; -1.39192708e-19; -4.84695289e-20;;;

            -5.92137415e-20;  1.54844077e-18;  1.52267313e-19;;
                2.58239351e-19;  4.17326986e-19;  3.65022534e-20;;
                6.66077987e-20; -5.10143140e-20; -1.41976204e-20;;;;;



            1.27152103e-01;  2.64053263e-17;  1.87453686e-18;;
                1.14621989e-17;  6.36289187e-18;  4.76910862e-19;;
                2.80365728e-18;  1.82800781e-18; -8.67438264e-20;;;

                2.07717264e-17; -2.28941320e-17; -2.68751498e-18;;
                3.56117578e-18;  9.58256645e-19; -3.55695508e-20;;
                2.00680115e-19;  2.38975911e-18;  3.47044517e-19;;;

                2.85446168e-18; -7.75745683e-18; -1.53912412e-18;;
                2.30510206e-19; -1.38180388e-19; -4.40186598e-20;;
                -2.58668313e-19;  4.33721110e-19;  1.03286499e-19;;;;


            2.39508763e-18;  6.30999482e-19;  1.60529540e-20;;
                -1.03579320e-18; -5.77663838e-19; -3.55574857e-20;;
                -2.22755939e-19; -1.42123716e-19; -7.40081569e-21;;;

            -1.25977109e-18; -6.86260230e-19; -3.83648534e-20;;
                8.39703446e-19;  4.78969772e-19;  2.97547248e-20;;
                1.84638527e-19;  9.44665604e-20;  4.13205533e-21;;;

            -3.39507811e-19; -1.43588952e-19; -6.84045187e-21;;
                1.93105222e-19;  1.10924750e-19;  6.91085159e-21;;
                4.45650185e-20;  2.12347479e-20;  8.74910315e-22;;;;


            3.81102471e-18; -2.60321014e-18; -3.03770305e-19;;
                -5.33716027e-19; -2.51925780e-19; -1.89508235e-20;;
                -3.22141721e-20; -1.25374252e-19;  3.71580813e-22;;;

                1.42128275e-18;  9.70789600e-19;  7.99695564e-20;;
                4.22316950e-19;  2.68626044e-19;  2.11255965e-20;;
                5.04478629e-20; -3.63688189e-20; -1.26831797e-20;;;

                9.08348984e-21;  3.22747781e-19;  3.17962323e-20;;
                9.17421902e-20;  6.38540109e-20;  5.12338319e-21;;
                2.42318218e-20; -1.22813672e-20; -3.45488302e-21],
                [5.49119633e-01;  2.02719397e-01;;
                2.05265617e-02;  2.00327894e-01;;
                1.78153016e-02;  1.73867494e-01;;;

                3.55981576e-02; -4.79403779e-18;;
                -3.87882958e-17;  6.12918957e-18;;
                -1.81021848e-17;  1.13416102e-17;;;

                4.02323093e-02;  1.11973965e-19;;
                -8.98375531e-18;  1.52152949e-18;;
                -4.01756286e-18;  1.91735809e-18;;;;


            1.35058479e-01;  5.94760094e-18;;
                7.69395246e-18;  7.06389841e-19;;
                2.51265164e-19;  3.19281748e-20;;;

            -3.16361745e-17; -5.40901655e-18;;
                3.85207648e-18;  1.95744513e-18;;
                1.90223606e-18;  5.17594123e-19;;;

            -7.28196516e-18; -1.05789185e-18;;
                8.75899333e-19;  3.51447779e-19;;
                4.36259329e-19;  9.65821278e-20;;;;


            3.37646199e-02; -2.65041304e-18;;
                -1.89010865e-18; -3.06353560e-19;;
                4.62341252e-19;  6.61993892e-20;;;

                1.47680634e-17;  2.64094224e-18;;
                -9.90355019e-20; -2.47678807e-19;;
                -6.36336582e-19; -1.47853220e-19;;;

                3.47046958e-18;  5.69551351e-19;;
                -5.37519332e-20; -3.58990090e-20;;
                -1.54051928e-19; -2.92922262e-20;;;;;



            4.99963263e-01; -4.51000037e-18;;
                -5.86654108e-17; -3.11421864e-17;;
                -6.34906134e-18; -8.76327862e-18;;;

                4.93397042e-17;  1.27312132e-17;;
                5.13713052e-17;  1.34337514e-17;;
                1.21566217e-17; -6.04640724e-19;;;

                1.04424704e-17;  2.18900658e-18;;
                1.15803135e-17;  3.55019066e-18;;
                2.62535282e-18;  6.36963537e-19;;;;


            -8.91062611e-18;  2.88584674e-18;;
                -5.72097891e-18;  3.69523315e-18;;
                -4.72182756e-19;  4.25784901e-19;;;

                1.49494096e-17; -1.02282534e-18;;
                -1.02258364e-17; -5.55059951e-18;;
                -2.14375543e-18; -7.78990578e-19;;;

                1.64723141e-18; -5.45858823e-19;;
                -1.41291123e-18; -1.11959301e-18;;
                -2.78594027e-19; -1.42834149e-19;;;;


            9.85390930e-19; -4.16044371e-19;;
                7.78935935e-18;  7.15131094e-19;;
                1.11212800e-18;  1.23424928e-19;;;

            -4.83095371e-18; -3.52743064e-19;;
                1.89623903e-18;  8.28398167e-19;;
                4.84195607e-19;  1.37535144e-19;;;

            -4.91299177e-19;  2.55736473e-20;;
                1.09690662e-19;  1.35102418e-19;;
                3.69267458e-20;  1.89322089e-20;;;;;



            1.27152103e-01; -2.14404266e-18;;
                -9.60099826e-18; -6.27568893e-18;;
                -3.18297026e-19; -1.19267467e-18;;;

                7.40356148e-18;  4.37533456e-18;;
                8.23054172e-18;  2.41916808e-18;;
                2.14311438e-18; -1.06172510e-18;;;

                1.50386501e-18;  8.39486389e-19;;
                1.97314415e-18;  6.85752285e-19;;
                3.74430051e-19; -7.92905809e-20;;;;


            -2.31404570e-18;  6.22905375e-19;;
                -1.18736968e-18;  8.76691280e-19;;
                -7.84391585e-20;  1.03616949e-19;;;

                3.48968459e-18; -2.30115176e-19;;
                -2.38133525e-18; -1.28555312e-18;;
                -4.99577208e-19; -1.80704330e-19;;;

                5.99992360e-19; -8.84979160e-20;;
                -4.41757350e-19; -2.78416400e-19;;
                -9.06815078e-20; -3.75082611e-20;;;;


            2.61512218e-19; -9.03113175e-20;;
                1.78170536e-18;  1.62159821e-19;;
                2.52863084e-19;  2.78176640e-20;;;

            -1.12083114e-18; -8.23100813e-20;;
                4.40583130e-19;  1.91807899e-19;;
                1.12432587e-19;  3.18717451e-20;;;

            -1.42587480e-19;  9.23368410e-22;;
                4.06294772e-20;  3.38315346e-20;;
                1.20195434e-20;  4.97159986e-21],
                [9.69840558e-01;  1.68606883e-01;  4.11377490e-01;;
                2.27901995e-01; -1.24309595e-17;  8.25603419e-18;;;

                5.29073342e-02; -7.46091880e-17; -1.85281254e-17;;
                1.83676181e-01; -1.04166859e-16; -1.14069672e-17;;;

                5.97947866e-02; -6.64017247e-18; -6.41927440e-18;;
                2.07587061e-01; -2.54512810e-17; -3.40085408e-18;;;;


            1.35058479e-01;  2.31430691e-18; -6.72762893e-18;;
                1.98802250e-17; -3.18309247e-18; -2.29197550e-18;;;

            -5.12474635e-17;  6.01397046e-18;  6.20055503e-18;;
                -1.53997395e-17;  1.58437355e-18;  1.76388565e-18;;;

            -1.33638081e-17; -1.70368117e-18;  1.18667316e-18;;
                -5.46909963e-18;  9.67832915e-19;  4.87959566e-19;;;;


            3.37646199e-02; -6.81868016e-18;  2.73831818e-19;;
                -5.93822658e-18; -1.56759129e-18;  1.24806388e-19;;;

                1.33845025e-17;  4.53207270e-18; -2.90078414e-19;;
                4.24065660e-18;  1.06109094e-18; -1.09252487e-19;;;

                3.30419645e-18;  1.99052380e-18;  1.49874169e-20;;
                1.31709634e-18; -1.84937423e-19; -7.00129850e-20;;;;;



            4.99963263e-01; -1.00662370e-17;  2.29723215e-18;;
                -4.39869872e-17;  3.82903378e-17;  7.46065937e-18;;;

                1.77788932e-16; -1.39729683e-16; -2.46306662e-17;;
                7.94939073e-17; -6.65767506e-17; -9.80600214e-18;;;

                1.16756624e-17; -2.06386167e-17; -4.02738435e-18;;
                6.48364192e-18; -1.24755483e-17; -1.99568033e-18;;;;


            4.59654126e-18;  1.97245530e-18;  4.27583244e-20;;
                1.13417236e-18;  6.43430431e-19;  1.93352139e-20;;;

            -3.43457551e-19; -3.49061114e-20;  5.27146302e-20;;
                -2.50400329e-19;  1.18720804e-19;  2.88122201e-20;;;

            -2.84298440e-18; -1.55926603e-18; -8.35910277e-20;;
                -8.75261679e-19; -4.42063177e-19; -2.04385641e-20;;;;


            8.01750108e-18;  4.16761857e-19; -4.80192786e-19;;
                1.14385235e-18;  6.63717382e-19; -8.91873113e-20;;;

                8.78699897e-19;  1.54456738e-18;  4.54696849e-19;;
                -7.56470482e-19;  1.28629194e-18;  2.20321242e-19;;;

                3.91057974e-19;  5.30136140e-19;  1.03753213e-19;;
                -3.31330633e-19;  1.58168913e-19;  5.13634639e-20;;;;;



            1.27152103e-01;  6.91300878e-18;  2.11366792e-18;;
                -9.64263403e-18;  9.23999004e-18;  1.77144208e-18;;;

                3.59148864e-17; -3.59563826e-17; -5.99397999e-18;;
                1.67605442e-17; -1.64040837e-17; -2.34782127e-18;;;

                3.90764224e-18; -6.15476863e-18; -1.08313730e-18;;
                1.00134007e-18; -3.14625746e-18; -4.80619661e-19;;;;


            2.97186772e-19; -8.53943022e-20; -3.92173999e-20;;
                4.77495278e-20;  9.55773189e-21; -8.25519959e-21;;;

                2.31408072e-20;  1.30026992e-19;  3.35763546e-20;;
                -2.59855819e-20;  6.63921673e-20;  1.26728393e-20;;;

            -1.61954334e-20;  3.05380252e-20;  7.64563700e-21;;
                -3.49797155e-21;  7.20620189e-21;  2.54161744e-21;;;;


            1.95734477e-18; -5.62427761e-19; -2.58295388e-19;;
                3.14490069e-19;  6.29495599e-20; -5.43707636e-20;;;

                1.52411016e-19;  8.56389571e-19;  2.21142084e-19;;
                -1.71147398e-19;  4.37275053e-19;  8.34664190e-20;;;

            -1.06667086e-19;  2.01130903e-19;  5.03560353e-20;;
                -2.30384962e-20;  4.74618082e-20;  1.67397141e-20]]
        
        level_7 = 2
        expected_allDims_7 = [2; 1; 0; 4; 3;;
                                        4; 3; 2; 1; 0;;
                                        4; 3; 2; 1; 0;;
                                        3; 2; 1; 0; 4;;
                                        4; 2; 1; 0; 3]
        @test isapprox(expected_allDims_7, getSubdivisionDims(Ms_7,trackedInterval_7,level_7))

        trackedInterval_8 = TrackedInterval([ 0.03945555;  1.        ;;
                                -1.;          0.03945555;;
                                 0.03945555;  1.        ;;
                                 0.03945555;  0.8650092 ;;
                                 0.41480102;  1.        ])
        Ms_8 = [[ 1.07142165e+00;  1.61772562e-01;;
             5.75461946e-02;  5.61619043e-01;;;

             2.96651313e-01; -3.39708980e-17;;
             6.23974136e-17;  3.06138888e-17;;;

             3.35269245e-01; -2.14750436e-18;;
             1.63404061e-17;  3.92462018e-18;;;;


             4.05175438e-01;  1.49089271e-17;;
            -2.42704359e-17;  6.11752001e-18;;;

             8.91612496e-17; -1.64457404e-17;;
             4.37735368e-18; -8.26735644e-18;;;

             1.59746311e-17; -5.58287457e-18;;
             1.21413250e-18; -2.15690973e-18;;;;


             1.01293860e-01; -2.91078151e-18;;
             6.02650904e-18; -7.69091844e-19;;;

            -1.61151471e-17;  1.96422369e-18;;
            -1.02880386e-18;  1.16696315e-18;;;

            -3.16461064e-18;  1.07109611e-18;;
            -3.19107512e-19;  4.03906181e-19;;;;;



         4.99963263e-01;  7.24023441e-18;;
             2.08333217e-17; -3.58422625e-18;;;

            -2.88911748e-17; -2.39516560e-17;;
            -3.52016062e-17;  2.07163246e-17;;;

            -2.99141286e-17; -9.60551746e-18;;
            -1.09122488e-17;  5.52770123e-18;;;;


             6.41527705e-17; -4.54209112e-18;;
             1.38295961e-17; -2.04590576e-18;;;

            -3.54019101e-17; -6.07501389e-18;;
            -6.98105270e-18; -1.19866640e-18;;;

            -1.31610394e-17; -1.04908960e-18;;
            -2.96892590e-18; -1.65904797e-19;;;;


            -1.29567793e-17; -6.01707661e-19;;
            -4.40294636e-18; -2.94442193e-19;;;

             2.92589264e-17;  3.61843830e-18;;
             5.62920573e-18;  5.67975389e-19;;;

             5.75914328e-18;  7.63941973e-19;;
             1.41156695e-18;  1.78514600e-19;;;;;



         1.27152103e-01;  1.91152932e-18;;
             4.79121097e-18; -1.23937605e-18;;;

            -2.09329083e-17; -4.09015035e-18;;
            -7.01631281e-18;  3.73102191e-18;;;

            -9.06126759e-18; -1.92681844e-18;;
            -2.12745553e-18;  1.25546687e-18;;;;


             1.36153101e-17; -1.23234013e-18;;
             2.89822838e-18; -5.16802841e-19;;;

            -7.90847046e-18; -1.37345331e-18;;
            -1.56775419e-18; -2.73832184e-19;;;

            -2.10526282e-18; -8.93431017e-20;;
            -4.34200889e-19;  2.74305342e-21;;;;


            -3.91222649e-18; -1.41462319e-19;;
            -9.76066997e-19; -1.69143790e-20;;;

             7.54787397e-18;  8.63779933e-19;;
             1.31538564e-18;  1.03280515e-19;;;

             1.46097501e-18;  1.51097345e-19;;
             2.70074762e-19;  1.80664207e-20],
            
            [1.71925557e+00;  1.68606883e-01;  4.11377490e-01;;
             4.41708911e-01;  3.45276625e-17;  2.71584393e-18;;
             3.83365591e-01;  5.51328328e-18;  2.19183835e-19;;;

             2.96651313e-01;  5.68098934e-17;  1.04881815e-17;;
            -2.59134440e-17;  5.02067534e-17;  3.18884982e-18;;
            -4.40610755e-17;  1.85375284e-17;  4.80625344e-18;;;

             3.35269245e-01; -3.38256162e-18; -2.81267507e-18;;
            -3.88863843e-18;  1.97375581e-18; -5.95518601e-20;;
            -2.82334822e-18;  1.92548058e-18;  7.35266273e-19;;;;


             1.35058479e-01; -9.34504427e-18; -9.29019885e-19;;
            -1.10973940e-17;  1.03984213e-17;  1.13091038e-18;;
            -2.27373541e-18;  1.44719312e-18;  1.66375006e-19;;;

            -3.86160966e-17;  3.43535302e-17;  3.62552216e-18;;
            -2.65620582e-17;  2.40509961e-17;  2.55367163e-18;;
            -2.24963724e-18;  2.14897426e-18;  2.27589614e-19;;;

            -7.29423233e-18;  5.54979427e-18;  5.98695706e-19;;
            -3.99966511e-18;  3.36022405e-18;  3.59624925e-19;;
             7.16837006e-20;  4.65715043e-19;  4.02772780e-20;;;;


             3.37646199e-02;  6.57761381e-18;  1.05638586e-18;;
            -1.54799727e-18;  1.72457255e-18;  5.76470040e-19;;
             1.18536415e-19;  9.64716050e-21;  4.27921252e-20;;;

            -4.17762847e-18;  6.66283925e-19;  5.32216329e-19;;
             6.92434840e-20;  6.53808761e-20;  4.41203718e-19;;
             1.78340075e-19; -2.27569503e-20;  4.26724892e-20;;;

            -8.56908140e-20; -9.72518670e-20;  4.13326424e-20;;
             2.87748879e-20; -1.15988381e-19;  4.08861804e-20;;
            -3.94480233e-20; -3.98168367e-20;  2.69575387e-21;;;;;



         4.99963263e-01;  2.29272093e-17; -2.86799058e-19;;
             2.14831673e-18;  3.13193909e-17;  3.24546778e-18;;
             1.35741026e-17; -2.13537735e-19; -6.57646260e-19;;;

             2.78293091e-16; -1.38063712e-16; -2.50498941e-17;;
             6.04556822e-17;  4.57639616e-17;  2.46885166e-18;;
            -8.79903230e-18;  1.70212431e-17;  2.95411077e-18;;;

             1.50741235e-17; -1.98538344e-17; -3.89293146e-18;;
             5.49952480e-18;  2.84087843e-18;  5.07447260e-20;;
            -2.09725092e-18;  2.74694437e-18;  5.20118981e-19;;;;


            -3.36484194e-17;  3.10696010e-17;  3.20162611e-18;;
             3.56944474e-17; -3.25664835e-17; -3.36584778e-18;;
             6.31873340e-18; -6.34800243e-18; -6.46404749e-19;;;

             2.81977474e-17; -2.38792491e-17; -2.49869943e-18;;
            -2.90390317e-17;  2.59350981e-17;  2.68616991e-18;;
            -5.43349495e-18;  4.87683452e-18;  5.04862589e-19;;;

             5.77179529e-18; -5.99247884e-18; -6.07358261e-19;;
            -6.79088336e-18;  5.97713108e-18;  6.20757732e-19;;
            -9.18819151e-19;  1.32384739e-18;  1.28793051e-19;;;;


             1.40974138e-21; -3.54630380e-18; -3.19792116e-19;;
            -5.73760846e-18;  1.99122869e-18;  2.46616928e-19;;
            -7.98893529e-19;  4.72947818e-19;  5.17284702e-20;;;

             2.34561328e-18;  9.94655571e-18;  8.17713030e-19;;
             3.56484031e-18; -5.49916153e-18; -5.44390129e-19;;
             4.22030873e-19; -1.23719330e-18; -1.15292452e-19;;;

            -2.32025897e-19;  1.48923258e-18;  1.31516094e-19;;
             1.28054485e-18; -8.01145834e-19; -9.02892285e-20;;
             1.55691965e-19; -2.06043501e-19; -2.04047658e-20;;;;;



         1.27152103e-01;  7.47509277e-19; -1.68244688e-18;;
             4.63304008e-19;  6.35723598e-18;  6.79396127e-19;;
             4.94612170e-18;  1.46994270e-19; -3.79295338e-20;;;

             5.91928627e-17; -2.87891070e-17; -3.32217995e-18;;
             1.99411391e-17;  4.96747918e-18;  2.02129771e-19;;
             4.24216090e-19;  1.98140464e-18;  1.73282230e-19;;;

             5.15689754e-18; -3.87702672e-18; -4.06527421e-19;;
             2.23891020e-18; -2.45004990e-19; -4.67452746e-20;;
            -1.12657737e-19;  3.32790994e-19;  3.14783904e-20;;;;


            -1.04290640e-17;  9.34172522e-18;  9.57292638e-19;;
             5.45480277e-18; -5.04506206e-18; -5.31161827e-19;;
             1.24687631e-18; -1.14042138e-18; -1.18963104e-19;;;

             8.80257271e-18; -7.54482795e-18; -7.98676635e-19;;
            -4.43106195e-18;  3.94672772e-18;  3.97201471e-19;;
            -1.02679171e-18;  9.02116107e-19;  9.24464753e-20;;;

             1.98766428e-18; -1.75969853e-18; -1.83989290e-19;;
            -1.01078505e-18;  9.28863753e-19;  9.44209950e-20;;
            -2.33369611e-19;  2.11640682e-19;  2.17289287e-20;;;;


             1.22499456e-18; -1.83448985e-18; -2.47020324e-19;;
            -8.20959421e-19;  7.57803612e-20; -5.45301161e-20;;
            -1.73151346e-19;  8.84469260e-20;  2.32250876e-21;;;

             1.18291130e-18;  1.77850549e-18;  6.21181689e-20;;
             6.67279506e-19; -1.05968248e-18; -1.81474744e-19;;
             4.90292034e-20; -2.31806698e-19; -2.94914098e-20;;;

            -2.91321091e-20;  3.00984336e-19;  1.77874793e-20;;
             2.39009743e-19; -1.32272646e-19; -2.44110439e-20;;
             3.66238103e-20; -3.22597475e-20; -4.36406276e-21],
            [1.49576457e+00;  1.68606883e-01;  4.11377490e-01;;
             2.20854456e-01; -5.06979570e-17; -1.48297754e-17;;
             1.91682796e-01; -4.28098704e-18; -3.03250631e-18;;;

             2.96651313e-01; -1.52117951e-16; -2.87974276e-17;;
             9.85544813e-18; -1.26068312e-17; -1.82987398e-18;;
            -2.64947010e-17;  2.04151968e-17;  3.43762545e-18;;;

             3.35269245e-01; -2.66571677e-17; -8.65114674e-18;;
             1.41002534e-18; -1.22337404e-18; -2.49667270e-19;;
            -2.97331670e-18;  2.22719784e-18;  5.02129829e-19;;;;


             1.35058479e-01;  6.33671440e-17;  5.31519365e-18;;
            -2.74298794e-18;  4.29406209e-18;  1.07929091e-19;;
             7.93333491e-18; -7.50055855e-18; -1.08630334e-19;;;

            -6.00791689e-17;  5.54051086e-17;  6.73924499e-18;;
            -3.34756515e-18;  1.59372967e-18;  4.37359936e-19;;
             4.77460128e-18; -4.13673986e-18; -9.68554646e-19;;;

            -5.74073182e-18;  5.44263054e-18;  7.95821283e-19;;
            -2.10323124e-19; -1.43941116e-19;  4.81126567e-20;;
            -5.98371220e-20;  1.02228055e-19; -1.14428425e-19;;;;


             3.37646199e-02; -2.37467886e-18;  5.05147144e-19;;
             8.46931293e-19; -6.83729888e-20;  1.59692136e-19;;
            -3.52574395e-18;  3.41684249e-18; -3.54198703e-20;;;

             7.09803562e-19; -1.78247073e-18; -7.62390099e-19;;
            -9.61353501e-19;  4.92268856e-19; -8.76704803e-20;;
            -1.98866700e-18;  1.21408536e-18;  4.48047751e-19;;;

            -4.04403498e-19;  2.28264502e-19; -1.11996935e-19;;
            -3.11471188e-19;  1.82498799e-19; -1.29409342e-20;;
             8.58626558e-20; -1.87289179e-19;  5.47037359e-20;;;;;



         4.99963263e-01;  8.32050447e-17; -6.85647337e-19;;
             5.53515005e-17;  2.27049024e-17;  1.05680764e-18;;
             1.99603570e-18;  1.63225390e-17;  1.59012394e-18;;;

             8.83607766e-17; -9.99996893e-17; -1.16883354e-17;;
             1.63971286e-17;  3.14925071e-18; -2.55450992e-19;;
             1.18374815e-18;  1.02932357e-17;  1.49308097e-18;;;

            -1.32580578e-18; -3.25472901e-17; -6.36865089e-18;;
             1.00480865e-18; -6.17269549e-19; -1.92308735e-19;;
            -8.47901575e-19;  1.65871216e-18;  4.24018265e-19;;;;


             1.02499832e-17;  2.91175683e-18;  8.69254265e-20;;
            -4.64903769e-18; -2.33254419e-18; -1.36843898e-19;;
            -1.00984279e-18; -6.12639718e-19; -3.11328996e-20;;;

            -5.58011466e-18; -2.77533450e-18; -1.47196267e-19;;
             3.45566799e-18;  2.25499877e-18;  1.47268742e-19;;
             7.49863393e-19;  4.11677340e-19;  1.88624856e-20;;;

            -1.48455723e-18; -5.98554534e-19; -2.73877700e-20;;
             8.14791283e-19;  5.01547273e-19;  3.20893871e-20;;
             1.87092116e-19;  9.22429115e-20;  3.90211539e-21;;;;


             1.57231038e-17; -1.00800814e-17; -1.20004923e-18;;
            -3.40022589e-18;  1.55870165e-20;  3.04003309e-20;;
            -4.39902043e-19; -5.25845976e-19;  7.55148791e-21;;;

             5.31534932e-18;  5.48792490e-18;  4.70440868e-19;;
             6.48576503e-19;  2.35966586e-18;  2.13106544e-19;;
            -1.06759231e-19; -1.39192708e-19; -4.84695289e-20;;;

            -5.92137415e-20;  1.54844077e-18;  1.52267313e-19;;
             2.58239351e-19;  4.17326986e-19;  3.65022534e-20;;
             6.66077987e-20; -5.10143140e-20; -1.41976204e-20;;;;;



         1.27152103e-01;  2.64053263e-17;  1.87453686e-18;;
             1.14621989e-17;  6.36289187e-18;  4.76910862e-19;;
             2.80365728e-18;  1.82800781e-18; -8.67438264e-20;;;

             2.07717264e-17; -2.28941320e-17; -2.68751498e-18;;
             3.56117578e-18;  9.58256645e-19; -3.55695508e-20;;
             2.00680115e-19;  2.38975911e-18;  3.47044517e-19;;;

             2.85446168e-18; -7.75745683e-18; -1.53912412e-18;;
             2.30510206e-19; -1.38180388e-19; -4.40186598e-20;;
            -2.58668313e-19;  4.33721110e-19;  1.03286499e-19;;;;


             2.39508763e-18;  6.30999482e-19;  1.60529540e-20;;
            -1.03579320e-18; -5.77663838e-19; -3.55574857e-20;;
            -2.22755939e-19; -1.42123716e-19; -7.40081569e-21;;;

            -1.25977109e-18; -6.86260230e-19; -3.83648534e-20;;
             8.39703446e-19;  4.78969772e-19;  2.97547248e-20;;
             1.84638527e-19;  9.44665604e-20;  4.13205533e-21;;;

            -3.39507811e-19; -1.43588952e-19; -6.84045187e-21;;
             1.93105222e-19;  1.10924750e-19;  6.91085159e-21;;
             4.45650185e-20;  2.12347479e-20;  8.74910315e-22;;;;


             3.81102471e-18; -2.60321014e-18; -3.03770305e-19;;
            -5.33716027e-19; -2.51925780e-19; -1.89508235e-20;;
            -3.22141721e-20; -1.25374252e-19;  3.71580813e-22;;;

             1.42128275e-18;  9.70789600e-19;  7.99695564e-20;;
             4.22316950e-19;  2.68626044e-19;  2.11255965e-20;;
             5.04478629e-20; -3.63688189e-20; -1.26831797e-20;;;

             9.08348984e-21;  3.22747781e-19;  3.17962323e-20;;
             9.17421902e-20;  6.38540109e-20;  5.12338319e-21;;
             2.42318218e-20; -1.22813672e-20; -3.45488302e-21],
            [5.49119633e-01;  2.02719397e-01;;
             2.05265617e-02;  2.00327894e-01;;
             1.78153016e-02;  1.73867494e-01;;;

             3.55981576e-02; -4.79403779e-18;;
            -3.87882958e-17;  6.12918957e-18;;
            -1.81021848e-17;  1.13416102e-17;;;

             4.02323093e-02;  1.11973965e-19;;
            -8.98375531e-18;  1.52152949e-18;;
            -4.01756286e-18;  1.91735809e-18;;;;


             1.35058479e-01;  5.94760094e-18;;
             7.69395246e-18;  7.06389841e-19;;
             2.51265164e-19;  3.19281748e-20;;;

            -3.16361745e-17; -5.40901655e-18;;
             3.85207648e-18;  1.95744513e-18;;
             1.90223606e-18;  5.17594123e-19;;;

            -7.28196516e-18; -1.05789185e-18;;
             8.75899333e-19;  3.51447779e-19;;
             4.36259329e-19;  9.65821278e-20;;;;


             3.37646199e-02; -2.65041304e-18;;
            -1.89010865e-18; -3.06353560e-19;;
             4.62341252e-19;  6.61993892e-20;;;

             1.47680634e-17;  2.64094224e-18;;
            -9.90355019e-20; -2.47678807e-19;;
            -6.36336582e-19; -1.47853220e-19;;;

             3.47046958e-18;  5.69551351e-19;;
            -5.37519332e-20; -3.58990090e-20;;
            -1.54051928e-19; -2.92922262e-20;;;;;



         4.99963263e-01; -4.51000037e-18;;
            -5.86654108e-17; -3.11421864e-17;;
            -6.34906134e-18; -8.76327862e-18;;;

             4.93397042e-17;  1.27312132e-17;;
             5.13713052e-17;  1.34337514e-17;;
             1.21566217e-17; -6.04640724e-19;;;

             1.04424704e-17;  2.18900658e-18;;
             1.15803135e-17;  3.55019066e-18;;
             2.62535282e-18;  6.36963537e-19;;;;


            -8.91062611e-18;  2.88584674e-18;;
            -5.72097891e-18;  3.69523315e-18;;
            -4.72182756e-19;  4.25784901e-19;;;

             1.49494096e-17; -1.02282534e-18;;
            -1.02258364e-17; -5.55059951e-18;;
            -2.14375543e-18; -7.78990578e-19;;;

             1.64723141e-18; -5.45858823e-19;;
            -1.41291123e-18; -1.11959301e-18;;
            -2.78594027e-19; -1.42834149e-19;;;;


             9.85390930e-19; -4.16044371e-19;;
             7.78935935e-18;  7.15131094e-19;;
             1.11212800e-18;  1.23424928e-19;;;

            -4.83095371e-18; -3.52743064e-19;;
             1.89623903e-18;  8.28398167e-19;;
             4.84195607e-19;  1.37535144e-19;;;

            -4.91299177e-19;  2.55736473e-20;;
             1.09690662e-19;  1.35102418e-19;;
             3.69267458e-20;  1.89322089e-20;;;;;



         1.27152103e-01; -2.14404266e-18;;
            -9.60099826e-18; -6.27568893e-18;;
            -3.18297026e-19; -1.19267467e-18;;;

             7.40356148e-18;  4.37533456e-18;;
             8.23054172e-18;  2.41916808e-18;;
             2.14311438e-18; -1.06172510e-18;;;

             1.50386501e-18;  8.39486389e-19;;
             1.97314415e-18;  6.85752285e-19;;
             3.74430051e-19; -7.92905809e-20;;;;


            -2.31404570e-18;  6.22905375e-19;;
            -1.18736968e-18;  8.76691280e-19;;
            -7.84391585e-20;  1.03616949e-19;;;

             3.48968459e-18; -2.30115176e-19;;
            -2.38133525e-18; -1.28555312e-18;;
            -4.99577208e-19; -1.80704330e-19;;;

             5.99992360e-19; -8.84979160e-20;;
            -4.41757350e-19; -2.78416400e-19;;
            -9.06815078e-20; -3.75082611e-20;;;;


             2.61512218e-19; -9.03113175e-20;;
             1.78170536e-18;  1.62159821e-19;;
             2.52863084e-19;  2.78176640e-20;;;

            -1.12083114e-18; -8.23100813e-20;;
             4.40583130e-19;  1.91807899e-19;;
             1.12432587e-19;  3.18717451e-20;;;

            -1.42587480e-19;  9.23368410e-22;;
             4.06294772e-20;  3.38315346e-20;;
             1.20195434e-20;  4.97159986e-21],
            [9.69840558e-01;  1.68606883e-01;  4.11377490e-01;;
             2.27901995e-01; -1.24309595e-17;  8.25603419e-18;;;

             5.29073342e-02; -7.46091880e-17; -1.85281254e-17;;
             1.83676181e-01; -1.04166859e-16; -1.14069672e-17;;;

             5.97947866e-02; -6.64017247e-18; -6.41927440e-18;;
             2.07587061e-01; -2.54512810e-17; -3.40085408e-18;;;;


             1.35058479e-01;  2.31430691e-18; -6.72762893e-18;;
             1.98802250e-17; -3.18309247e-18; -2.29197550e-18;;;

            -5.12474635e-17;  6.01397046e-18;  6.20055503e-18;;
            -1.53997395e-17;  1.58437355e-18;  1.76388565e-18;;;

            -1.33638081e-17; -1.70368117e-18;  1.18667316e-18;;
            -5.46909963e-18;  9.67832915e-19;  4.87959566e-19;;;;


             3.37646199e-02; -6.81868016e-18;  2.73831818e-19;;
            -5.93822658e-18; -1.56759129e-18;  1.24806388e-19;;;

             1.33845025e-17;  4.53207270e-18; -2.90078414e-19;;
             4.24065660e-18;  1.06109094e-18; -1.09252487e-19;;;

             3.30419645e-18;  1.99052380e-18;  1.49874169e-20;;
             1.31709634e-18; -1.84937423e-19; -7.00129850e-20;;;;;



         4.99963263e-01; -1.00662370e-17;  2.29723215e-18;;
            -4.39869872e-17;  3.82903378e-17;  7.46065937e-18;;;

             1.77788932e-16; -1.39729683e-16; -2.46306662e-17;;
             7.94939073e-17; -6.65767506e-17; -9.80600214e-18;;;

             1.16756624e-17; -2.06386167e-17; -4.02738435e-18;;
             6.48364192e-18; -1.24755483e-17; -1.99568033e-18;;;;


             4.59654126e-18;  1.97245530e-18;  4.27583244e-20;;
             1.13417236e-18;  6.43430431e-19;  1.93352139e-20;;;

            -3.43457551e-19; -3.49061114e-20;  5.27146302e-20;;
            -2.50400329e-19;  1.18720804e-19;  2.88122201e-20;;;

            -2.84298440e-18; -1.55926603e-18; -8.35910277e-20;;
            -8.75261679e-19; -4.42063177e-19; -2.04385641e-20;;;;


             8.01750108e-18;  4.16761857e-19; -4.80192786e-19;;
             1.14385235e-18;  6.63717382e-19; -8.91873113e-20;;;

             8.78699897e-19;  1.54456738e-18;  4.54696849e-19;;
            -7.56470482e-19;  1.28629194e-18;  2.20321242e-19;;;

             3.91057974e-19;  5.30136140e-19;  1.03753213e-19;;
            -3.31330633e-19;  1.58168913e-19;  5.13634639e-20;;;;;



         1.27152103e-01;  6.91300878e-18;  2.11366792e-18;;
            -9.64263403e-18;  9.23999004e-18;  1.77144208e-18;;;

             3.59148864e-17; -3.59563826e-17; -5.99397999e-18;;
             1.67605442e-17; -1.64040837e-17; -2.34782127e-18;;;

             3.90764224e-18; -6.15476863e-18; -1.08313730e-18;;
             1.00134007e-18; -3.14625746e-18; -4.80619661e-19;;;;


             2.97186772e-19; -8.53943022e-20; -3.92173999e-20;;
             4.77495278e-20;  9.55773189e-21; -8.25519959e-21;;;

             2.31408072e-20;  1.30026992e-19;  3.35763546e-20;;
            -2.59855819e-20;  6.63921673e-20;  1.26728393e-20;;;

            -1.61954334e-20;  3.05380252e-20;  7.64563700e-21;;
            -3.49797155e-21;  7.20620189e-21;  2.54161744e-21;;;;


             1.95734477e-18; -5.62427761e-19; -2.58295388e-19;;
             3.14490069e-19;  6.29495599e-20; -5.43707636e-20;;;

             1.52411016e-19;  8.56389571e-19;  2.21142084e-19;;
            -1.71147398e-19;  4.37275053e-19;  8.34664190e-20;;;

            -1.06667086e-19;  2.01130903e-19;  5.03560353e-20;;
            -2.30384962e-20;  4.74618082e-20;  1.67397141e-20]]
        level_8 = 6
        expected_allDims_8 = [2; 1; 0; 4; 3;;
                                        4; 3; 2; 1; 0;;
                                        4; 3; 2; 1; 0;;
                                        3; 2; 1; 0; 4;;
                                        4; 2; 1; 0; 3]
        @test isapprox(expected_allDims_8, getSubdivisionDims(Ms_8,trackedInterval_8,level_8))

        trackedInterval_9 = TrackedInterval([-1.;  1.])
        Ms_9 = [[ 1.98388230e-01; -7.45867440e-02;  4.04311356e-01;  5.88271449e-01;
                            2.26026393e-01;  1.32940050e+00; -4.45466673e-01; -8.61593362e-01;
                            1.63812136e-01;  2.12669974e-01; -2.95468574e-02; -2.95366346e-02;
                            3.27547093e-03;  2.68367335e-03; -2.48957499e-04; -1.73443093e-04;
                            1.38658587e-05;  8.41868996e-06; -5.92171480e-07; -3.18960845e-07;
                            2.00473230e-08;  9.70991815e-09; -5.51888146e-10; -2.42949605e-10;
                            1.26081368e-11;  5.08808273e-12; -2.43249865e-13; -9.04276654e-14;
                            4.28823643e-15;  1.47104551e-15]]
        level_9 = 5
        expected_allDims_9 = [0;;]
        @test isapprox(expected_allDims_9, getSubdivisionDims(Ms_9,trackedInterval_9,level_9))

        trackedInterval_10 = TrackedInterval([-1.;  1.])
        Ms_10 = [[ 1.98388230e-01; -7.45867440e-02;  4.04311356e-01;  5.88271449e-01;
                            2.26026393e-01;  1.32940050e+00; -4.45466673e-01; -8.61593362e-01;
                            1.63812136e-01;  2.12669974e-01; -2.95468574e-02; -2.95366346e-02;
                            3.27547093e-03;  2.68367335e-03; -2.48957499e-04; -1.73443093e-04;
                            1.38658587e-05;  8.41868996e-06; -5.92171480e-07; -3.18960845e-07;
                            2.00473230e-08;  9.70991815e-09; -5.51888146e-10; -2.42949605e-10;
                            1.26081368e-11;  5.08808273e-12; -2.43249865e-13; -9.04276654e-14;
                            4.28823643e-15;  1.47104551e-15]]
        level_10 = 6
        expected_allDims_10 = [0;;]
        @test isapprox(expected_allDims_10, getSubdivisionDims(Ms_10,trackedInterval_10,level_10))

        trackedInterval_11 = TrackedInterval([ 0.03945555;  0.03945555 + 1e-5;;
                                                -1.;          1;;
                                                1.;  1. + 1e-5;;
                                                0.03945555;  0.03945555 + 1e-5;;
                                                0.41480102;  0.41480102 + 1e-5])
        Ms_11 = [[1.07142165e+00;  1.61772562e-01;;
                    5.75461946e-02;  5.61619043e-01;;;
                    2.96651313e-01; -3.39708980e-17;;
                    6.23974136e-17;  3.06138888e-17;;;
                    3.35269245e-01; -2.14750436e-18;;
                    1.63404061e-17;  3.92462018e-18;;;;
                    4.05175438e-01;  1.49089271e-17;;
                    -2.42704359e-17;  6.11752001e-18;;;

                    8.91612496e-17; -1.64457404e-17;;
                    4.37735368e-18; -8.26735644e-18;;;

                    1.59746311e-17; -5.58287457e-18;;
                    1.21413250e-18; -2.15690973e-18;;;;


                    1.01293860e-01; -2.91078151e-18;;
                    6.02650904e-18; -7.69091844e-19;;;

                    -1.61151471e-17;  1.96422369e-18;;
                    -1.02880386e-18;  1.16696315e-18;;;

                    -3.16461064e-18;  1.07109611e-18;;
                    -3.19107512e-19;  4.03906181e-19;;;;;



                    4.99963263e-01;  7.24023441e-18;;
                    2.08333217e-17; -3.58422625e-18;;;

                    -2.88911748e-17; -2.39516560e-17;;
                    -3.52016062e-17;  2.07163246e-17;;;

                    -2.99141286e-17; -9.60551746e-18;;
                    -1.09122488e-17;  5.52770123e-18;;;;


                    6.41527705e-17; -4.54209112e-18;;
                    1.38295961e-17; -2.04590576e-18;;;

                    -3.54019101e-17; -6.07501389e-18;;
                    -6.98105270e-18; -1.19866640e-18;;;

                    -1.31610394e-17; -1.04908960e-18;;
                    -2.96892590e-18; -1.65904797e-19;;;;


                    -1.29567793e-17; -6.01707661e-19;;
                    -4.40294636e-18; -2.94442193e-19;;;

                    2.92589264e-17;  3.61843830e-18;;
                    5.62920573e-18;  5.67975389e-19;;;

                    5.75914328e-18;  7.63941973e-19;;
                    1.41156695e-18;  1.78514600e-19;;;;;



                    1.27152103e-01;  1.91152932e-18;;
                    4.79121097e-18; -1.23937605e-18;;;

                    -2.09329083e-17; -4.09015035e-18;;
                    -7.01631281e-18;  3.73102191e-18;;;

                    -9.06126759e-18; -1.92681844e-18;;
                    -2.12745553e-18;  1.25546687e-18;;;;


                    1.36153101e-17; -1.23234013e-18;;
                    2.89822838e-18; -5.16802841e-19;;;

                    -7.90847046e-18; -1.37345331e-18;;
                    -1.56775419e-18; -2.73832184e-19;;;

                    -2.10526282e-18; -8.93431017e-20;;
                    -4.34200889e-19;  2.74305342e-21;;;;


                    -3.91222649e-18; -1.41462319e-19;;
                    -9.76066997e-19; -1.69143790e-20;;;

                    7.54787397e-18;  8.63779933e-19;;
                    1.31538564e-18;  1.03280515e-19;;;

                    1.46097501e-18;  1.51097345e-19;;
                    2.70074762e-19;  1.80664207e-20],

                    [1.71925557e+00;  1.68606883e-01;  4.11377490e-01;;
                    4.41708911e-01;  3.45276625e-17;  2.71584393e-18;;
                    3.83365591e-01;  5.51328328e-18;  2.19183835e-19;;;

                    2.96651313e-01;  5.68098934e-17;  1.04881815e-17;;
                    -2.59134440e-17;  5.02067534e-17;  3.18884982e-18;;
                    -4.40610755e-17;  1.85375284e-17;  4.80625344e-18;;;

                    3.35269245e-01; -3.38256162e-18; -2.81267507e-18;;
                    -3.88863843e-18;  1.97375581e-18; -5.95518601e-20;;
                    -2.82334822e-18;  1.92548058e-18;  7.35266273e-19;;;;


                    1.35058479e-01; -9.34504427e-18; -9.29019885e-19;;
                    -1.10973940e-17;  1.03984213e-17;  1.13091038e-18;;
                    -2.27373541e-18;  1.44719312e-18;  1.66375006e-19;;;

                    -3.86160966e-17;  3.43535302e-17;  3.62552216e-18;;
                    -2.65620582e-17;  2.40509961e-17;  2.55367163e-18;;
                    -2.24963724e-18;  2.14897426e-18;  2.27589614e-19;;;

                    -7.29423233e-18;  5.54979427e-18;  5.98695706e-19;;
                    -3.99966511e-18;  3.36022405e-18;  3.59624925e-19;;
                    7.16837006e-20;  4.65715043e-19;  4.02772780e-20;;;;


                    3.37646199e-02;  6.57761381e-18;  1.05638586e-18;;
                    -1.54799727e-18;  1.72457255e-18;  5.76470040e-19;;
                    1.18536415e-19;  9.64716050e-21;  4.27921252e-20;;;

                    -4.17762847e-18;  6.66283925e-19;  5.32216329e-19;;
                    6.92434840e-20;  6.53808761e-20;  4.41203718e-19;;
                    1.78340075e-19; -2.27569503e-20;  4.26724892e-20;;;

                    -8.56908140e-20; -9.72518670e-20;  4.13326424e-20;;
                    2.87748879e-20; -1.15988381e-19;  4.08861804e-20;;
                    -3.94480233e-20; -3.98168367e-20;  2.69575387e-21;;;;;



                    4.99963263e-01;  2.29272093e-17; -2.86799058e-19;;
                    2.14831673e-18;  3.13193909e-17;  3.24546778e-18;;
                    1.35741026e-17; -2.13537735e-19; -6.57646260e-19;;;

                    2.78293091e-16; -1.38063712e-16; -2.50498941e-17;;
                    6.04556822e-17;  4.57639616e-17;  2.46885166e-18;;
                    -8.79903230e-18;  1.70212431e-17;  2.95411077e-18;;;

                    1.50741235e-17; -1.98538344e-17; -3.89293146e-18;;
                    5.49952480e-18;  2.84087843e-18;  5.07447260e-20;;
                    -2.09725092e-18;  2.74694437e-18;  5.20118981e-19;;;;


                    -3.36484194e-17;  3.10696010e-17;  3.20162611e-18;;
                    3.56944474e-17; -3.25664835e-17; -3.36584778e-18;;
                    6.31873340e-18; -6.34800243e-18; -6.46404749e-19;;;

                    2.81977474e-17; -2.38792491e-17; -2.49869943e-18;;
                    -2.90390317e-17;  2.59350981e-17;  2.68616991e-18;;
                    -5.43349495e-18;  4.87683452e-18;  5.04862589e-19;;;

                    5.77179529e-18; -5.99247884e-18; -6.07358261e-19;;
                    -6.79088336e-18;  5.97713108e-18;  6.20757732e-19;;
                    -9.18819151e-19;  1.32384739e-18;  1.28793051e-19;;;;


                    1.40974138e-21; -3.54630380e-18; -3.19792116e-19;;
                    -5.73760846e-18;  1.99122869e-18;  2.46616928e-19;;
                    -7.98893529e-19;  4.72947818e-19;  5.17284702e-20;;;

                    2.34561328e-18;  9.94655571e-18;  8.17713030e-19;;
                    3.56484031e-18; -5.49916153e-18; -5.44390129e-19;;
                    4.22030873e-19; -1.23719330e-18; -1.15292452e-19;;;

                    -2.32025897e-19;  1.48923258e-18;  1.31516094e-19;;
                    1.28054485e-18; -8.01145834e-19; -9.02892285e-20;;
                    1.55691965e-19; -2.06043501e-19; -2.04047658e-20;;;;;



                    1.27152103e-01;  7.47509277e-19; -1.68244688e-18;;
                    4.63304008e-19;  6.35723598e-18;  6.79396127e-19;;
                    4.94612170e-18;  1.46994270e-19; -3.79295338e-20;;;

                    5.91928627e-17; -2.87891070e-17; -3.32217995e-18;;
                    1.99411391e-17;  4.96747918e-18;  2.02129771e-19;;
                    4.24216090e-19;  1.98140464e-18;  1.73282230e-19;;;

                    5.15689754e-18; -3.87702672e-18; -4.06527421e-19;;
                    2.23891020e-18; -2.45004990e-19; -4.67452746e-20;;
                    -1.12657737e-19;  3.32790994e-19;  3.14783904e-20;;;;


                    -1.04290640e-17;  9.34172522e-18;  9.57292638e-19;;
                    5.45480277e-18; -5.04506206e-18; -5.31161827e-19;;
                    1.24687631e-18; -1.14042138e-18; -1.18963104e-19;;;

                    8.80257271e-18; -7.54482795e-18; -7.98676635e-19;;
                    -4.43106195e-18;  3.94672772e-18;  3.97201471e-19;;
                    -1.02679171e-18;  9.02116107e-19;  9.24464753e-20;;;

                    1.98766428e-18; -1.75969853e-18; -1.83989290e-19;;
                    -1.01078505e-18;  9.28863753e-19;  9.44209950e-20;;
                    -2.33369611e-19;  2.11640682e-19;  2.17289287e-20;;;;


                    1.22499456e-18; -1.83448985e-18; -2.47020324e-19;;
                    -8.20959421e-19;  7.57803612e-20; -5.45301161e-20;;
                    -1.73151346e-19;  8.84469260e-20;  2.32250876e-21;;;

                    1.18291130e-18;  1.77850549e-18;  6.21181689e-20;;
                    6.67279506e-19; -1.05968248e-18; -1.81474744e-19;;
                    4.90292034e-20; -2.31806698e-19; -2.94914098e-20;;;

                    -2.91321091e-20;  3.00984336e-19;  1.77874793e-20;;
                    2.39009743e-19; -1.32272646e-19; -2.44110439e-20;;
                    3.66238103e-20; -3.22597475e-20; -4.36406276e-21],
                    [1.49576457e+00;  1.68606883e-01;  4.11377490e-01;;
                    2.20854456e-01; -5.06979570e-17; -1.48297754e-17;;
                    1.91682796e-01; -4.28098704e-18; -3.03250631e-18;;;

                    2.96651313e-01; -1.52117951e-16; -2.87974276e-17;;
                    9.85544813e-18; -1.26068312e-17; -1.82987398e-18;;
                    -2.64947010e-17;  2.04151968e-17;  3.43762545e-18;;;

                    3.35269245e-01; -2.66571677e-17; -8.65114674e-18;;
                    1.41002534e-18; -1.22337404e-18; -2.49667270e-19;;
                    -2.97331670e-18;  2.22719784e-18;  5.02129829e-19;;;;


                    1.35058479e-01;  6.33671440e-17;  5.31519365e-18;;
                    -2.74298794e-18;  4.29406209e-18;  1.07929091e-19;;
                    7.93333491e-18; -7.50055855e-18; -1.08630334e-19;;;

                    -6.00791689e-17;  5.54051086e-17;  6.73924499e-18;;
                    -3.34756515e-18;  1.59372967e-18;  4.37359936e-19;;
                    4.77460128e-18; -4.13673986e-18; -9.68554646e-19;;;

                    -5.74073182e-18;  5.44263054e-18;  7.95821283e-19;;
                    -2.10323124e-19; -1.43941116e-19;  4.81126567e-20;;
                    -5.98371220e-20;  1.02228055e-19; -1.14428425e-19;;;;


                    3.37646199e-02; -2.37467886e-18;  5.05147144e-19;;
                    8.46931293e-19; -6.83729888e-20;  1.59692136e-19;;
                    -3.52574395e-18;  3.41684249e-18; -3.54198703e-20;;;

                    7.09803562e-19; -1.78247073e-18; -7.62390099e-19;;
                    -9.61353501e-19;  4.92268856e-19; -8.76704803e-20;;
                    -1.98866700e-18;  1.21408536e-18;  4.48047751e-19;;;

                    -4.04403498e-19;  2.28264502e-19; -1.11996935e-19;;
                    -3.11471188e-19;  1.82498799e-19; -1.29409342e-20;;
                    8.58626558e-20; -1.87289179e-19;  5.47037359e-20;;;;;



                    4.99963263e-01;  8.32050447e-17; -6.85647337e-19;;
                    5.53515005e-17;  2.27049024e-17;  1.05680764e-18;;
                    1.99603570e-18;  1.63225390e-17;  1.59012394e-18;;;

                    8.83607766e-17; -9.99996893e-17; -1.16883354e-17;;
                    1.63971286e-17;  3.14925071e-18; -2.55450992e-19;;
                    1.18374815e-18;  1.02932357e-17;  1.49308097e-18;;;

                    -1.32580578e-18; -3.25472901e-17; -6.36865089e-18;;
                    1.00480865e-18; -6.17269549e-19; -1.92308735e-19;;
                    -8.47901575e-19;  1.65871216e-18;  4.24018265e-19;;;;


                    1.02499832e-17;  2.91175683e-18;  8.69254265e-20;;
                    -4.64903769e-18; -2.33254419e-18; -1.36843898e-19;;
                    -1.00984279e-18; -6.12639718e-19; -3.11328996e-20;;;

                    -5.58011466e-18; -2.77533450e-18; -1.47196267e-19;;
                    3.45566799e-18;  2.25499877e-18;  1.47268742e-19;;
                    7.49863393e-19;  4.11677340e-19;  1.88624856e-20;;;

                    -1.48455723e-18; -5.98554534e-19; -2.73877700e-20;;
                    8.14791283e-19;  5.01547273e-19;  3.20893871e-20;;
                    1.87092116e-19;  9.22429115e-20;  3.90211539e-21;;;;


                    1.57231038e-17; -1.00800814e-17; -1.20004923e-18;;
                    -3.40022589e-18;  1.55870165e-20;  3.04003309e-20;;
                    -4.39902043e-19; -5.25845976e-19;  7.55148791e-21;;;

                    5.31534932e-18;  5.48792490e-18;  4.70440868e-19;;
                    6.48576503e-19;  2.35966586e-18;  2.13106544e-19;;
                    -1.06759231e-19; -1.39192708e-19; -4.84695289e-20;;;

                    -5.92137415e-20;  1.54844077e-18;  1.52267313e-19;;
                    2.58239351e-19;  4.17326986e-19;  3.65022534e-20;;
                    6.66077987e-20; -5.10143140e-20; -1.41976204e-20;;;;;



                    1.27152103e-01;  2.64053263e-17;  1.87453686e-18;;
                    1.14621989e-17;  6.36289187e-18;  4.76910862e-19;;
                    2.80365728e-18;  1.82800781e-18; -8.67438264e-20;;;

                    2.07717264e-17; -2.28941320e-17; -2.68751498e-18;;
                    3.56117578e-18;  9.58256645e-19; -3.55695508e-20;;
                    2.00680115e-19;  2.38975911e-18;  3.47044517e-19;;;

                    2.85446168e-18; -7.75745683e-18; -1.53912412e-18;;
                    2.30510206e-19; -1.38180388e-19; -4.40186598e-20;;
                    -2.58668313e-19;  4.33721110e-19;  1.03286499e-19;;;;


                    2.39508763e-18;  6.30999482e-19;  1.60529540e-20;;
                    -1.03579320e-18; -5.77663838e-19; -3.55574857e-20;;
                    -2.22755939e-19; -1.42123716e-19; -7.40081569e-21;;;

                    -1.25977109e-18; -6.86260230e-19; -3.83648534e-20;;
                    8.39703446e-19;  4.78969772e-19;  2.97547248e-20;;
                    1.84638527e-19;  9.44665604e-20;  4.13205533e-21;;;

                    -3.39507811e-19; -1.43588952e-19; -6.84045187e-21;;
                    1.93105222e-19;  1.10924750e-19;  6.91085159e-21;;
                    4.45650185e-20;  2.12347479e-20;  8.74910315e-22;;;;


                    3.81102471e-18; -2.60321014e-18; -3.03770305e-19;;
                    -5.33716027e-19; -2.51925780e-19; -1.89508235e-20;;
                    -3.22141721e-20; -1.25374252e-19;  3.71580813e-22;;;

                    1.42128275e-18;  9.70789600e-19;  7.99695564e-20;;
                    4.22316950e-19;  2.68626044e-19;  2.11255965e-20;;
                    5.04478629e-20; -3.63688189e-20; -1.26831797e-20;;;

                    9.08348984e-21;  3.22747781e-19;  3.17962323e-20;;
                    9.17421902e-20;  6.38540109e-20;  5.12338319e-21;;
                    2.42318218e-20; -1.22813672e-20; -3.45488302e-21],
                    [5.49119633e-01;  2.02719397e-01;;
                    2.05265617e-02;  2.00327894e-01;;
                    1.78153016e-02;  1.73867494e-01;;;

                    3.55981576e-02; -4.79403779e-18;;
                    -3.87882958e-17;  6.12918957e-18;;
                    -1.81021848e-17;  1.13416102e-17;;;

                    4.02323093e-02;  1.11973965e-19;;
                    -8.98375531e-18;  1.52152949e-18;;
                    -4.01756286e-18;  1.91735809e-18;;;;


                    1.35058479e-01;  5.94760094e-18;;
                    7.69395246e-18;  7.06389841e-19;;
                    2.51265164e-19;  3.19281748e-20;;;

                    -3.16361745e-17; -5.40901655e-18;;
                    3.85207648e-18;  1.95744513e-18;;
                    1.90223606e-18;  5.17594123e-19;;;

                    -7.28196516e-18; -1.05789185e-18;;
                    8.75899333e-19;  3.51447779e-19;;
                    4.36259329e-19;  9.65821278e-20;;;;


                    3.37646199e-02; -2.65041304e-18;;
                    -1.89010865e-18; -3.06353560e-19;;
                    4.62341252e-19;  6.61993892e-20;;;

                    1.47680634e-17;  2.64094224e-18;;
                    -9.90355019e-20; -2.47678807e-19;;
                    -6.36336582e-19; -1.47853220e-19;;;

                    3.47046958e-18;  5.69551351e-19;;
                    -5.37519332e-20; -3.58990090e-20;;
                    -1.54051928e-19; -2.92922262e-20;;;;;



                    4.99963263e-01; -4.51000037e-18;;
                    -5.86654108e-17; -3.11421864e-17;;
                    -6.34906134e-18; -8.76327862e-18;;;

                    4.93397042e-17;  1.27312132e-17;;
                    5.13713052e-17;  1.34337514e-17;;
                    1.21566217e-17; -6.04640724e-19;;;

                    1.04424704e-17;  2.18900658e-18;;
                    1.15803135e-17;  3.55019066e-18;;
                    2.62535282e-18;  6.36963537e-19;;;;


                    -8.91062611e-18;  2.88584674e-18;;
                    -5.72097891e-18;  3.69523315e-18;;
                    -4.72182756e-19;  4.25784901e-19;;;

                    1.49494096e-17; -1.02282534e-18;;
                    -1.02258364e-17; -5.55059951e-18;;
                    -2.14375543e-18; -7.78990578e-19;;;

                    1.64723141e-18; -5.45858823e-19;;
                    -1.41291123e-18; -1.11959301e-18;;
                    -2.78594027e-19; -1.42834149e-19;;;;


                    9.85390930e-19; -4.16044371e-19;;
                    7.78935935e-18;  7.15131094e-19;;
                    1.11212800e-18;  1.23424928e-19;;;

                    -4.83095371e-18; -3.52743064e-19;;
                    1.89623903e-18;  8.28398167e-19;;
                    4.84195607e-19;  1.37535144e-19;;;

                    -4.91299177e-19;  2.55736473e-20;;
                    1.09690662e-19;  1.35102418e-19;;
                    3.69267458e-20;  1.89322089e-20;;;;;



                    1.27152103e-01; -2.14404266e-18;;
                    -9.60099826e-18; -6.27568893e-18;;
                    -3.18297026e-19; -1.19267467e-18;;;

                    7.40356148e-18;  4.37533456e-18;;
                    8.23054172e-18;  2.41916808e-18;;
                    2.14311438e-18; -1.06172510e-18;;;

                    1.50386501e-18;  8.39486389e-19;;
                    1.97314415e-18;  6.85752285e-19;;
                    3.74430051e-19; -7.92905809e-20;;;;


                    -2.31404570e-18;  6.22905375e-19;;
                    -1.18736968e-18;  8.76691280e-19;;
                    -7.84391585e-20;  1.03616949e-19;;;

                    3.48968459e-18; -2.30115176e-19;;
                    -2.38133525e-18; -1.28555312e-18;;
                    -4.99577208e-19; -1.80704330e-19;;;

                    5.99992360e-19; -8.84979160e-20;;
                    -4.41757350e-19; -2.78416400e-19;;
                    -9.06815078e-20; -3.75082611e-20;;;;


                    2.61512218e-19; -9.03113175e-20;;
                    1.78170536e-18;  1.62159821e-19;;
                    2.52863084e-19;  2.78176640e-20;;;

                    -1.12083114e-18; -8.23100813e-20;;
                    4.40583130e-19;  1.91807899e-19;;
                    1.12432587e-19;  3.18717451e-20;;;

                    -1.42587480e-19;  9.23368410e-22;;
                    4.06294772e-20;  3.38315346e-20;;
                    1.20195434e-20;  4.97159986e-21],
                    [9.69840558e-01;  1.68606883e-01;  4.11377490e-01;;
                    2.27901995e-01; -1.24309595e-17;  8.25603419e-18;;;

                    5.29073342e-02; -7.46091880e-17; -1.85281254e-17;;
                    1.83676181e-01; -1.04166859e-16; -1.14069672e-17;;;

                    5.97947866e-02; -6.64017247e-18; -6.41927440e-18;;
                    2.07587061e-01; -2.54512810e-17; -3.40085408e-18;;;;


                    1.35058479e-01;  2.31430691e-18; -6.72762893e-18;;
                    1.98802250e-17; -3.18309247e-18; -2.29197550e-18;;;

                    -5.12474635e-17;  6.01397046e-18;  6.20055503e-18;;
                    -1.53997395e-17;  1.58437355e-18;  1.76388565e-18;;;

                    -1.33638081e-17; -1.70368117e-18;  1.18667316e-18;;
                    -5.46909963e-18;  9.67832915e-19;  4.87959566e-19;;;;


                    3.37646199e-02; -6.81868016e-18;  2.73831818e-19;;
                    -5.93822658e-18; -1.56759129e-18;  1.24806388e-19;;;

                    1.33845025e-17;  4.53207270e-18; -2.90078414e-19;;
                    4.24065660e-18;  1.06109094e-18; -1.09252487e-19;;;

                    3.30419645e-18;  1.99052380e-18;  1.49874169e-20;;
                    1.31709634e-18; -1.84937423e-19; -7.00129850e-20;;;;;



                    4.99963263e-01; -1.00662370e-17;  2.29723215e-18;;
                    -4.39869872e-17;  3.82903378e-17;  7.46065937e-18;;;

                    1.77788932e-16; -1.39729683e-16; -2.46306662e-17;;
                    7.94939073e-17; -6.65767506e-17; -9.80600214e-18;;;

                    1.16756624e-17; -2.06386167e-17; -4.02738435e-18;;
                    6.48364192e-18; -1.24755483e-17; -1.99568033e-18;;;;


                    4.59654126e-18;  1.97245530e-18;  4.27583244e-20;;
                    1.13417236e-18;  6.43430431e-19;  1.93352139e-20;;;

                    -3.43457551e-19; -3.49061114e-20;  5.27146302e-20;;
                    -2.50400329e-19;  1.18720804e-19;  2.88122201e-20;;;

                    -2.84298440e-18; -1.55926603e-18; -8.35910277e-20;;
                    -8.75261679e-19; -4.42063177e-19; -2.04385641e-20;;;;


                    8.01750108e-18;  4.16761857e-19; -4.80192786e-19;;
                    1.14385235e-18;  6.63717382e-19; -8.91873113e-20;;;

                    8.78699897e-19;  1.54456738e-18;  4.54696849e-19;;
                    -7.56470482e-19;  1.28629194e-18;  2.20321242e-19;;;

                    3.91057974e-19;  5.30136140e-19;  1.03753213e-19;;
                    -3.31330633e-19;  1.58168913e-19;  5.13634639e-20;;;;;



                    1.27152103e-01;  6.91300878e-18;  2.11366792e-18;;
                    -9.64263403e-18;  9.23999004e-18;  1.77144208e-18;;;

                    3.59148864e-17; -3.59563826e-17; -5.99397999e-18;;
                    1.67605442e-17; -1.64040837e-17; -2.34782127e-18;;;

                    3.90764224e-18; -6.15476863e-18; -1.08313730e-18;;
                    1.00134007e-18; -3.14625746e-18; -4.80619661e-19;;;;


                    2.97186772e-19; -8.53943022e-20; -3.92173999e-20;;
                    4.77495278e-20;  9.55773189e-21; -8.25519959e-21;;;

                    2.31408072e-20;  1.30026992e-19;  3.35763546e-20;;
                    -2.59855819e-20;  6.63921673e-20;  1.26728393e-20;;;

                    -1.61954334e-20;  3.05380252e-20;  7.64563700e-21;;
                    -3.49797155e-21;  7.20620189e-21;  2.54161744e-21;;;;


                    1.95734477e-18; -5.62427761e-19; -2.58295388e-19;;
                    3.14490069e-19;  6.29495599e-20; -5.43707636e-20;;;

                    1.52411016e-19;  8.56389571e-19;  2.21142084e-19;;
                    -1.71147398e-19;  4.37275053e-19;  8.34664190e-20;;;

                    -1.06667086e-19;  2.01130903e-19;  5.03560353e-20;;
                    -2.30384962e-20;  4.74618082e-20;  1.67397141e-20]]
        level_11 = 2
        expected_allDims_11 = [1;;
                                1;;
                                1;;
                                1;;
                                1]
        @test isapprox(expected_allDims_11, getSubdivisionDims(Ms_11,trackedInterval_11,level_11))

        trackedInterval_12 = TrackedInterval([ 0.03945555;  0.03945555 + 1e-5;;
                                                -1.;          -1 + 1e-5;;
                                                1.;  1. + 1e-5;;
                                                0.03945555;  0.03945555 + 1e-5 ;;
                                                0.41480102;  0.41480102 + 1e-5])
        Ms_12 = [[ 1.07142165e+00;  1.61772562e-01;;
                        5.75461946e-02;  5.61619043e-01;;;

                        2.96651313e-01; -3.39708980e-17;;
                        6.23974136e-17;  3.06138888e-17;;;

                        3.35269245e-01; -2.14750436e-18;;
                        1.63404061e-17;  3.92462018e-18;;;;


                        4.05175438e-01;  1.49089271e-17;;
                        -2.42704359e-17;  6.11752001e-18;;;

                        8.91612496e-17; -1.64457404e-17;;
                        4.37735368e-18; -8.26735644e-18;;;

                        1.59746311e-17; -5.58287457e-18;;
                        1.21413250e-18; -2.15690973e-18;;;;


                        1.01293860e-01; -2.91078151e-18;;
                        6.02650904e-18; -7.69091844e-19;;;

                        -1.61151471e-17;  1.96422369e-18;;
                        -1.02880386e-18;  1.16696315e-18;;;

                        -3.16461064e-18;  1.07109611e-18;;
                        -3.19107512e-19;  4.03906181e-19;;;;;



                        4.99963263e-01;  7.24023441e-18;;
                        2.08333217e-17; -3.58422625e-18;;;

                        -2.88911748e-17; -2.39516560e-17;;
                        -3.52016062e-17;  2.07163246e-17;;;

                        -2.99141286e-17; -9.60551746e-18;;
                        -1.09122488e-17;  5.52770123e-18;;;;


                        6.41527705e-17; -4.54209112e-18;;
                        1.38295961e-17; -2.04590576e-18;;;

                        -3.54019101e-17; -6.07501389e-18;;
                        -6.98105270e-18; -1.19866640e-18;;;

                        -1.31610394e-17; -1.04908960e-18;;
                        -2.96892590e-18; -1.65904797e-19;;;;


                        -1.29567793e-17; -6.01707661e-19;;
                        -4.40294636e-18; -2.94442193e-19;;;

                        2.92589264e-17;  3.61843830e-18;;
                        5.62920573e-18;  5.67975389e-19;;;

                        5.75914328e-18;  7.63941973e-19;;
                        1.41156695e-18;  1.78514600e-19;;;;;



                        1.27152103e-01;  1.91152932e-18;;
                        4.79121097e-18; -1.23937605e-18;;;

                        -2.09329083e-17; -4.09015035e-18;;
                        -7.01631281e-18;  3.73102191e-18;;;

                        -9.06126759e-18; -1.92681844e-18;;
                        -2.12745553e-18;  1.25546687e-18;;;;


                        1.36153101e-17; -1.23234013e-18;;
                        2.89822838e-18; -5.16802841e-19;;;

                        -7.90847046e-18; -1.37345331e-18;;
                        -1.56775419e-18; -2.73832184e-19;;;

                        -2.10526282e-18; -8.93431017e-20;;
                        -4.34200889e-19;  2.74305342e-21;;;;


                        -3.91222649e-18; -1.41462319e-19;;
                        -9.76066997e-19; -1.69143790e-20;;;

                        7.54787397e-18;  8.63779933e-19;;
                        1.31538564e-18;  1.03280515e-19;;;

                        1.46097501e-18;  1.51097345e-19;;
                        2.70074762e-19;  1.80664207e-20],

                        [1.71925557e+00;  1.68606883e-01;  4.11377490e-01;;
                        4.41708911e-01;  3.45276625e-17;  2.71584393e-18;;
                        3.83365591e-01;  5.51328328e-18;  2.19183835e-19;;;

                        2.96651313e-01;  5.68098934e-17;  1.04881815e-17;;
                        -2.59134440e-17;  5.02067534e-17;  3.18884982e-18;;
                        -4.40610755e-17;  1.85375284e-17;  4.80625344e-18;;;

                        3.35269245e-01; -3.38256162e-18; -2.81267507e-18;;
                        -3.88863843e-18;  1.97375581e-18; -5.95518601e-20;;
                        -2.82334822e-18;  1.92548058e-18;  7.35266273e-19;;;;


                        1.35058479e-01; -9.34504427e-18; -9.29019885e-19;;
                        -1.10973940e-17;  1.03984213e-17;  1.13091038e-18;;
                        -2.27373541e-18;  1.44719312e-18;  1.66375006e-19;;;

                        -3.86160966e-17;  3.43535302e-17;  3.62552216e-18;;
                        -2.65620582e-17;  2.40509961e-17;  2.55367163e-18;;
                        -2.24963724e-18;  2.14897426e-18;  2.27589614e-19;;;

                        -7.29423233e-18;  5.54979427e-18;  5.98695706e-19;;
                        -3.99966511e-18;  3.36022405e-18;  3.59624925e-19;;
                        7.16837006e-20;  4.65715043e-19;  4.02772780e-20;;;;


                        3.37646199e-02;  6.57761381e-18;  1.05638586e-18;;
                        -1.54799727e-18;  1.72457255e-18;  5.76470040e-19;;
                        1.18536415e-19;  9.64716050e-21;  4.27921252e-20;;;

                        -4.17762847e-18;  6.66283925e-19;  5.32216329e-19;;
                        6.92434840e-20;  6.53808761e-20;  4.41203718e-19;;
                        1.78340075e-19; -2.27569503e-20;  4.26724892e-20;;;

                        -8.56908140e-20; -9.72518670e-20;  4.13326424e-20;;
                        2.87748879e-20; -1.15988381e-19;  4.08861804e-20;;
                        -3.94480233e-20; -3.98168367e-20;  2.69575387e-21;;;;;



                        4.99963263e-01;  2.29272093e-17; -2.86799058e-19;;
                        2.14831673e-18;  3.13193909e-17;  3.24546778e-18;;
                        1.35741026e-17; -2.13537735e-19; -6.57646260e-19;;;

                        2.78293091e-16; -1.38063712e-16; -2.50498941e-17;;
                        6.04556822e-17;  4.57639616e-17;  2.46885166e-18;;
                        -8.79903230e-18;  1.70212431e-17;  2.95411077e-18;;;

                        1.50741235e-17; -1.98538344e-17; -3.89293146e-18;;
                        5.49952480e-18;  2.84087843e-18;  5.07447260e-20;;
                        -2.09725092e-18;  2.74694437e-18;  5.20118981e-19;;;;


                        -3.36484194e-17;  3.10696010e-17;  3.20162611e-18;;
                        3.56944474e-17; -3.25664835e-17; -3.36584778e-18;;
                        6.31873340e-18; -6.34800243e-18; -6.46404749e-19;;;

                        2.81977474e-17; -2.38792491e-17; -2.49869943e-18;;
                        -2.90390317e-17;  2.59350981e-17;  2.68616991e-18;;
                        -5.43349495e-18;  4.87683452e-18;  5.04862589e-19;;;

                        5.77179529e-18; -5.99247884e-18; -6.07358261e-19;;
                        -6.79088336e-18;  5.97713108e-18;  6.20757732e-19;;
                        -9.18819151e-19;  1.32384739e-18;  1.28793051e-19;;;;


                        1.40974138e-21; -3.54630380e-18; -3.19792116e-19;;
                        -5.73760846e-18;  1.99122869e-18;  2.46616928e-19;;
                        -7.98893529e-19;  4.72947818e-19;  5.17284702e-20;;;

                        2.34561328e-18;  9.94655571e-18;  8.17713030e-19;;
                        3.56484031e-18; -5.49916153e-18; -5.44390129e-19;;
                        4.22030873e-19; -1.23719330e-18; -1.15292452e-19;;;

                        -2.32025897e-19;  1.48923258e-18;  1.31516094e-19;;
                        1.28054485e-18; -8.01145834e-19; -9.02892285e-20;;
                        1.55691965e-19; -2.06043501e-19; -2.04047658e-20;;;;;



                        1.27152103e-01;  7.47509277e-19; -1.68244688e-18;;
                        4.63304008e-19;  6.35723598e-18;  6.79396127e-19;;
                        4.94612170e-18;  1.46994270e-19; -3.79295338e-20;;;

                        5.91928627e-17; -2.87891070e-17; -3.32217995e-18;;
                        1.99411391e-17;  4.96747918e-18;  2.02129771e-19;;
                        4.24216090e-19;  1.98140464e-18;  1.73282230e-19;;;

                        5.15689754e-18; -3.87702672e-18; -4.06527421e-19;;
                        2.23891020e-18; -2.45004990e-19; -4.67452746e-20;;
                        -1.12657737e-19;  3.32790994e-19;  3.14783904e-20;;;;


                        -1.04290640e-17;  9.34172522e-18;  9.57292638e-19;;
                        5.45480277e-18; -5.04506206e-18; -5.31161827e-19;;
                        1.24687631e-18; -1.14042138e-18; -1.18963104e-19;;;

                        8.80257271e-18; -7.54482795e-18; -7.98676635e-19;;
                        -4.43106195e-18;  3.94672772e-18;  3.97201471e-19;;
                        -1.02679171e-18;  9.02116107e-19;  9.24464753e-20;;;

                        1.98766428e-18; -1.75969853e-18; -1.83989290e-19;;
                        -1.01078505e-18;  9.28863753e-19;  9.44209950e-20;;
                        -2.33369611e-19;  2.11640682e-19;  2.17289287e-20;;;;


                        1.22499456e-18; -1.83448985e-18; -2.47020324e-19;;
                        -8.20959421e-19;  7.57803612e-20; -5.45301161e-20;;
                        -1.73151346e-19;  8.84469260e-20;  2.32250876e-21;;;

                        1.18291130e-18;  1.77850549e-18;  6.21181689e-20;;
                        6.67279506e-19; -1.05968248e-18; -1.81474744e-19;;
                        4.90292034e-20; -2.31806698e-19; -2.94914098e-20;;;

                        -2.91321091e-20;  3.00984336e-19;  1.77874793e-20;;
                        2.39009743e-19; -1.32272646e-19; -2.44110439e-20;;
                        3.66238103e-20; -3.22597475e-20; -4.36406276e-21],

                        [1.49576457e+00;  1.68606883e-01;  4.11377490e-01;;
                        2.20854456e-01; -5.06979570e-17; -1.48297754e-17;;
                        1.91682796e-01; -4.28098704e-18; -3.03250631e-18;;;

                        2.96651313e-01; -1.52117951e-16; -2.87974276e-17;;
                        9.85544813e-18; -1.26068312e-17; -1.82987398e-18;;
                        -2.64947010e-17;  2.04151968e-17;  3.43762545e-18;;;

                        3.35269245e-01; -2.66571677e-17; -8.65114674e-18;;
                        1.41002534e-18; -1.22337404e-18; -2.49667270e-19;;
                        -2.97331670e-18;  2.22719784e-18;  5.02129829e-19;;;;


                        1.35058479e-01;  6.33671440e-17;  5.31519365e-18;;
                        -2.74298794e-18;  4.29406209e-18;  1.07929091e-19;;
                        7.93333491e-18; -7.50055855e-18; -1.08630334e-19;;;

                        -6.00791689e-17;  5.54051086e-17;  6.73924499e-18;;
                        -3.34756515e-18;  1.59372967e-18;  4.37359936e-19;;
                        4.77460128e-18; -4.13673986e-18; -9.68554646e-19;;;

                        -5.74073182e-18;  5.44263054e-18;  7.95821283e-19;;
                        -2.10323124e-19; -1.43941116e-19;  4.81126567e-20;;
                        -5.98371220e-20;  1.02228055e-19; -1.14428425e-19;;;;


                        3.37646199e-02; -2.37467886e-18;  5.05147144e-19;;
                        8.46931293e-19; -6.83729888e-20;  1.59692136e-19;;
                        -3.52574395e-18;  3.41684249e-18; -3.54198703e-20;;;

                        7.09803562e-19; -1.78247073e-18; -7.62390099e-19;;
                        -9.61353501e-19;  4.92268856e-19; -8.76704803e-20;;
                        -1.98866700e-18;  1.21408536e-18;  4.48047751e-19;;;

                        -4.04403498e-19;  2.28264502e-19; -1.11996935e-19;;
                        -3.11471188e-19;  1.82498799e-19; -1.29409342e-20;;
                        8.58626558e-20; -1.87289179e-19;  5.47037359e-20;;;;;



                        4.99963263e-01;  8.32050447e-17; -6.85647337e-19;;
                        5.53515005e-17;  2.27049024e-17;  1.05680764e-18;;
                        1.99603570e-18;  1.63225390e-17;  1.59012394e-18;;;

                        8.83607766e-17; -9.99996893e-17; -1.16883354e-17;;
                        1.63971286e-17;  3.14925071e-18; -2.55450992e-19;;
                        1.18374815e-18;  1.02932357e-17;  1.49308097e-18;;;

                        -1.32580578e-18; -3.25472901e-17; -6.36865089e-18;;
                        1.00480865e-18; -6.17269549e-19; -1.92308735e-19;;
                        -8.47901575e-19;  1.65871216e-18;  4.24018265e-19;;;;


                        1.02499832e-17;  2.91175683e-18;  8.69254265e-20;;
                        -4.64903769e-18; -2.33254419e-18; -1.36843898e-19;;
                        -1.00984279e-18; -6.12639718e-19; -3.11328996e-20;;;

                        -5.58011466e-18; -2.77533450e-18; -1.47196267e-19;;
                        3.45566799e-18;  2.25499877e-18;  1.47268742e-19;;
                        7.49863393e-19;  4.11677340e-19;  1.88624856e-20;;;

                        -1.48455723e-18; -5.98554534e-19; -2.73877700e-20;;
                        8.14791283e-19;  5.01547273e-19;  3.20893871e-20;;
                        1.87092116e-19;  9.22429115e-20;  3.90211539e-21;;;;


                        1.57231038e-17; -1.00800814e-17; -1.20004923e-18;;
                        -3.40022589e-18;  1.55870165e-20;  3.04003309e-20;;
                        -4.39902043e-19; -5.25845976e-19;  7.55148791e-21;;;

                        5.31534932e-18;  5.48792490e-18;  4.70440868e-19;;
                        6.48576503e-19;  2.35966586e-18;  2.13106544e-19;;
                        -1.06759231e-19; -1.39192708e-19; -4.84695289e-20;;;

                        -5.92137415e-20;  1.54844077e-18;  1.52267313e-19;;
                        2.58239351e-19;  4.17326986e-19;  3.65022534e-20;;
                        6.66077987e-20; -5.10143140e-20; -1.41976204e-20;;;;;



                        1.27152103e-01;  2.64053263e-17;  1.87453686e-18;;
                        1.14621989e-17;  6.36289187e-18;  4.76910862e-19;;
                        2.80365728e-18;  1.82800781e-18; -8.67438264e-20;;;

                        2.07717264e-17; -2.28941320e-17; -2.68751498e-18;;
                        3.56117578e-18;  9.58256645e-19; -3.55695508e-20;;
                        2.00680115e-19;  2.38975911e-18;  3.47044517e-19;;;

                        2.85446168e-18; -7.75745683e-18; -1.53912412e-18;;
                        2.30510206e-19; -1.38180388e-19; -4.40186598e-20;;
                        -2.58668313e-19;  4.33721110e-19;  1.03286499e-19;;;;


                        2.39508763e-18;  6.30999482e-19;  1.60529540e-20;;
                        -1.03579320e-18; -5.77663838e-19; -3.55574857e-20;;
                        -2.22755939e-19; -1.42123716e-19; -7.40081569e-21;;;

                        -1.25977109e-18; -6.86260230e-19; -3.83648534e-20;;
                        8.39703446e-19;  4.78969772e-19;  2.97547248e-20;;
                        1.84638527e-19;  9.44665604e-20;  4.13205533e-21;;;

                        -3.39507811e-19; -1.43588952e-19; -6.84045187e-21;;
                        1.93105222e-19;  1.10924750e-19;  6.91085159e-21;;
                        4.45650185e-20;  2.12347479e-20;  8.74910315e-22;;;;


                        3.81102471e-18; -2.60321014e-18; -3.03770305e-19;;
                        -5.33716027e-19; -2.51925780e-19; -1.89508235e-20;;
                        -3.22141721e-20; -1.25374252e-19;  3.71580813e-22;;;

                        1.42128275e-18;  9.70789600e-19;  7.99695564e-20;;
                        4.22316950e-19;  2.68626044e-19;  2.11255965e-20;;
                        5.04478629e-20; -3.63688189e-20; -1.26831797e-20;;;

                        9.08348984e-21;  3.22747781e-19;  3.17962323e-20;;
                        9.17421902e-20;  6.38540109e-20;  5.12338319e-21;;
                        2.42318218e-20; -1.22813672e-20; -3.45488302e-21],

                        [5.49119633e-01;  2.02719397e-01;;
                        2.05265617e-02;  2.00327894e-01;;
                        1.78153016e-02;  1.73867494e-01;;;

                        3.55981576e-02; -4.79403779e-18;;
                        -3.87882958e-17;  6.12918957e-18;;
                        -1.81021848e-17;  1.13416102e-17;;;

                        4.02323093e-02;  1.11973965e-19;;
                        -8.98375531e-18;  1.52152949e-18;;
                        -4.01756286e-18;  1.91735809e-18;;;;


                        1.35058479e-01;  5.94760094e-18;;
                        7.69395246e-18;  7.06389841e-19;;
                        2.51265164e-19;  3.19281748e-20;;;

                        -3.16361745e-17; -5.40901655e-18;;
                        3.85207648e-18;  1.95744513e-18;;
                        1.90223606e-18;  5.17594123e-19;;;

                        -7.28196516e-18; -1.05789185e-18;;
                        8.75899333e-19;  3.51447779e-19;;
                        4.36259329e-19;  9.65821278e-20;;;;


                        3.37646199e-02; -2.65041304e-18;;
                        -1.89010865e-18; -3.06353560e-19;;
                        4.62341252e-19;  6.61993892e-20;;;

                        1.47680634e-17;  2.64094224e-18;;
                        -9.90355019e-20; -2.47678807e-19;;
                        -6.36336582e-19; -1.47853220e-19;;;

                        3.47046958e-18;  5.69551351e-19;;
                        -5.37519332e-20; -3.58990090e-20;;
                        -1.54051928e-19; -2.92922262e-20;;;;;



                        4.99963263e-01; -4.51000037e-18;;
                        -5.86654108e-17; -3.11421864e-17;;
                        -6.34906134e-18; -8.76327862e-18;;;

                        4.93397042e-17;  1.27312132e-17;;
                        5.13713052e-17;  1.34337514e-17;;
                        1.21566217e-17; -6.04640724e-19;;;

                        1.04424704e-17;  2.18900658e-18;;
                        1.15803135e-17;  3.55019066e-18;;
                        2.62535282e-18;  6.36963537e-19;;;;


                        -8.91062611e-18;  2.88584674e-18;;
                        -5.72097891e-18;  3.69523315e-18;;
                        -4.72182756e-19;  4.25784901e-19;;;

                        1.49494096e-17; -1.02282534e-18;;
                        -1.02258364e-17; -5.55059951e-18;;
                        -2.14375543e-18; -7.78990578e-19;;;

                        1.64723141e-18; -5.45858823e-19;;
                        -1.41291123e-18; -1.11959301e-18;;
                        -2.78594027e-19; -1.42834149e-19;;;;


                        9.85390930e-19; -4.16044371e-19;;
                        7.78935935e-18;  7.15131094e-19;;
                        1.11212800e-18;  1.23424928e-19;;;

                        -4.83095371e-18; -3.52743064e-19;;
                        1.89623903e-18;  8.28398167e-19;;
                        4.84195607e-19;  1.37535144e-19;;;

                        -4.91299177e-19;  2.55736473e-20;;
                        1.09690662e-19;  1.35102418e-19;;
                        3.69267458e-20;  1.89322089e-20;;;;;



                        1.27152103e-01; -2.14404266e-18;;
                        -9.60099826e-18; -6.27568893e-18;;
                        -3.18297026e-19; -1.19267467e-18;;;

                        7.40356148e-18;  4.37533456e-18;;
                        8.23054172e-18;  2.41916808e-18;;
                        2.14311438e-18; -1.06172510e-18;;;

                        1.50386501e-18;  8.39486389e-19;;
                        1.97314415e-18;  6.85752285e-19;;
                        3.74430051e-19; -7.92905809e-20;;;;


                        -2.31404570e-18;  6.22905375e-19;;
                        -1.18736968e-18;  8.76691280e-19;;
                        -7.84391585e-20;  1.03616949e-19;;;

                        3.48968459e-18; -2.30115176e-19;;
                        -2.38133525e-18; -1.28555312e-18;;
                        -4.99577208e-19; -1.80704330e-19;;;

                        5.99992360e-19; -8.84979160e-20;;
                        -4.41757350e-19; -2.78416400e-19;;
                        -9.06815078e-20; -3.75082611e-20;;;;


                        2.61512218e-19; -9.03113175e-20;;
                        1.78170536e-18;  1.62159821e-19;;
                        2.52863084e-19;  2.78176640e-20;;;

                        -1.12083114e-18; -8.23100813e-20;;
                        4.40583130e-19;  1.91807899e-19;;
                        1.12432587e-19;  3.18717451e-20;;;

                        -1.42587480e-19;  9.23368410e-22;;
                        4.06294772e-20;  3.38315346e-20;;
                        1.20195434e-20;  4.97159986e-21],
                        [9.69840558e-01;  1.68606883e-01;  4.11377490e-01;;
                        2.27901995e-01; -1.24309595e-17;  8.25603419e-18;;;

                        5.29073342e-02; -7.46091880e-17; -1.85281254e-17;;
                        1.83676181e-01; -1.04166859e-16; -1.14069672e-17;;;

                        5.97947866e-02; -6.64017247e-18; -6.41927440e-18;;
                        2.07587061e-01; -2.54512810e-17; -3.40085408e-18;;;;


                        1.35058479e-01;  2.31430691e-18; -6.72762893e-18;;
                        1.98802250e-17; -3.18309247e-18; -2.29197550e-18;;;

                        -5.12474635e-17;  6.01397046e-18;  6.20055503e-18;;
                        -1.53997395e-17;  1.58437355e-18;  1.76388565e-18;;;

                        -1.33638081e-17; -1.70368117e-18;  1.18667316e-18;;
                        -5.46909963e-18;  9.67832915e-19;  4.87959566e-19;;;;


                        3.37646199e-02; -6.81868016e-18;  2.73831818e-19;;
                        -5.93822658e-18; -1.56759129e-18;  1.24806388e-19;;;

                        1.33845025e-17;  4.53207270e-18; -2.90078414e-19;;
                        4.24065660e-18;  1.06109094e-18; -1.09252487e-19;;;

                        3.30419645e-18;  1.99052380e-18;  1.49874169e-20;;
                        1.31709634e-18; -1.84937423e-19; -7.00129850e-20;;;;;



                        4.99963263e-01; -1.00662370e-17;  2.29723215e-18;;
                        -4.39869872e-17;  3.82903378e-17;  7.46065937e-18;;;

                        1.77788932e-16; -1.39729683e-16; -2.46306662e-17;;
                        7.94939073e-17; -6.65767506e-17; -9.80600214e-18;;;

                        1.16756624e-17; -2.06386167e-17; -4.02738435e-18;;
                        6.48364192e-18; -1.24755483e-17; -1.99568033e-18;;;;


                        4.59654126e-18;  1.97245530e-18;  4.27583244e-20;;
                        1.13417236e-18;  6.43430431e-19;  1.93352139e-20;;;

                        -3.43457551e-19; -3.49061114e-20;  5.27146302e-20;;
                        -2.50400329e-19;  1.18720804e-19;  2.88122201e-20;;;

                        -2.84298440e-18; -1.55926603e-18; -8.35910277e-20;;
                        -8.75261679e-19; -4.42063177e-19; -2.04385641e-20;;;;


                        8.01750108e-18;  4.16761857e-19; -4.80192786e-19;;
                        1.14385235e-18;  6.63717382e-19; -8.91873113e-20;;;

                        8.78699897e-19;  1.54456738e-18;  4.54696849e-19;;
                        -7.56470482e-19;  1.28629194e-18;  2.20321242e-19;;;

                        3.91057974e-19;  5.30136140e-19;  1.03753213e-19;;
                        -3.31330633e-19;  1.58168913e-19;  5.13634639e-20;;;;;



                        1.27152103e-01;  6.91300878e-18;  2.11366792e-18;;
                        -9.64263403e-18;  9.23999004e-18;  1.77144208e-18;;;

                        3.59148864e-17; -3.59563826e-17; -5.99397999e-18;;
                        1.67605442e-17; -1.64040837e-17; -2.34782127e-18;;;

                        3.90764224e-18; -6.15476863e-18; -1.08313730e-18;;
                        1.00134007e-18; -3.14625746e-18; -4.80619661e-19;;;;


                        2.97186772e-19; -8.53943022e-20; -3.92173999e-20;;
                        4.77495278e-20;  9.55773189e-21; -8.25519959e-21;;;

                        2.31408072e-20;  1.30026992e-19;  3.35763546e-20;;
                        -2.59855819e-20;  6.63921673e-20;  1.26728393e-20;;;

                        -1.61954334e-20;  3.05380252e-20;  7.64563700e-21;;
                        -3.49797155e-21;  7.20620189e-21;  2.54161744e-21;;;;


                        1.95734477e-18; -5.62427761e-19; -2.58295388e-19;;
                        3.14490069e-19;  6.29495599e-20; -5.43707636e-20;;;

                        1.52411016e-19;  8.56389571e-19;  2.21142084e-19;;
                        -1.71147398e-19;  4.37275053e-19;  8.34664190e-20;;;

                        -1.06667086e-19;  2.01130903e-19;  5.03560353e-20;;
                        -2.30384962e-20;  4.74618082e-20;  1.67397141e-20]]
        level_12 = 2
        expected_allDims_12 = [0; 4; 3;;
                                4; 3; 0;;
                                4; 3; 0;;
                                3; 0; 4;;
                                4; 0; 3]
        @test isapprox(expected_allDims_12, getSubdivisionDims(Ms_12,trackedInterval_12,level_12))

        trackedInterval_13 = TrackedInterval([1;1 + 1e-5;;
                                                1;10;;
                                                1;1 + 1e-5;;
                                                1;13])
        Ms_13 = [reshape(collect(0:2*3*2*1-1),(1,2,3,2)),reshape(collect(0:2*3*2*1-1),(1,2,3,2)),reshape(collect(0:2*3*2*1-1),(1,2,3,2)),reshape(collect(0:2*3*2*1-1),(1,2,3,2))]
        level_13 = 4
        expected_allDims_13 = [1;;
                                1;;
                                1;;
                                1]
        @test isapprox(expected_allDims_13, getSubdivisionDims(Ms_13,trackedInterval_13,level_13))
    
        trackedInterval_14 = TrackedInterval([1;5;;
                                                1;10;;
                                                1;1 + 1e-5;;
                                                1;13])
        Ms_14 = [reshape(collect(0:2*3*2*1-1),(1,2,3,2)),reshape(collect(0:2*3*2*1-1),(1,2,3,2)),reshape(collect(0:2*3*2*1-1),(1,2,3,2)),reshape(collect(0:2*3*2*1-1),(1,2,3,2))]
        level_14 = 4
        expected_allDims_14 = [1; 0;;
                                1; 0;;
                                1; 0;;
                                1; 0]
        @test isapprox(expected_allDims_14, getSubdivisionDims(Ms_14,trackedInterval_14,level_14))

        trackedInterval_15 = TrackedInterval([1;5;;
                                                1;10;;
                                                1;1 + 1e-5;;
                                                1;13])
        Ms_15 = [reshape(collect(0:15*3*2*1-1),(1,3,2,15)),reshape(collect(0:15*1*4*3-1),(3,4,1,15)),reshape(collect(0:15*3*2*1-1),(1,2,3,15)),reshape(collect(0:15*2*2*1-1),(1,2,2,15))]
        level_15 = 4
        expected_allDims_15 = [0;;
                                0;;
                                0;;
                                0]
        @test isapprox(expected_allDims_15, getSubdivisionDims(Ms_15,trackedInterval_15,level_15))
    end
end